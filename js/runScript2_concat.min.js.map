{"version":3,"sources":["runScript2_concat.js"],"names":["requirejs","require","define","undef","main","req","makeMap","handlers","defined","waiting","config","defining","hasOwn","Object","prototype","hasOwnProperty","aps","slice","jsSuffixRegExp","hasProp","obj","prop","call","normalize","name","baseName","nameParts","nameSegment","mapValue","foundMap","lastIndex","foundI","foundStarMap","starI","i","j","part","baseParts","split","map","starMap","length","nodeIdCompat","test","replace","charAt","concat","splice","join","makeRequire","relName","forceSync","args","arguments","push","apply","makeLoad","depName","value","callDep","Error","splitPrefix","prefix","index","indexOf","substring","makeRelParts","relParts","plugin","parts","relResourceName","f","n","pr","p","exports","e","module","id","uri","makeConfig","deps","callback","cjsModule","ret","usingExports","callbackType","load","undefined","alt","setTimeout","cfg","_defined","amd","jQuery","resMod","R","reqjsSeq","def","reqs","func","m","getModuleInfo","reqsFromFunc","setReqs","doLoad","this","getObjs","loadIfAvailable","forEach","reqm","loaded","revReqs","ms","modules","res","match","console","log","notifyLoaded","dependingMod","loadedModuleName","ary","cur","a","d","s","$a","Assertion","failMesg","flatten","_regedType","registerType","t","MODE_STRICT","MODE_DEFENSIVE","MODE_BOOL","fail","shift","isDefensive","isBool","subAssertion","assert","eq","b","ne","isset","is","type","v","_assert_func","Array","global","na","String","Number","Boolean","RegExp","exec","Function","k","ty","ensureError","action","err","message","setMode","mode","_mode","isStrict","top","stack","bind","opt","and","types","endsWith","str","postfix","PathUtil","driveLetter","url","Path","isPath","Absolute","isAbsolutePath","Relative","Dir","isDir","AbsDir","File","SEP","startsWith","isChildOf","child","parent","path","fixSep","hasDriveLetter","isURL","r","protocol","hostPort","isRelativePath","hasBackslashSep","to","directorify","filify","splitPath","u","pop","ext","truncExt","truncSEP","up","rel","relPath","paths","resPath","base","ps","old","backslashifyAfter","isAbsolute","isRelative","window",".png",".gif",".jpeg",".jpg",".ico",".wav",".mp3",".ogg",".midi",".mid",".mzo",".txt",".html",".htm",".css",".js",".json",".zip",".swf",".pdf",".doc",".xls",".ppt",".docx",".docm",".dotx",".dotm",".xlsx",".xlsm",".xltx",".xltm",".xlsb",".xlam",".pptx",".pptm",".potx",".potm",".ppsx",".ppsm",".ppam",".tonyu",".c",".dtl","self","root","DU","DUBRK","same","isNativePromise","then","promise","catch","isJQPromise","isPromise","all","succ","rest","resolve","useJQ","throwNowIfRejected","state","reject","assertResolved","resolved","ensureDefer","isDeferred","directPromise","timeout","funcPromise","$","Deferred","external","Promise","rej","throwPromise","throwF","each","set","loop","brk","objs","when1","deff1","deff2","r1","dr","r2","tryLoop","tr","tryEach","documentReady","callbackToPromise","NOP","E","errorHandler","error","alert","setE","begin","try","DeferredUtil","extend","P","M","FS","fstypes","stub","addFSType","fsgen","availFSTypes","mesg","fstype","isReadOnly","options","supportsSync","resolveFS","getRootFS","mounted","rootFS","mountPoint","inMyFS","getReturnTypes","getContent","size","ArrayBuffer","toBin","byteLength","getContentAsync","setContent","content","setContentAsync","appendContent","appendContentAsync","getMetaInfo","setMetaInfo","info","mkdir","touch","exists","opendir","opendirAsync","cp","dst","assertExist","srcIsDir","dstfs","dstIsDir","cont","mv","rm","link","getURL","onAddObserver","delegateMethods","methods","fs","assertWriteable","getContentType","toLowerCase","getBlob","c","blobType","Blob","binType","hasPlainText","toPlainText","isText","find","ls","ep","resolveLink","l","isLink","np","opendirEx","dest","getDirTree","style","excludes","meta","relP","getQueryString","key","default_","qs","location","href","decodeURIComponent","privatize","o","__privatized","_global","download","opts","xhr","XMLHttpRequest","open","responseType","onload","saveAs","response","onerror","send","corsEnabled","status","click","node","dispatchEvent","MouseEvent","evt","document","createEvent","initMouseEvent","HTMLAnchorElement","blob","URL","webkitURL","createElement","origin","target","createObjectURL","revokeObjectURL","navigator","msSaveOrOpenBlob","autoBom","warn","fromCharCode","bom","popup","title","body","innerText","force","isSafari","HTMLElement","safari","isChromeIOS","userAgent","FileReader","reader","onloadend","result","readAsDataURL","Util","Content","plainText","contentType","plain","buffer2ArrayBuffer","isBuffer","Uint8Array","buffer","arrayBuffer2Buffer","Buffer","bin","isNodeBuffer","bufType","nodeBuffer","arrayBuffer","looksLikeDataURL","text","hasNodeBuffer","DataURL","setBuffer","str2utf8bytes","toArrayBuffer","toNodeBuffer","toURL","hasBin","utf8bytes2str","hasURL","hasArrayBuffer","toBlob","Base64_To_ArrayBuffer","base64","A","dic","num","Math","floor","ary_buffer","ary_u8","charCodeAt","Base64_From_ArrayBuffer","data","bytes","toString","encodeURIComponent","parseInt","dataURL2bin","bin2dataURL","head","dataHeader","dataURL","ctype","requireTries","nodeRequire","fsf","existsSync","process","cwd","NativeFS","rootPoint","available","Pro","toNativePath","readFileSync","statSync","pa","writeFileSync","appendFileSync","stat","lastUpdate","mtime","getTime","mkdirSync","ts","readdirSync","nosep","isDirectory","rmdirSync","unlinkSync","utimesSync","Date","now","apath","rfs","w","watch","rpath","fpath","eventType","notifyChanged","remove","close","LSFS","storage","useDirCache","dirCache","ramDisk","localStorage","resolveKey","getItem","setItem","removeItem","itemExists","getDirInfo","dinfos","dinfo","JSON","parse","putDirInfo","trashed","stringify","ppath","pdinfo","_touch","removeEntry","removeEntryWithoutTrash","isRAM","getUsage","using","getCapacity","seq","KEY","lim","pow","ru","add","max","readOnly","cs","includeTrashed","pinfo","inf","noTrash","ajaxTransport","originalOptions","jqXHR","FormData","dataType","headers","async","username","password","addEventListener","statusText","getAllResponseHeaders","setRequestHeader","abort","WebFS","get","readAsArrayBuffer","Env","expand","expandPath","FSClass","SFile","_path","isSFile","setPolicy","policy","_clone","getPolicy","_resolve","topdir","topDir","contains","file","bp","pathR","assertDir","sibling","pre","post","equals","act","isTrashed","metaInfo","assertExists","noFollowLink","recursive","removeWithoutTrash","getText","setText","ct","appendText","forceText","getDataURL","setDataURL","setBytes","getBytes","lines","copyFrom","src","copyTo","dstf","progress","echo","getResolvedLinkPath","moveFrom","ex","moveTo","listFilesAsync","eachrev","reverse","fun","dir","convertOptions","_listFiles","ord","order","cvt","di","excludesF","sort","listFiles","nex","getFS","observe","h","addObserver","setBlob","sum","exportAsObject","importFromObject","_1","_2","handler","convertResult","valueOrPromise","syncMode","defineProperty","_act","RootFS","defaultFS","mount","fstab","_fstab","unmount","fact","unshift","_3","observers","remover","observer","ob","fsv","zip","setJSZip","JSZip","dstZip","jszip","folder","generateAsync","compression","unzip","arrayBuf","destDir","onCheckFile","overwrite","loadAsync","files","zipEntry","buf","_buf","redirectedTo","isArray","x","noop","fn","TypeError","_state","_handled","_value","_deferreds","doResolve","handle","deferred","_immediateFn","cb","onFulfilled","onRejected","newValue","finale","thisArg","_unhandledRejectionFn","len","done","reason","prom","constructor","arr","remaining","val","race","PR","Class","env","setEnvProvider","getEnvProvider","setEnv","getEnv","localStorageAvailable","init","importScripts","postMessage","isFile","WebSite","tablet","mobile","Platform","loc","runType","WebSite_runType","prot","VER","assign","urlAliases","builtinAssetNames","images/Ball.png","images/base.png","pwidth","pheight","images/Sample.png","images/inputPad.png","images/neko.png","images/mapchip.png","pluginTop","sampleImg","isNW","__node_webkit","__nwjs","mp4Disabled","tonyuHome","PathSep","sep","TONYU_HOME","logdir","TONYU_LOGDIR","wwwDir","platform","ffmpeg","pkgInfo","TONYU_PROJECTS","projects","delimiter","prjDirs","kernelDir","host","compiledKernel","compiledTools","mapEditor2","setNS2DepSpec","uploadTmpUrl","newVersionUrl","quickUploadURL","scriptServer","sysVersion","version","projectEditorURL","setDefaultResource","BuiltinAssets","getPathSep","ns2depspec","namespace","defaultResource","images","sounds","plugins","installed","box2d","detection","symbol","timbre","gif","Mezonet","PicoAudio","jquery_ui","convOpt","detectNeeded","g","hasInGlobal","loadAll","names","namea","loadNext","reqj","appendChild","request","pluginName","code","1","ja","superClassIsUndefined","classIsUndefined","invalidLeftValue","fieldDeclarationRequired","duplicateKeyInObjectLiteral","cannotUseStringLiteralAsAShorthandOfObjectValue","breakShouldBeUsedInIterationOrSwitchStatement","continueShouldBeUsedInIterationStatement","cannotUseObjectLiteralAsTheExpressionOfStatement","undefinedMethod","notAWaitableMethod","circularDependencyDetected","cannotWriteReturnInTryStatement","cannotWriteBreakInTryStatement","cannotWriteContinueInTryStatement","cannotWriteTwoOrMoreCatch","lexicalError","parseError","ambiguousClassName","cannotInvokeMethod","notAMethod","notAFunction","uninitialized","newIsRequiredOnInstanciate","bootClassIsNotFound","infiniteLoopDetected","en","dict","params","format","_","buildMesg","toUpperCase","englishify","setLocale","locale","2","3","4","TonyuThreadF","IT","performance","Tonyu","TT","klass","handleEx","onRuntimeError","addMeta","getMeta","removeMeta","classMetas","removeMetaAll","ns","mm","ensureNamespace","nsp","keys","propReg","property","isPropertyMethod","methodFor","bless","create","superclass","includes","fullName","shortName","methodsF","decls","nso","classes","chkclass","ctx","chkmeta","isShim","extenderFullName","mod","extender","includesRec","extendFrom","initialize","useNew","nonShimParent","props","fbk","methodInfo","fiber","isTonyuObject","desc","tter","getClassInfo","initFullName","isSourceChanged","tonyu","nodeTimestamp","shouldCompile","hasSemanticError","dks","getDependingClasses","globals","getClass","found","nn","nr","lastLoopCheck","resetLoopCheck","disableTime","thread","setGlobal","getGlobal","bindFunc","meth","thiz","not_a_tonyu_object","hasKey","invokeMethod","objName","callFunc","fName","checkNonNull","iterator","run","bootClassName","bootClass","runMode","boot","TPR","$currentProject","currentProject","runningObj","checkLoop","VERSION","ID","random","../lib/R","../lib/assert","../lib/root","./TonyuThread","./tonyuIterator","5","idSeq","TonyuThread","[object Object]","frame","_isDead","cnt","_isWaiting","fSuspended","tryStack","preemptionTime","onEndHandlers","onTerminateHandlers","age","isDead","_threadGroup","objectPoolAge","tGrpObjectPoolAge","isDeadThreadGroup","frameFunc","prev","methodName","method","pc","enter","th","termStatus","notifyEnd","retVal","exit","notifyTermination","tst","fb","on","st","exception","kill","lastEx","catchPC","eventSpec","suspend","lastEvent","steps","msg","gotoCatch","stepsLoop","wrapError","re","original","sv","currentThread","preempted","isAlive","6","SYMIT","Symbol","ArrayValueIterator","ArrayKeyValueIterator","ObjectKeyIterator","elems","ObjectKeyValueIterator","NativeIteratorWrapper","it","next","arity","tonyuIterator","PP","img","height","width","newImage","getContext","drawImage","pixels","getImageData","getPixel","cv","y","imagePixelData","ofs","G","B","setPixel","parse1Pattern","isParseError","image","hex","trans","dx","dy","PatterParseError","sx","sy","newim","nc","newImD","newD","ey","putImageData","yy","xx","boundsInSrc","er","Assets","prj","baseDir","getDir","mp3Disabled","oggf","asFile","urlTrailer","put","tonyu_app_version","IL","cache","resImgs","onLoad","resa","resImg","excludeEmpty","urlKey","proc","im","attr","pw","ph","rw","rh","parse1","imgDOM","ImageList","draw","canvas","Image","onld","clb","cw","ch","cctx","calcw","calch","clearRect","marginw","marginh","left","IR","TN","NAME","WIDTH","HEIGHT","delay","surpressCreateThumbnail","$Screen","toDataURL","rsrc","getResource","prjdir","imfile","item","imgs","setResource","crt","socialEditor","importOption","projectName","whenPrjDirExists","selectPolicy","ApiInfo","wsService","wsKey","QuickUpload","ClickToCompleteQuickUpload","reloadRequested","namespaceIsNotSet","namespaceIsSame","alreadyHaveSameNamespace","projectNotFound","addDependingProject","dependencyEditor","dependingProjects","depProejctPlaceholder","closeFile","removeFile","renameProject","removeProject","mapEditor","searchFiles","imageList","soundList","projectOptions","editorConfig","openFolder","resetRunDialog","exportAsHTML","openHelpInThisWindow","import","tools","publish","help","openHelpWithNewTab","publisedProjects","showEditButton","editorFontSize","inputFileName","newFile","renameFile","refactorClassName","someFilesHaveErrorOnRefactor","namingNotice","autoReload","stop","selectMain","createAtLeastOneFile","inputNewProjectName","unknown","jumpToErrorPosition","showTrace","generateSingleHTML","thisIsExecutableInSingleHTML","runnableInIE11","globalVariables","theseGlobalVariablesAreInitializedOnStart","variablesShouldBeStringOrJSON","save","varableName","varableNameShouldBeAlphabetOrNumber","cannotBeParsedAsValue","ifYouWantContainDoubleQuoteAsTheValue","ifYouWantContainBackslash","imageDetails","singlePicture","rowsAndColumns","chipWidthAndHeight","compatibleWithTonyu1","chipNo","dragImageFilesHere","sizePerChip","ok","importFromHTML","overwriteFolder","selectOtherFolder","pasteHTMLHere","inputFolderPathForImport","startImport","overwriteTheseFiles","openTheProjectWithoutOverwrite","followingFilesWillBeOverwritten","ovr","new","importComplete","selectMainClass","newProject","newProjectName","parentFolder","willCreateAt","inputProjectName","folderExists","rename","downloadAsZip","delete","deleteProject","downloadAsZipBeforeDeletion","yes","no","compiler","diagMode","disableInfiniteLoopCheck","requireFieldDeclaration","defaultSuperClass","runtimes","mainClass","edit","thisFileCannotBeAdded","resourceFileExists","sound","wordToFind","showAllProjects","thisFolderShouldBeUploadedToWebServer","seeRuntime","createExecutable","howToOutput","saveExecutableAsZip","uploadToProjectBoard","saveExecutableAtFolder","executableOptions","RunInIE11","attachSourceFiles","ifSourceFilesAreAttached","ItCanBeEditableInProjectBoard","youCanPublishThisExecutableAsWebApplicationBy","uploadTheFolderIntoYourWebSite","uploadZippedFileInto","projectBoard","afterProjectBoard","executableCreated","uploadTheExtractedFolderIntoYourWebSite","uploadTheZipFileInto","uploadHasNotBeenDoneYet","youHaveToDescribeAboutThisVersion","toCompleteTheUpload","youCanConfigureAboutInfinteLoopDetection","seeProjectOption","importingFromZip","importFromZip","confirm","cancel","input","fileExists","fileExistsInOtherFolder","deleteFileConfirm","duplicatedFiles","cannotUseFolderManagedByProject","cannotUseKernelFiles","upCased","resouceList","dragFileHere","storageUsage","unzipping","doesNotContainTonyu2Project","checking","downloadFromProjectBoard","copying","runtimeCreatedAt","uploadFailed","duplicateGlobalVariable","invalidGlobalVariableName","runClass","ThisFolderWillBeCreated","pluginAddedAndRestart","otherCommandInProgress","deleteProjectConfirm","renamedProjectExists","at","deleteProjectFromItem","destinationFolder","Open_URL","UseRightClick","filenameMatched","noPushedPages","noSuchPat","invalidPatExpr","openProjectInNewWindow","localeStr","language","loadLocale","renderMenu","getLocale","thumbnail","rawRun","removeJSOutput","getOutputFile","loadClasses","detectPlugins","fixBootRunClasses","runScriptMode","rawBoot","getResourceFile","resFile","chg","imgSnd","removeThumbnail","resc","filter","tfile","hasSoundResource","getThumbnail","convertBlobInfos","user","getName","isBlobURL","BLOB_PATH_EXPR","fileName","getBlobInfos","loadResource","sp","setImageList","getOptions","hasMZO","hasMIDI","addPlugin","removePlugin","setOptions","requestPlugin","loadPlugins","mc","fixClassName","bc","className","getNamespace","showProgress","initCanvas","$mainCanvas","SplashScreen","nonSourceDirs","js","static","maps","getEXT","collect","nb","setAttribute","sysMod","JS","rdir","getOptionsFile","sourceFiles","getDependingProjects","dep","Shell","mustExist","resolve2","newCommand","cd","pwd","vars","fst","sh","from","ln","notrash","cat","grep","pattern","line","lineNo","report","setout","ui","outUI","when","clone","getvar","strcat","dl","prompt","ASYNC","description","devtool","Window","showDevTools","T2MediaLib","isMezonetSource","bgm","Source","isAudioBufferSourceNode","isPicoAudio","_context","context","picoAudio","soundDataAry","bgmPlayerMax","bgmPlayerAry","masterVolume","seMasterVolume","bgmMasterVolume","playingAudio","audioVolume","audioTempo","audioDataAry","seSources","inited","disabled","AudioContext","webkitAudioContext","T2MediaLib_BGMPlayer","allClearSoundData","dataAry","idx","clearSoundData","allRemoveDecodedSoundData","soundData","isDecodeComplete","isDecoding","removeDecodedData","removeDecodedSoundData","getMasterVolume","setMasterVolume","vol","bgmPlayer","onChangeBGMMasterVolume","createSoundFromArray","array1","array2","T2MediaLib_SoundData","numOfChannels","audioBuffer","createBuffer","sampleRate","buffer1","getChannelData","buffer2","onDecodeComplete","loadSound","callbacks","isLoadAndDecode","audioContext","isSkipBeginning","initReverb","that","onLoadComplete","decodeSound","onError","errorID","fileData","isLoadComplete","decodedCallbacksAry","bgmPlayerId","some","onDecode","smf","parseSMF","retAry","searchOggLoop","tagLoopStart","tagLoopEnd","decodeAudioData","activate","isContextResumed","resume","isActivated","source","createBufferSource","connect","destination","start","noteOn","getSoundFileData","soundDataObj","getSoundDecodedData","decodedData","getCurrentTime","currentTime","playSE","pan","rate","offset","loopStart","loopEnd","duration","playback","Start","volume","AudioBuffer","durationStart","createGain","createGainNode","gainNode","panNode","createPanner","playbackRate","panningModel","offset_adj","panAngle","panX","sin","PI","panZ","cos","positionX","positionY","positionZ","setPosition","gain","volumeValue","panValue","playStartTime","playOffset","plusTime","noteOff","onended","event","stopSE","sourceObj","cancelScheduledValues","linearRampToValueAtTime","stopAllSE","getSEMasterVolume","setSEMasterVolume","getSEVolume","setSEVolume","getSERate","setSERate","getSEPan","setSEPan","isSELoop","setSELoop","getSELoopStartTime","setSELoopStartTime","getSELoopEndTime","setSELoopEndTime","playBGM","_getBgmPlayer","stopBGM","pauseBGM","resumeBGM","getBGMMasterVolume","setBGMMasterVolume","getBGMVolume","setBGMVolume","getBGMTempo","setBGMTempo","tempo","getBGMPan","setBGMPan","isBGMLoop","setBGMLoop","getBGMLoopStartTime","setBGMLoopStartTime","getBGMLoopEndTime","setBGMLoopEndTime","getBGMCurrentTime","getBGMLength","getPlayingBGMName","setOnBGMEndListener","listener","getPlayingBGMState","getBGMPicoAudio","isTagLoop","setTagLoop","getBGMPlayerMax","allStopBGM","allResetBGM","loadAudio","audio","Audio","play","createMediaElementSource","playAudio","startTime","pause","stopAudio","pauseAudio","resumeAudio","setAudioVolume","setAudioTempo","setAudioPosition","time","getAudioData","getAudioCurrentTime","getAudioLength","lastIndexOf","tagSize","startIdx","lengthIdx","loopLength","isMezonetPlayback","Playback","t2MediaLib","arg_id","playingBGMState","playingBGMStatePending","playingBGM","playingBGMName","bgmPause","bgmPauseTime","bgmPauseCurrentTime","bgmPauseTempo","bgmPauseLoop","bgmPauseLoopStart","bgmPauseLoopEnd","bgmVolume","bgmTempo","bgmPan","picoAudioSetDataBGMName","PICO_AUDIO_VOLUME_COEF","succFunc","pending","_setPlayingBGMState","_initPicoAudio","setData","initStatus","setLoop","bgmLengthTime","MAX_SAFE_INTEGER","setStartTime","Stop","setVolume","isNaN","setRate","isLoop","time2","currenTime","minusTime","getTrackTime","states","setOnSongEndListener","isNone","isTrcf","handleException","EC","UI","F","expr","listeners","$vars","$edits","model","writeToJq","$edit","jq","validator","validate","toVal","errors","show","validationMessage","empty","append","OKButton","addError","removeError","allOK","isValid","writeToModel","fromVal","li","tag","$var","realtimechange","css","eType","ev","which","first","parseAttr","parseArray","createTextNode","parseFloat","UIDiag","requestJQueryUI","curPrj","isPrimitive","parseMesg","defTitle","multiLine","useNative","afterModal","sendF","dialog","_default","getStatus","$Scheduler","resetLastSteps","$InputDevice","reset","geom","position","my","of","enterkey","focus","resultValue","hide","doResize","overflow","margin","class","appendTo","resize","CPTR","rt","com","curProjectDir","home","locs","ramHome","actualFilesDir","serverType","runtimePath","loadFiles","animationFrame","requestAnimationFrame"],"mappings":"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","sourcesContent":["(function (){\r\n/**\r\n * @license almond 0.3.3 Copyright jQuery Foundation and other contributors.\r\n * Released under MIT license, http://github.com/requirejs/almond/LICENSE\r\n */\r\n//Going sloppy to avoid 'use strict' string cost, but strict practices should\r\n//be followed.\r\n/*global setTimeout: false */\r\n\r\nvar requirejs, require, define;\r\n(function (undef) {\r\n    var main, req, makeMap, handlers,\r\n        defined = {},\r\n        waiting = {},\r\n        config = {},\r\n        defining = {},\r\n        hasOwn = Object.prototype.hasOwnProperty,\r\n        aps = [].slice,\r\n        jsSuffixRegExp = /\\.js$/;\r\n\r\n    function hasProp(obj, prop) {\r\n        return hasOwn.call(obj, prop);\r\n    }\r\n\r\n    /**\r\n     * Given a relative module name, like ./something, normalize it to\r\n     * a real name that can be mapped to a path.\r\n     * @param {String} name the relative name\r\n     * @param {String} baseName a real name that the name arg is relative\r\n     * to.\r\n     * @returns {String} normalized name\r\n     */\r\n    function normalize(name, baseName) {\r\n        var nameParts, nameSegment, mapValue, foundMap, lastIndex,\r\n            foundI, foundStarMap, starI, i, j, part, normalizedBaseParts,\r\n            baseParts = baseName && baseName.split(\"/\"),\r\n            map = config.map,\r\n            starMap = (map && map['*']) || {};\r\n\r\n        //Adjust any relative paths.\r\n        if (name) {\r\n            name = name.split('/');\r\n            lastIndex = name.length - 1;\r\n\r\n            // If wanting node ID compatibility, strip .js from end\r\n            // of IDs. Have to do this here, and not in nameToUrl\r\n            // because node allows either .js or non .js to map\r\n            // to same file.\r\n            if (config.nodeIdCompat && jsSuffixRegExp.test(name[lastIndex])) {\r\n                name[lastIndex] = name[lastIndex].replace(jsSuffixRegExp, '');\r\n            }\r\n\r\n            // Starts with a '.' so need the baseName\r\n            if (name[0].charAt(0) === '.' && baseParts) {\r\n                //Convert baseName to array, and lop off the last part,\r\n                //so that . matches that 'directory' and not name of the baseName's\r\n                //module. For instance, baseName of 'one/two/three', maps to\r\n                //'one/two/three.js', but we want the directory, 'one/two' for\r\n                //this normalization.\r\n                normalizedBaseParts = baseParts.slice(0, baseParts.length - 1);\r\n                name = normalizedBaseParts.concat(name);\r\n            }\r\n\r\n            //start trimDots\r\n            for (i = 0; i < name.length; i++) {\r\n                part = name[i];\r\n                if (part === '.') {\r\n                    name.splice(i, 1);\r\n                    i -= 1;\r\n                } else if (part === '..') {\r\n                    // If at the start, or previous value is still ..,\r\n                    // keep them so that when converted to a path it may\r\n                    // still work when converted to a path, even though\r\n                    // as an ID it is less than ideal. In larger point\r\n                    // releases, may be better to just kick out an error.\r\n                    if (i === 0 || (i === 1 && name[2] === '..') || name[i - 1] === '..') {\r\n                        continue;\r\n                    } else if (i > 0) {\r\n                        name.splice(i - 1, 2);\r\n                        i -= 2;\r\n                    }\r\n                }\r\n            }\r\n            //end trimDots\r\n\r\n            name = name.join('/');\r\n        }\r\n\r\n        //Apply map config if available.\r\n        if ((baseParts || starMap) && map) {\r\n            nameParts = name.split('/');\r\n\r\n            for (i = nameParts.length; i > 0; i -= 1) {\r\n                nameSegment = nameParts.slice(0, i).join(\"/\");\r\n\r\n                if (baseParts) {\r\n                    //Find the longest baseName segment match in the config.\r\n                    //So, do joins on the biggest to smallest lengths of baseParts.\r\n                    for (j = baseParts.length; j > 0; j -= 1) {\r\n                        mapValue = map[baseParts.slice(0, j).join('/')];\r\n\r\n                        //baseName segment has  config, find if it has one for\r\n                        //this name.\r\n                        if (mapValue) {\r\n                            mapValue = mapValue[nameSegment];\r\n                            if (mapValue) {\r\n                                //Match, update name to the new value.\r\n                                foundMap = mapValue;\r\n                                foundI = i;\r\n                                break;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n\r\n                if (foundMap) {\r\n                    break;\r\n                }\r\n\r\n                //Check for a star map match, but just hold on to it,\r\n                //if there is a shorter segment match later in a matching\r\n                //config, then favor over this star map.\r\n                if (!foundStarMap && starMap && starMap[nameSegment]) {\r\n                    foundStarMap = starMap[nameSegment];\r\n                    starI = i;\r\n                }\r\n            }\r\n\r\n            if (!foundMap && foundStarMap) {\r\n                foundMap = foundStarMap;\r\n                foundI = starI;\r\n            }\r\n\r\n            if (foundMap) {\r\n                nameParts.splice(0, foundI, foundMap);\r\n                name = nameParts.join('/');\r\n            }\r\n        }\r\n\r\n        return name;\r\n    }\r\n\r\n    function makeRequire(relName, forceSync) {\r\n        return function () {\r\n            //A version of a require function that passes a moduleName\r\n            //value for items that may need to\r\n            //look up paths relative to the moduleName\r\n            var args = aps.call(arguments, 0);\r\n\r\n            //If first arg is not require('string'), and there is only\r\n            //one arg, it is the array form without a callback. Insert\r\n            //a null so that the following concat is correct.\r\n            if (typeof args[0] !== 'string' && args.length === 1) {\r\n                args.push(null);\r\n            }\r\n            return req.apply(undef, args.concat([relName, forceSync]));\r\n        };\r\n    }\r\n\r\n    function makeNormalize(relName) {\r\n        return function (name) {\r\n            return normalize(name, relName);\r\n        };\r\n    }\r\n\r\n    function makeLoad(depName) {\r\n        return function (value) {\r\n            defined[depName] = value;\r\n        };\r\n    }\r\n\r\n    function callDep(name) {\r\n        if (hasProp(waiting, name)) {\r\n            var args = waiting[name];\r\n            delete waiting[name];\r\n            defining[name] = true;\r\n            main.apply(undef, args);\r\n        }\r\n\r\n        if (!hasProp(defined, name) && !hasProp(defining, name)) {\r\n            throw new Error('No ' + name);\r\n        }\r\n        return defined[name];\r\n    }\r\n\r\n    //Turns a plugin!resource to [plugin, resource]\r\n    //with the plugin being undefined if the name\r\n    //did not have a plugin prefix.\r\n    function splitPrefix(name) {\r\n        var prefix,\r\n            index = name ? name.indexOf('!') : -1;\r\n        if (index > -1) {\r\n            prefix = name.substring(0, index);\r\n            name = name.substring(index + 1, name.length);\r\n        }\r\n        return [prefix, name];\r\n    }\r\n\r\n    //Creates a parts array for a relName where first part is plugin ID,\r\n    //second part is resource ID. Assumes relName has already been normalized.\r\n    function makeRelParts(relName) {\r\n        return relName ? splitPrefix(relName) : [];\r\n    }\r\n\r\n    /**\r\n     * Makes a name map, normalizing the name, and using a plugin\r\n     * for normalization if necessary. Grabs a ref to plugin\r\n     * too, as an optimization.\r\n     */\r\n    makeMap = function (name, relParts) {\r\n        var plugin,\r\n            parts = splitPrefix(name),\r\n            prefix = parts[0],\r\n            relResourceName = relParts[1];\r\n\r\n        name = parts[1];\r\n\r\n        if (prefix) {\r\n            prefix = normalize(prefix, relResourceName);\r\n            plugin = callDep(prefix);\r\n        }\r\n\r\n        //Normalize according\r\n        if (prefix) {\r\n            if (plugin && plugin.normalize) {\r\n                name = plugin.normalize(name, makeNormalize(relResourceName));\r\n            } else {\r\n                name = normalize(name, relResourceName);\r\n            }\r\n        } else {\r\n            name = normalize(name, relResourceName);\r\n            parts = splitPrefix(name);\r\n            prefix = parts[0];\r\n            name = parts[1];\r\n            if (prefix) {\r\n                plugin = callDep(prefix);\r\n            }\r\n        }\r\n\r\n        //Using ridiculous property names for space reasons\r\n        return {\r\n            f: prefix ? prefix + '!' + name : name, //fullName\r\n            n: name,\r\n            pr: prefix,\r\n            p: plugin\r\n        };\r\n    };\r\n\r\n    function makeConfig(name) {\r\n        return function () {\r\n            return (config && config.config && config.config[name]) || {};\r\n        };\r\n    }\r\n\r\n    handlers = {\r\n        require: function (name) {\r\n            return makeRequire(name);\r\n        },\r\n        exports: function (name) {\r\n            var e = defined[name];\r\n            if (typeof e !== 'undefined') {\r\n                return e;\r\n            } else {\r\n                return (defined[name] = {});\r\n            }\r\n        },\r\n        module: function (name) {\r\n            return {\r\n                id: name,\r\n                uri: '',\r\n                exports: defined[name],\r\n                config: makeConfig(name)\r\n            };\r\n        }\r\n    };\r\n\r\n    main = function (name, deps, callback, relName) {\r\n        var cjsModule, depName, ret, map, i, relParts,\r\n            args = [],\r\n            callbackType = typeof callback,\r\n            usingExports;\r\n\r\n        //Use name if no relName\r\n        relName = relName || name;\r\n        relParts = makeRelParts(relName);\r\n\r\n        //Call the callback to define the module, if necessary.\r\n        if (callbackType === 'undefined' || callbackType === 'function') {\r\n            //Pull out the defined dependencies and pass the ordered\r\n            //values to the callback.\r\n            //Default to [require, exports, module] if no deps\r\n            deps = !deps.length && callback.length ? ['require', 'exports', 'module'] : deps;\r\n            for (i = 0; i < deps.length; i += 1) {\r\n                map = makeMap(deps[i], relParts);\r\n                depName = map.f;\r\n\r\n                //Fast path CommonJS standard dependencies.\r\n                if (depName === \"require\") {\r\n                    args[i] = handlers.require(name);\r\n                } else if (depName === \"exports\") {\r\n                    //CommonJS module spec 1.1\r\n                    args[i] = handlers.exports(name);\r\n                    usingExports = true;\r\n                } else if (depName === \"module\") {\r\n                    //CommonJS module spec 1.1\r\n                    cjsModule = args[i] = handlers.module(name);\r\n                } else if (hasProp(defined, depName) ||\r\n                           hasProp(waiting, depName) ||\r\n                           hasProp(defining, depName)) {\r\n                    args[i] = callDep(depName);\r\n                } else if (map.p) {\r\n                    map.p.load(map.n, makeRequire(relName, true), makeLoad(depName), {});\r\n                    args[i] = defined[depName];\r\n                } else {\r\n                    throw new Error(name + ' missing ' + depName);\r\n                }\r\n            }\r\n\r\n            ret = callback ? callback.apply(defined[name], args) : undefined;\r\n\r\n            if (name) {\r\n                //If setting exports via \"module\" is in play,\r\n                //favor that over return value and exports. After that,\r\n                //favor a non-undefined return value over exports use.\r\n                if (cjsModule && cjsModule.exports !== undef &&\r\n                        cjsModule.exports !== defined[name]) {\r\n                    defined[name] = cjsModule.exports;\r\n                } else if (ret !== undef || !usingExports) {\r\n                    //Use the return value from the function.\r\n                    defined[name] = ret;\r\n                }\r\n            }\r\n        } else if (name) {\r\n            //May just be an object definition for the module. Only\r\n            //worry about defining if have a module name.\r\n            defined[name] = callback;\r\n        }\r\n    };\r\n\r\n    requirejs = require = req = function (deps, callback, relName, forceSync, alt) {\r\n        if (typeof deps === \"string\") {\r\n            if (handlers[deps]) {\r\n                //callback in this case is really relName\r\n                return handlers[deps](callback);\r\n            }\r\n            //Just return the module wanted. In this scenario, the\r\n            //deps arg is the module name, and second arg (if passed)\r\n            //is just the relName.\r\n            //Normalize module name, if it contains . or ..\r\n            return callDep(makeMap(deps, makeRelParts(callback)).f);\r\n        } else if (!deps.splice) {\r\n            //deps is a config object, not an array.\r\n            config = deps;\r\n            if (config.deps) {\r\n                req(config.deps, config.callback);\r\n            }\r\n            if (!callback) {\r\n                return;\r\n            }\r\n\r\n            if (callback.splice) {\r\n                //callback is an array, which means it is a dependency list.\r\n                //Adjust args if there are dependencies\r\n                deps = callback;\r\n                callback = relName;\r\n                relName = null;\r\n            } else {\r\n                deps = undef;\r\n            }\r\n        }\r\n\r\n        //Support require(['a'])\r\n        callback = callback || function () {};\r\n\r\n        //If relName is a function, it is an errback handler,\r\n        //so remove it.\r\n        if (typeof relName === 'function') {\r\n            relName = forceSync;\r\n            forceSync = alt;\r\n        }\r\n\r\n        //Simulate async callback;\r\n        if (forceSync) {\r\n            main(undef, deps, callback, relName);\r\n        } else {\r\n            //Using a non-zero value because of concern for what old browsers\r\n            //do, and latest browsers \"upgrade\" to 4 if lower value is used:\r\n            //http://www.whatwg.org/specs/web-apps/current-work/multipage/timers.html#dom-windowtimers-settimeout:\r\n            //If want a value immediately, use require('id') instead -- something\r\n            //that works in almond on the global level, but not guaranteed and\r\n            //unlikely to work in other AMD implementations.\r\n            setTimeout(function () {\r\n                main(undef, deps, callback, relName);\r\n            }, 4);\r\n        }\r\n\r\n        return req;\r\n    };\r\n\r\n    /**\r\n     * Just drops the config on the floor, but returns req in case\r\n     * the config return value is used.\r\n     */\r\n    req.config = function (cfg) {\r\n        return req(cfg);\r\n    };\r\n\r\n    /**\r\n     * Expose module registry for debugging and tooling\r\n     */\r\n    requirejs._defined = defined;\r\n\r\n    define = function (name, deps, callback) {\r\n        if (typeof name !== 'string') {\r\n            throw new Error('See almond README: incorrect module build, no module name');\r\n        }\r\n\r\n        //This module may not have dependencies\r\n        if (!deps.splice) {\r\n            //deps is not an array, so probably means\r\n            //an object literal or factory function for\r\n            //the value. Adjust args.\r\n            callback = deps;\r\n            deps = [];\r\n        }\r\n\r\n        if (!hasProp(defined, name) && !hasProp(waiting, name)) {\r\n            waiting[name] = [name, deps, callback];\r\n        }\r\n    };\r\n\r\n    define.amd = {\r\n        jQuery: true\r\n    };\r\n}());\ndefine(\"js/almond\", function(){});\n\n// This is kowareta! because r.js does not generate module name:\r\n//   define(\"FSLib\",[], function () { ...\r\n/*\r\n(function (d,f) {\r\nmodule.exports=f();\r\n})\r\n*/\r\ndefine('FS',[],function () {\r\n    var define,requirejs;\r\n\tvar R={};\r\n\tvar REQJS=\"REQJS_\";\r\n\tvar reqjsSeq=0;\r\n\tR.def=function (name, reqs,func) {\r\n\t\tvar m=R.getModuleInfo(name);\r\n\t\tif (typeof reqs==\"function\") {\r\n\t\t    func=reqs;\r\n\t\t    reqs=R.reqsFromFunc(func);\r\n    \t\tR.setReqs( m, reqs);\r\n    \t\tm.func=function () {\r\n    \t\t    var module={exports:{}};\r\n    \t\t\tvar res=func(R.doLoad,module,module.exports);\r\n    \t\t\treturn res || module.exports;\r\n    \t\t};\r\n\t\t} else {\r\n    \t\tR.setReqs( m, reqs);\r\n    \t\tm.func=function () {\r\n    \t\t\treturn func.apply(this, R.getObjs(reqs));\r\n    \t\t};\r\n\t\t}\r\n\t\tR.loadIfAvailable(m);\r\n\t};\r\n\tdefine=function (name,reqs,func) {\r\n\t\tR.def(name, reqs,func);\r\n\t};\r\n\tdefine.amd={};\r\n\trequirejs=function (reqs,func) {\r\n\t\tR.def(REQJS+(reqjsSeq++),reqs,func);\r\n\t};\r\n\tR.setReqs=function (m, reqs) {\r\n\t\treqs.forEach(function (req) {\r\n\t\t\tvar reqm=R.getModuleInfo(req);\r\n\t\t\tif (!reqm.loaded) {\r\n\t\t\t\tm.reqs[req]=reqm;\r\n\t\t\t\treqm.revReqs[m.name]=m;\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\tR.getModuleInfo=function (name) {\r\n\t\tvar ms=R.modules;\r\n\t\treturn ms[name]=ms[name]||{name:name,reqs:{},revReqs:{}};\r\n\t};\r\n\tR.doLoad=function (name) {\r\n\t\tvar m=R.getModuleInfo(name);\r\n\t\tif (m.loaded) return m.obj;\r\n\t\tm.loaded=true;\r\n\t\tvar res=m.func();\r\n\t    if ( res==null && !name.match(/^REQJS_/)) console.log(\"Warning: No obj for \"+name);\r\n\t\tm.obj=res;\r\n\t\tfor (var i in m.revReqs) {\r\n\t\t\tR.notifyLoaded(m.revReqs[i], m.name);\r\n\t\t}\r\n\t\treturn res;\r\n\t};\r\n\tR.notifyLoaded=function (dependingMod, loadedModuleName) {\r\n\t    // depengindMod depends on loadedModule\r\n\t\tdelete dependingMod.reqs[loadedModuleName];\r\n\t\tR.loadIfAvailable(dependingMod);\r\n\t};\r\n\tR.loadIfAvailable=function (m) {\r\n\t\tfor (var i in m.reqs) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tR.doLoad(m.name);\r\n\t};\r\n\tR.getObjs=function (ary) {\r\n\t\tvar res=[];\r\n\t\tary.forEach(function (n) {\r\n\t\t\tvar cur=R.doLoad(n);\r\n\t\t\tres.push(cur);\r\n\t\t});\r\n\t\treturn res;\r\n\t};\r\n\tR.reqsFromFunc=function (f) {\r\n\t    var str=f+\"\";\r\n\t    var res=[];\r\n\t    str.replace(/require\\s*\\(\\s*[\"']([^\"']+)[\"']\\s*\\)/g,function (m,a) {\r\n\t       res.push(a);\r\n\t    });\r\n\t    return res;\r\n\t};\r\n\tR.modules={};\r\n\t//requireSimulator=R;\r\n//----------\r\ndefine('extend',[],function (){\r\n   return function extend(d,s) {\r\n      for (var i in s) {d[i]=s[i];}\r\n      return d;\r\n   };\r\n});\r\n\r\ndefine('assert',[],function () {\r\n    var Assertion=function(failMesg) {\r\n        this.failMesg=flatten(failMesg || \"Assertion failed: \");\r\n    };\r\n    var $a;\r\n    Assertion.prototype={\r\n        _regedType:{},\r\n        registerType: function (name,t) {\r\n            this._regedType[name]=t;\r\n        },\r\n        MODE_STRICT:\"strict\",\r\n        MODE_DEFENSIVE:\"defensive\",\r\n        MODE_BOOL:\"bool\",\r\n        fail:function () {\r\n            var a=$a(arguments);\r\n            var value=a.shift();\r\n            a=flatten(a);\r\n            a=this.failMesg.concat(value).concat(a);//.concat([\"(mode:\",this._mode,\")\"]);\r\n            console.log.apply(console,a);\r\n            if (this.isDefensive()) return value;\r\n            if (this.isBool()) return false;\r\n            throw new Error(a.join(\" \"));\r\n        },\r\n        subAssertion: function () {\r\n            var a=$a(arguments);\r\n            a=flatten(a);\r\n            return new Assertion(this.failMesg.concat(a));\r\n        },\r\n        assert: function (t,failMesg) {\r\n            if (!t) return this.fail(t,failMesg);\r\n            return t;\r\n        },\r\n        eq: function (a,b) {\r\n            if (a!==b) return this.fail(a,\"!==\",b);\r\n            return this.isBool()?true:a;\r\n        },\r\n        ne: function (a,b) {\r\n            if (a===b) return this.fail(a,\"===\",b);\r\n            return this.isBool()?true:a;\r\n        },\r\n        isset: function (a, n) {\r\n            if (a==null) return this.fail(a, (n||\"\")+\" is null/undef\");\r\n            return this.isBool()?true:a;\r\n        },\r\n        is: function (value,type) {\r\n            var t=type,v=value;\r\n            if (t==null) {\r\n                return this.fail(value, \"assert.is: type must be set\");\r\n                // return t; Why!!!!???? because is(args,[String,Number])\r\n            }\r\n            if (t._assert_func) {\r\n                t._assert_func.apply(this,[v]);\r\n                return this.isBool()?true:value;\r\n            }\r\n            this.assert(value!=null,[value, \"should be \",t]);\r\n            if (t instanceof Array || (typeof global==\"object\" && typeof global.Array==\"function\" && t instanceof global.Array) ) {\r\n                if (!value || typeof value.length!=\"number\") {\r\n                    return this.fail(value, \"should be array:\");\r\n                }\r\n                var self=this;\r\n                for (var i=0 ;i<t.length; i++) {\r\n                    var na=self.subAssertion(\"failed at \",value,\"[\",i,\"]: \");\r\n                    if (t[i]==null) {\r\n                        console.log(\"WOW!7\", v[i],t[i]);\r\n                    }\r\n                    na.is(v[i],t[i]);\r\n                }\r\n                return this.isBool()?true:value;\r\n            }\r\n            if (t===String || t==\"string\") {\r\n                this.assert(typeof(v)==\"string\",[v,\"should be a string \"]);\r\n                return this.isBool()?true:value;\r\n            }\r\n            if (t===Number || t==\"number\") {\r\n                this.assert(typeof(v)==\"number\",[v,\"should be a number\"]);\r\n                return this.isBool()?true:value;\r\n            }\r\n            if (t===Boolean || t==\"boolean\") {\r\n                this.assert(typeof(v)==\"boolean\",[v,\"should be a boolean\"]);\r\n                return this.isBool()?true:value;\r\n            }\r\n            if (t instanceof RegExp || (typeof global==\"object\" && typeof global.RegExp==\"function\" && t instanceof global.RegExp)) {\r\n                this.is(v,String);\r\n                this.assert(t.exec(v),[v,\"does not match to\",t]);\r\n                return this.isBool()?true:value;\r\n            }\r\n            if (t===Function) {\r\n                this.assert(typeof v==\"function\",[v,\"should be a function\"]);\r\n                return this.isBool()?true:value;\r\n            }\r\n            if (typeof t==\"function\") {\r\n                this.assert((v instanceof t),[v, \"should be \",t]);\r\n                return this.isBool()?true:value;\r\n            }\r\n            if (t && typeof t==\"object\") {\r\n                for (var k in t) {\r\n                    var na=this.subAssertion(\"failed at \",value,\".\",k,\":\");\r\n                    na.is(value[k],t[k]);\r\n                }\r\n                return this.isBool()?true:value;\r\n            }\r\n            if (typeof t==\"string\") {\r\n                var ty=this._regedType[t];\r\n                if (ty) return this.is(value,ty);\r\n                //console.log(\"assertion Warning:\",\"unregistered type:\", t, \"value:\",value);\r\n                return this.isBool()?true:value;\r\n            }\r\n            return this.fail(value, \"Invaild type: \",t);\r\n        },\r\n        ensureError: function (action, err) {\r\n            try {\r\n                action();\r\n            } catch(e) {\r\n                if(typeof err==\"string\") {\r\n                    assert(e+\"\"===err,action+\" thrown an error \"+e+\" but expected:\"+err);\r\n                }\r\n                console.log(\"Error thrown successfully: \",e.message);\r\n                return;\r\n            }\r\n            this.fail(action,\"should throw an error\",err);\r\n        },\r\n        setMode:function (mode) {\r\n            this._mode=mode;\r\n        },\r\n        isDefensive:function () {\r\n            return this._mode===this.MODE_DEFENSIVE;\r\n        },\r\n        isBool:function () {\r\n            return this._mode===this.MODE_BOOL;\r\n        },\r\n        isStrict:function () {\r\n            return !this.isDefensive() && !this.isBool();\r\n        }\r\n    };\r\n    $a=function (args) {\r\n        var a=[];\r\n        for (var i=0; i<args.length ;i++) a.push(args[i]);\r\n        return a;\r\n    };\r\n    var top=new Assertion();\r\n    var assert=function () {\r\n        try {\r\n            return top.assert.apply(top,arguments);\r\n        } catch(e) {\r\n            throw new Error(e.stack);\r\n        }\r\n    };\r\n    [\"setMode\",\"isDefensive\",\"is\",\"isset\",\"ne\",\"eq\",\"ensureError\"].forEach(function (m) {\r\n        assert[m]=function () {\r\n            try {\r\n                return top[m].apply(top,arguments);\r\n            } catch(e) {\r\n                console.log(e.stack);\r\n                //if (top.isDefensive()) return arguments[0];\r\n                //if (top.isBool()) return false;\r\n                throw new Error(e.message);\r\n            }\r\n        };\r\n    });\r\n    assert.fail=top.fail.bind(top);\r\n    assert.MODE_STRICT=top.MODE_STRICT;\r\n    assert.MODE_DEFENSIVE=top.MODE_DEFENSIVE;\r\n    assert.MODE_BOOL=top.MODE_BOOL;\r\n    assert.f=function (f) {\r\n        return {\r\n            _assert_func: f\r\n        };\r\n    };\r\n    assert.opt=function (t) {\r\n        return assert.f(function (v) {\r\n            return v==null || v instanceof t;\r\n        });\r\n    };\r\n    assert.and=function () {\r\n        var types=$a(arguments);\r\n        assert(types instanceof Array);\r\n        return assert.f(function (value) {\r\n            var t=this;\r\n            for (var i=0; i<types.length; i++) {\r\n                t.is(value,types[i]);\r\n            }\r\n        });\r\n    };\r\n    function flatten(a) {\r\n        if (a instanceof Array) {\r\n            var res=[];\r\n            a.forEach(function (e) {\r\n                res=res.concat(flatten(e));\r\n            });\r\n            return res;\r\n        }\r\n        return [a];\r\n    }\r\n    function isArg(a) {\r\n        return \"length\" in a && \"caller\" in a && \"callee\" in a;\r\n    };\r\n    return assert;\r\n});\r\n\r\ndefine('PathUtil',[\"assert\"],function (assert) {\r\nfunction endsWith(str,postfix) {\r\n    assert.is(arguments,[String,String]);\r\n    return str.substring(str.length-postfix.length)===postfix;\r\n}\r\nfunction startsWith(str,prefix) {\r\n    assert.is(arguments,[String,String]);\r\n    return str.substring(0, prefix.length)===prefix;\r\n}\r\nvar driveLetter=/^([a-zA-Z]):/;\r\n// hyphen on protocol -> chrome-extension://....\r\nvar url=/^([a-z\\-]+):\\/\\/\\/?([^\\/]+)\\//;\r\nvar PathUtil;\r\nvar Path=assert.f(function (s) {\r\n    this.is(s,String);\r\n    this.assert( PathUtil.isPath(s) , [s, \" is not a path\"]);\r\n});\r\nvar Absolute=assert.f(function (s) {\r\n    this.is(s,String);\r\n    this.assert( PathUtil.isAbsolutePath(s) , [s, \" is not a absolute path\"]);\r\n});\r\nvar Relative=assert.f(function (s) {\r\n    this.is(s,String);\r\n    this.assert( !PathUtil.isAbsolutePath(s) , [s, \" is not a relative path\"]);\r\n});\r\n\r\nvar Dir=assert.f(function (s) {\r\n    this.is(s,Path);\r\n    this.assert( PathUtil.isDir(s) , [s, \" is not a directory path\"]);\r\n});\r\nvar AbsDir=assert.and(Dir,Absolute);\r\nvar File=assert.f(function (s) {\r\n    this.is(s,Path);\r\n    this.assert( !PathUtil.isDir(s) , [s, \" is not a file path\"]);\r\n});\r\n\r\nvar SEP=\"/\";\r\nPathUtil={\r\n    Path: Path,Absolute:Absolute, Relative:Relative, Dir:Dir,File:File,\r\n    AbsDir:AbsDir,\r\n    SEP: SEP,\r\n    endsWith: endsWith, startsWith:startsWith,\r\n    isChildOf: function(child, parent) {\r\n        return this.startsWith( this.normalize(child), this.normalize(parent));\r\n    },\r\n    normalize: function (path) {\r\n        return this.fixSep(path,\"/\").replace(/\\/+$/,\"/\");\r\n    },\r\n    hasDriveLetter: function (path) {\r\n        return driveLetter.exec(path);\r\n    },\r\n    isURL: function (path) {\r\n        var r=url.exec(path);\r\n        if (!r) return;\r\n        return {protocol:r[1], hostPort:r[2], path:SEP+path.substring(r[0].length)  };\r\n    },\r\n    isPath: function (path) {\r\n    \tassert.is(arguments,[String]);\r\n\t\treturn true;//!path.match(/\\/\\//);\r\n    },\r\n    isRelativePath: function (path) {\r\n\t\tassert.is(arguments,[String]);\r\n\t\treturn PathUtil.isPath(path) && !PathUtil.isAbsolutePath(path);\r\n    },\r\n    isAbsolutePath: function (path) {\r\n\t\tassert.is(arguments,[String]);\r\n\t\treturn PathUtil.isPath(path) &&\r\n\t\t(PathUtil.startsWith(path,SEP) || PathUtil.hasDriveLetter(path) ||  PathUtil.isURL(path));\r\n    },\r\n    isDir: function (path) {\r\n        path=PathUtil.fixSep(path);\r\n\t\tassert.is(arguments,[Path]);\r\n        return endsWith(path,SEP);\r\n    },\r\n    hasBackslashSep:function (path) {\r\n        return path.indexOf(\"\\\\\")>=0;\r\n    },\r\n    fixSep: function (path,to) {\r\n        to=to||\"/\";\r\n        assert.is(arguments,[String]);\r\n        return assert.is( path.replace(/[\\\\\\/]/g,to), Path);\r\n    },\r\n    directorify: function (path) {\r\n        //path=PathUtil.fixSep(path);\r\n        if (PathUtil.isDir(path)) return path;\r\n        return assert.is(path+SEP, Dir);\r\n    },\r\n    filify: function (path) {\r\n        //path=PathUtil.fixSep(path);\r\n        if (!PathUtil.isDir(path)) return path;\r\n        return assert.is(path.substring(0,path.length-1),File);\r\n    },\r\n\tsplitPath: function (path) {\r\n\t\tassert.is(arguments,[Path]);\r\n\t\tvar u;\r\n\t\tif (u=this.isURL(path)) {\r\n\t\t    var p=this.splitPath(u.path);\r\n\t\t    p[0]=u.protocol+\"://\"+u.hostPort;\r\n\t\t    return p;\r\n\t\t}\r\n\t\tpath=path.replace(/\\/+/g,SEP);\r\n\t    var res=path.split(SEP);\r\n        if (res[res.length-1]==\"\") {\r\n            res[res.length-2]+=SEP;\r\n            res.pop();\r\n        }\r\n        return res;\r\n    },\r\n    name: function(path) {\r\n\t\tassert.is(arguments,[String]);\r\n        return PathUtil.splitPath(path).pop();\r\n    },\r\n    ext: function(path) {\r\n\t\tassert.is(arguments,[String]);\r\n        var n = PathUtil.name(path);\r\n        var r = (/\\.[a-zA-Z0-9]+$/).exec(n);\r\n        if (r) return r[0];\r\n        return null;\r\n    },\r\n    truncExt: function(path, ext) {\r\n\t\tassert.is(path,String);\r\n        var name = PathUtil.name(path);\r\n        ext=ext || PathUtil.ext(path);\r\n        assert.is(ext,String);\r\n        return name.substring(0, name.length - ext.length);\r\n    },\r\n    truncSEP: function (path) {\r\n\t\tassert.is(arguments,[Path]);\r\n\t\tif (!PathUtil.isDir(path)) return path;\r\n\t\treturn path.substring(0,path.length-1);\r\n    },\r\n    endsWith: function(path, postfix) {\r\n\t\tassert.is(arguments,[String,String]);\r\n        return endsWith(PathUtil.name(path), postfix);\r\n    },\r\n    parent: function(path) {\r\n\t\tassert.is(arguments,[String]);\r\n        return PathUtil.up(path);\r\n    },\r\n    rel: function(path,relPath) {\r\n        if (relPath==\"\") return path;\r\n\t\tassert.is(arguments,[AbsDir, Relative]);\r\n    \tvar paths=PathUtil.splitPath(relPath);\r\n        var resPath=path;\r\n        resPath=resPath.replace(/\\/$/,\"\");\r\n        var t=PathUtil;\r\n        paths.forEach(function (n) {\r\n             if (n==\"..\" || n==\"../\") resPath=t.up(resPath);\r\n             else {\r\n                 resPath=resPath.replace(/\\/$/,\"\");\r\n                 resPath+=SEP+(n==\".\"||n==\"./\" ? \"\": n);\r\n             }\r\n        });\r\n        return resPath;\r\n    },\r\n    relPath: function(path,base) {\r\n\t\tassert.is(arguments,[Absolute,Absolute]);\r\n        if (path.substring(0,base.length)!=base) {\r\n            return \"../\"+PathUtil.relPath(path, this.up(base));\r\n        }\r\n        return path.substring(base.length);\r\n    },\r\n    up: function(path) {\r\n        //path=PathUtil.fixSep(path);\r\n        if (path==SEP) return null;\r\n        var ps=PathUtil.splitPath(path);\r\n        ps.pop();\r\n        return ps.join(SEP)+SEP;\r\n    }\r\n};\r\n[\"directorify\", \"filify\", \"splitPath\", \"name\", \"rel\", \"relPath\", \"up\"].forEach(function (k) {\r\n    var old=PathUtil[k];\r\n    PathUtil[k]=function () {\r\n        var backslashifyAfter=false;\r\n        var a=Array.prototype.slice.call(arguments).map(function (e) {\r\n            if (PathUtil.hasBackslashSep(e)) {\r\n                backslashifyAfter=true;\r\n                return PathUtil.fixSep(e);\r\n            } else {\r\n                return e;\r\n            }\r\n        });\r\n        var res=old.apply(PathUtil,a);\r\n        if (backslashifyAfter) {\r\n            return PathUtil.fixSep(res,\"\\\\\");\r\n        } else {\r\n            return res;\r\n        }\r\n    };\r\n});\r\n\r\nPathUtil.isAbsolute=PathUtil.isAbsolutePath;\r\nPathUtil.isRelative=PathUtil.isRelativePath;\r\nif (typeof window==\"object\") window.PathUtil=PathUtil;\r\nreturn PathUtil;\r\n});\r\n\r\ndefine('MIMETypes',[], function () {\r\n   return {\r\n      \".png\":\"image/png\",\r\n      \".gif\":\"image/gif\",\r\n      \".jpeg\":\"image/jpeg\",\r\n      \".jpg\":\"image/jpeg\",\r\n      \".ico\":\"image/icon\",\r\n      \".wav\":\"audio/x-wav\",\r\n      \".mp3\":\"audio/mp3\",\r\n      \".ogg\":\"audio/ogg\",\r\n      \".midi\":\"audio/midi\",\r\n      \".mid\":\"audio/midi\",\r\n      \".mzo\":\"audio/mzo\",\r\n      \".txt\":\"text/plain\",\r\n      \".html\":\"text/html\",\r\n      \".htm\":\"text/html\",\r\n      \".css\":\"text/css\",\r\n      \".js\":\"text/javascript\",\r\n      \".json\":\"text/json\",\r\n      \".zip\":\"application/zip\",\r\n      \".swf\":\"application/x-shockwave-flash\",\r\n      \".pdf\":\"application/pdf\",\r\n      \".doc\":\"application/word\",\r\n      \".xls\":\"application/excel\",\r\n      \".ppt\":\"application/powerpoint\",\r\n      '.docx':'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\r\n      '.docm':'application/vnd.ms-word.document.macroEnabled.12',\r\n      '.dotx':'application/vnd.openxmlformats-officedocument.wordprocessingml.template',\r\n      '.dotm':'application/vnd.ms-word.template.macroEnabled.12',\r\n      '.xlsx':'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\r\n      '.xlsm':'application/vnd.ms-excel.sheet.macroEnabled.12',\r\n      '.xltx':'application/vnd.openxmlformats-officedocument.spreadsheetml.template',\r\n      '.xltm':'application/vnd.ms-excel.template.macroEnabled.12',\r\n      '.xlsb':'application/vnd.ms-excel.sheet.binary.macroEnabled.12',\r\n      '.xlam':'application/vnd.ms-excel.addin.macroEnabled.12',\r\n      '.pptx':'application/vnd.openxmlformats-officedocument.presentationml.presentation',\r\n      '.pptm':'application/vnd.ms-powerpoint.presentation.macroEnabled.12',\r\n      '.potx':'application/vnd.openxmlformats-officedocument.presentationml.template',\r\n      '.potm':'application/vnd.ms-powerpoint.template.macroEnabled.12',\r\n      '.ppsx':'application/vnd.openxmlformats-officedocument.presentationml.slideshow',\r\n      '.ppsm':'application/vnd.ms-powerpoint.slideshow.macroEnabled.12',\r\n      '.ppam':'application/vnd.ms-powerpoint.addin.macroEnabled.12',\r\n      \".tonyu\":\"text/tonyu\",\r\n      \".c\":\"text/c\",\r\n      \".dtl\":\"text/dolittle\"\r\n   };\r\n});\r\n\r\n/*global window,self,global*/\r\ndefine('root',[],function (){\r\n    if (typeof window!==\"undefined\") return window;\r\n    if (typeof self!==\"undefined\") return self;\r\n    if (typeof global!==\"undefined\") return global;\r\n    return (function (){return this;})();\r\n});\r\n\r\ndefine('DeferredUtil',[\"root\"], function (root) {\r\n    //  promise.then(S,F)  and promise.then(S).fail(F) is not same!\r\n    //  ->  when fail on S,  F is executed?\r\n    //   same is promise.then(S).then(same,F)\r\n    var DU;\r\n    var DUBRK=function(r){this.res=r;};\r\n    function same(e){return e;}\r\n    DU={\r\n        isNativePromise: function (p) {\r\n            return p && (typeof p.then===\"function\") &&\r\n            (typeof p.promise!==\"function\") && (typeof p.catch===\"function\") ;\r\n        },\r\n        isJQPromise: function (p) {\r\n            return p && (typeof p.then===\"function\") &&\r\n            (typeof p.promise===\"function\") &&(typeof p.fail===\"function\") ;\r\n        },\r\n        isPromise: function (p) {\r\n            return p && (typeof p.then===\"function\") &&\r\n            ((typeof p.promise===\"function\") || (typeof p.catch===\"function\")) ;\r\n        },\r\n        all: function (a) {\r\n            //var a=Array.prototype.slice.call(arguments);\r\n            return DU.promise(function (succ,fail) {\r\n                var res=[],rest=a.length;\r\n                a.forEach(function (p, i) {\r\n                    DU.resolve(p).then(function (r) {\r\n                        res[i]=r;\r\n                        rest--;\r\n                        if (rest===0) {\r\n                            succ(res);\r\n                        }\r\n                    },fail);\r\n                });\r\n            });\r\n        },\r\n        resolve: function (p) {\r\n            if (DU.config.useJQ && DU.isJQPromise(p)) return p;\r\n            if (!DU.config.useJQ && DU.isNativePromise(p)) return p;\r\n            return DU.promise(function (succ,fail) {\r\n                if (DU.isPromise(p)) {\r\n                    p.then(succ,fail);\r\n                } else {\r\n                    succ(p);\r\n                }\r\n            });\r\n            /*if (DU.isPromise(p)) { // NO! it returns Promise when using JQPromise and vise versa.\r\n                return f;\r\n            }\r\n            if (DU.confing.useJQ) {\r\n                return $.when(p);\r\n            }*/\r\n        },\r\n        throwNowIfRejected: function (p) {\r\n            // If Promise p has already rejected, throws the rejeceted reason immediately.\r\n            var state;\r\n            var err;\r\n            var res=p.then(function (r) {\r\n                if (!state) {\r\n                    state=\"resolved\";\r\n                }\r\n                return r;\r\n            },function (e) {\r\n                if (!state) {\r\n                    state=\"rejected\";\r\n                    err=e;\r\n                } else {\r\n                    return DU.reject(e);\r\n                }\r\n            });\r\n            if (!state) state=\"notyet\";\r\n            if (state===\"rejected\") throw err;\r\n            return res;\r\n        },\r\n        assertResolved: function (p) {\r\n            var res,resolved;\r\n            p.then(function (r) {\r\n                res=r;\r\n                resolved=true;\r\n            });\r\n            if (!resolved) {\r\n                throw new Error(\"Promise not resolved\");\r\n            }\r\n            return res;\r\n        },\r\n        /*toJQPromise: function (p) {// From native Promise\r\n            if (!p) return $.when(p);\r\n            if ($.isFunction(p.promise)) return p;\r\n            if (!$.isFunction(p.then) || !$.isFunction(p.catch)) return $.when(p);\r\n            var d=new $.Deferred();\r\n            p.then(function (r) {\r\n                d.resolve(r);\r\n            }).catch(function (r) {\r\n                d.reject(r);\r\n            });\r\n            return d.promise();\r\n        },*/\r\n        ensureDefer: function (v) {\r\n            return DU.promise(function (resolve,reject) {\r\n                var isDeferred;\r\n                DU.resolve(v).then(function (r) {\r\n                    if (!isDeferred) {\r\n                        setTimeout(function () {\r\n                            resolve(r);\r\n                        },0);\r\n                    } else {\r\n                        resolve(r);\r\n                    }\r\n                }).then(same,function (r) {\r\n                    if (!isDeferred) {\r\n                        setTimeout(function () {\r\n                            reject(r);\r\n                        },0);\r\n                    } else {\r\n                        reject(r);\r\n                    }\r\n                });\r\n                isDeferred=true;\r\n            });\r\n        },\r\n        directPromise:function (v) {\r\n            return DU.timeout(v,0);\r\n        },\r\n        then: function (f) {\r\n            return DU.directPromise().then(f);\r\n        },\r\n        timeout:function (timeout,value) {\r\n            return DU.promise(function (resolve) {\r\n                setTimeout(function () {resolve(value);},timeout||0);\r\n            });\r\n        },\r\n        funcPromise:function (f) {\r\n            if (DU.config.useJQ) {\r\n                var d=new $.Deferred();\r\n                try {\r\n                    f(function (v) {\r\n                        d.resolve(v);\r\n                    },function (e) {\r\n                        d.reject(e);\r\n                    });\r\n                }catch(e) {\r\n                    d.reject(e);\r\n                }\r\n                return d.promise();\r\n            } else if (DU.external.Promise) {\r\n                return new DU.external.Promise(function (resolve,reject) {\r\n                    try {\r\n                        f(resolve,reject);\r\n                    }catch(e) {\r\n                        reject(e);\r\n                    }\r\n                });\r\n            } else {\r\n                throw new Error(\"promise is not found\");\r\n            }\r\n        },\r\n        reject: function (e) {\r\n            if (DU.config.useJQ) {\r\n                var d=new $.Deferred();\r\n                d.reject(e);\r\n                return d.promise();\r\n            } else {\r\n                return new DU.external.Promise(function (s,rej) {\r\n                    rej(e);\r\n                });\r\n            }\r\n        },\r\n        throwPromise:function (e) {\r\n            if (DU.config.useJQ) {\r\n                var d=new $.Deferred();\r\n                setTimeout(function () {\r\n                    d.reject(e);\r\n                }, 0);\r\n                return d.promise();\r\n            } else {\r\n                return new DU.external.Promise(function (s,rej) {\r\n                    rej(e);\r\n                });\r\n            }\r\n        },\r\n        throwF: function (f) {\r\n            return function () {\r\n                try {\r\n                    return f.apply(this,arguments);\r\n                } catch(e) {\r\n                    console.log(e,e.stack);\r\n                    return DU.throwPromise(e);\r\n                }\r\n            };\r\n        },\r\n        each: function (set,f) {\r\n            if (set instanceof Array) {\r\n                return DU.loop(function (i) {\r\n                    if (i>=set.length) return DU.brk();\r\n                    return DU.resolve(f(set[i],i)).then(function () {\r\n                        return i+1;\r\n                    });\r\n                },0);\r\n            } else {\r\n                var objs=[];\r\n                for (var i in set) {\r\n                    objs.push({k:i,v:set[i]});\r\n                }\r\n                return DU.each(objs,function (e) {\r\n                    return f(e.k, e.v);\r\n                });\r\n            }\r\n        },\r\n        loop: function (f,r) {\r\n            try {\r\n                var err;\r\n                while(true) {\r\n                    if (r instanceof DUBRK) return DU.when1(r.res);\r\n                    var deff1=true, deff2=false;\r\n                    // ★ not deffered  ☆  deferred\r\n                    var r1=f(r);\r\n                    var dr=DU.resolve(r1).then(function (r2) {\r\n                        r=r2;\r\n                        deff1=false;\r\n                        if (r instanceof DUBRK) return r.res;\r\n                        if (deff2) return DU.loop(f,r); //☆\r\n                    }).then(same,function (e) {\r\n                        deff1=false;\r\n                        err=e;\r\n                    });\r\n                    if (err) throw err;\r\n                    deff2=true;\r\n                    if (deff1) return dr;//☆\r\n                    //★\r\n                }\r\n            }catch (e) {\r\n                return DU.reject(e);\r\n            }\r\n        },\r\n        brk: function (res) {\r\n            return new DUBRK(res);\r\n        },\r\n        tryLoop: function (f,r) {\r\n            return DU.loop(DU.tr(f),r);\r\n        },\r\n        tryEach: function (s,f) {\r\n            return DU.loop(s,DU.tr(f));\r\n        },\r\n        documentReady:function () {\r\n            return DU.callbackToPromise(function (s) {$(s);});\r\n        },\r\n        requirejs:function (modules) {\r\n            if (!root.requirejs) throw new Error(\"requirejs is not loaded\");\r\n            return DU.callbackToPromise(function (s) {\r\n                root.requirejs(modules,s);\r\n            });\r\n        }\r\n    };\r\n    DU.NOP=function (r) {return r;};\r\n    DU.E=function () {\r\n        console.log(\"DUE\",arguments);\r\n        DU.errorHandler.apply(DU,arguments);\r\n    };\r\n    DU.errorHandler=function (e) {\r\n        console.error.apply(console,arguments);\r\n        alert(e);\r\n    };\r\n    DU.setE=function (f) {\r\n        DU.errorHandler=f;\r\n    };\r\n    DU.begin=DU.try=DU.tr=DU.throwF;\r\n    DU.promise=DU.callbackToPromise=DU.funcPromise;\r\n    DU.when1=DU.resolve;\r\n    DU.config={};\r\n    if (root.$ && root.$.Deferred) {\r\n        DU.config.useJQ=true;\r\n    }\r\n    DU.external={Promise:root.Promise};\r\n    if (!root.DeferredUtil) root.DeferredUtil=DU;\r\n    return DU;\r\n});\r\n\r\ndefine('FSClass',[\"extend\",\"PathUtil\",\"MIMETypes\",\"assert\",\"DeferredUtil\"],\r\nfunction (extend, P, M,assert,DU){\r\n    var FS=function () {\r\n    };\r\n    var fstypes={};\r\n    FS.addFSType=function (name,fsgen) {\r\n        fstypes[name]=fsgen;\r\n    };\r\n    FS.availFSTypes=function () {\r\n        return fstypes;\r\n    };\r\n    function stub(n) {\r\n        throw new Error (n+\" is STUB!\");\r\n    }\r\n    extend(FS.prototype, {\r\n        err: function (path, mesg) {\r\n            throw new Error(path+\": \"+mesg);\r\n        },\r\n        fstype:function () {\r\n            return \"Unknown\";\r\n        },\r\n        isReadOnly: function (path, options) {// mainly for check ENTIRELY read only\r\n            stub(\"isReadOnly\");\r\n        },\r\n        supportsSync: function () {\r\n            return true;\r\n        },\r\n        resolveFS:function (path, options) {\r\n            assert(this.getRootFS()!==this);\r\n            return this.getRootFS().resolveFS(path);\r\n        },\r\n        mounted: function (rootFS, mountPoint ) {\r\n            //assert.is(arguments,[FS,P.AbsDir]);\r\n            this.rootFS=rootFS;\r\n            this.mountPoint=mountPoint;\r\n        },\r\n        inMyFS:function (path) {\r\n            return !this.mountPoint || P.startsWith(path, this.mountPoint);\r\n        },\r\n        /*dirFromFstab: function (path, options) {\r\n            assert.is(path, P.AbsDir);\r\n            var res=(options||{}).res || [];\r\n            this.fstab().forEach(function (tb) {\r\n                if (P.up( tb.path )==path) res.push(P.name(tb.path));\r\n            });\r\n            return res;\r\n        },*/\r\n        getRootFS: function () {\r\n            return assert( this.rootFS, \"rootFS is not set\" );\r\n        },\r\n        //-------- end of mouting\r\n        //-------- spec\r\n        getReturnTypes: function (path, options) {\r\n            //{getContent:String|DataURL|ArrayBuffer|OutputStream|Writer\r\n            //   ,opendir:Array|...}\r\n            stub(\"\");\r\n        },\r\n        //-------  for file\r\n        getContent: function (path, options) {\r\n            // options:{type:String|DataURL|ArrayBuffer|OutputStream|Writer}\r\n            // succ : [type],\r\n            stub(\"getContent\");\r\n        },\r\n        size: function (path) {\r\n            var c=this.getContent(path,{type:ArrayBuffer});\r\n            var l=c.toBin().byteLength;\r\n            return l;\r\n        },\r\n        getContentAsync: function (path, options) {\r\n            if (!this.supportsSync()) stub(\"getContentAsync\");\r\n            return DU.resolve(this.getContent.apply(this,arguments));\r\n        },\r\n        setContent: function (path, content, options) {\r\n            // content: String|ArrayBuffer|InputStream|Reader\r\n            stub(\"\");\r\n        },\r\n        setContentAsync: function (path, content, options) {\r\n            var t=this;\r\n            if (!t.supportsSync()) stub(\"setContentAsync\");\r\n            return DU.resolve(content).then(function (content) {\r\n                return DU.resolve(t.setContent(path,content,options));\r\n            });\r\n        },\r\n        appendContent: function (path, content, options) {\r\n            //var nc=this.getContent(path,options).toPlainText()+content.toPlainText();\r\n            //return this.setContent(path, Content.fromPlainText(nc) , options);\r\n            stub(\"\");\r\n        },\r\n        appendContentAsync: function (path, content, options) {\r\n            var t=this;\r\n            if (!t.supportsSync()) stub(\"appendContentAsync\");\r\n            return DU.resolve(content).then(function (content) {\r\n                return DU.resolve(t.appendContent(path,content,options));\r\n            });\r\n        },\r\n        getMetaInfo: function (path, options) {\r\n            stub(\"\");\r\n        },\r\n        setMetaInfo: function (path, info, options) {\r\n            stub(\"\");\r\n        },\r\n        mkdir: function (path, options) {\r\n            stub(\"mkdir\");\r\n        },\r\n        touch: function (path) {\r\n            stub(\"touch\");\r\n        },\r\n        exists: function (path, options) {\r\n            // exists return false if path is existent by follwing symlink\r\n            stub(\"exists\");\r\n        },\r\n        opendir: function (path, options) {\r\n            //ret: [String] || Stream<string> // https://nodejs.org/api/stream.html#stream_class_stream_readable\r\n            stub(\"opendir\");\r\n        },\r\n        opendirAsync: function (path, options) {\r\n            if (!this.supportsSync()) stub(\"opendirAsync\");\r\n            return DU.resolve(this.opendir.apply(this,arguments));\r\n        },\r\n        cp: function(path, dst, options) {\r\n            assert.is(arguments,[P.Absolute,P.Absolute]);\r\n            this.assertExist(path);\r\n            options=options||{};\r\n            var srcIsDir=this.isDir(path);\r\n            var dstfs=this.getRootFS().resolveFS(dst);\r\n            var dstIsDir=dstfs.isDir(dst);\r\n            if (!srcIsDir && !dstIsDir) {\r\n                if (this.supportsSync() && dstfs.supportsSync()) {\r\n                    var cont=this.getContent(path);\r\n                    var res=dstfs.setContent(dst,cont);\r\n                    if (options.a) {\r\n                        dstfs.setMetaInfo(dst, this.getMetaInfo(path));\r\n                    }\r\n                    return res;\r\n                } else {\r\n                    return dstfs.setContentAsync(\r\n                            dst,\r\n                            this.getContentAsync(path)\r\n                    ).then(function (res) {\r\n                        if (options.a) {\r\n                            return dstfs.setMetaInfo(dst, this.getMetaInfo(path));\r\n                        }\r\n                        return res;\r\n                    });\r\n                }\r\n            } else {\r\n                throw new Error(\"only file to file supports\");\r\n            }\r\n        },\r\n        mv: function (path,to,options) {\r\n            this.cp(path,to,options);\r\n            return this.rm(path,{r:true});\r\n        },\r\n        rm:function (path, options) {\r\n            stub(\"\");\r\n        },\r\n        link: function (path, to, options) {\r\n            throw new Error(\"ln \"+to+\" \"+path+\" : This FS not support link.\");\r\n        },\r\n        getURL: function (path) {\r\n            stub(\"\");\r\n        },\r\n        onAddObserver: function (path) {\r\n        }\r\n    });\r\n    //res=[]; for (var k in a) { res.push(k); } res;\r\n    FS.delegateMethods=function (prototype,  methods) {\r\n        for (var n in methods) {\r\n            (function (n){\r\n                assert.ne(n,\"inMyFS\");\r\n                prototype[n]=function () {\r\n                    var path=arguments[0];\r\n                    assert.is(path,P.Absolute);\r\n                    var fs=this.resolveFS(path);\r\n                    //console.log(n, f.fs===this  ,f.fs, this);\r\n                    if (fs!==this) {\r\n                        console.log(\"Invoked for other fs\",this.mountPoint, fs.mountPoint)\r\n                        //arguments[0]=f.path;\r\n                        return fs[n].apply(fs, arguments);\r\n                    } else {\r\n                        return methods[n].apply(this, arguments);\r\n                    }\r\n                };\r\n            })(n);\r\n        }\r\n    };\r\n    FS.delegateMethods(FS.prototype, {\r\n        assertWriteable: function (path) {\r\n            if (this.isReadOnly(path)) this.err(path, \"read only.\");\r\n        },\r\n        getContentType: function (path, options) {\r\n            var e=(P.ext(path)+\"\").toLowerCase();\r\n            return M[e] || (options||{}).def || \"application/octet-stream\";\r\n        },\r\n        getBlob: function (path, options) {\r\n            var c=this.getContent(path);\r\n            options=options||{};\r\n            options.blobType=options.blobType||Blob;\r\n            options.binType=options.binType||ArrayBuffer;\r\n            if (c.hasPlainText()) {\r\n                return new options.blobType([c.toPlainText()],this.getContentType(path));\r\n            } else {\r\n                return new options.blobType([c.toBin(options.binType)],this.getContentType(path));\r\n            }\r\n        },\r\n        isText:function (path) {\r\n            var m=this.getContentType(path);\r\n            return P.startsWith( m, \"text\");\r\n        },\r\n        assertExist: function (path, options) {\r\n            if (!this.exists(path, options)) {\r\n                this.err(path, \": No such \"+(P.isDir(path)?\"directory\":\"file\"));\r\n            }\r\n        },\r\n        isDir: function (path,options) {\r\n            return P.isDir(path);\r\n        },\r\n        find: function (path, options) {\r\n            assert.is(arguments,[P.Absolute]);\r\n            var ls=this.opendir(path, options);\r\n            var t=this;\r\n            var res=[path];\r\n            ls.forEach(function (e) {\r\n                var ep=P.rel(path, e);\r\n                if (P.isDir(ep)) {\r\n                    var fs=t.resolveFS(ep);\r\n                    res=res.concat(\r\n                            fs.find( ep ,options)\r\n                    );\r\n                } else {\r\n                    res.push( ep );//getPathFromRootFS\r\n                }\r\n            });\r\n            return res;\r\n        },\r\n        resolveLink: function (path) {\r\n            assert.is(path,P.Absolute);\r\n            // returns non-link path\r\n            // ln -s /a/b/ /c/d/\r\n            // resolveLink /a/b/    ->  /a/b/\r\n            // resolveLink /c/d/e/f -> /a/b/e/f\r\n            // resolveLink /c/d/non_existent -> /a/b/non_existent\r\n            // isLink      /c/d/    -> /a/b/\r\n            // isLink      /c/d/e/f -> null\r\n            // ln /testdir/ /ram/files/\r\n            // resolveLink /ram/files/sub/test2.txt -> /testdir/sub/test2.txt\r\n            // path=/ram/files/test.txt\r\n            for (var p=path ; p ; p=P.up(p)) {\r\n                assert(!this.mountPoint || P.startsWith(p, this.mountPoint), p+\" is out of mountPoint. path=\"+path);\r\n                var l=this.isLink(p);  // p=/ram/files/ l=/testdir/\r\n                if (l) {\r\n                    assert(l!=p,\"l==p==\"+l);\r\n                    //        /testdir/    test.txt\r\n                    var np=P.rel(l,P.relPath(path, p));  //   /testdir/test.txt\r\n                    assert(np!=path,\"np==path==\"+np);\r\n                    return assert.is(this.getRootFS().resolveFS(np).resolveLink(np),P.Absolute)  ;\r\n                }\r\n                if (this.exists(p)) return path;\r\n            }\r\n            return path;\r\n        },\r\n        isLink: function (path) {\r\n            return null;\r\n        },\r\n        opendirEx: function (path, options) {\r\n            assert.is(path, P.AbsDir);\r\n            var ls=this.opendir(path);\r\n            var t=this;\r\n            var dest={};\r\n            ls.forEach(function (f) {\r\n                var p=P.rel(path,f);\r\n                dest[f]=t.getMetaInfo(p);\r\n            });\r\n            return dest;\r\n        },\r\n        getDirTree: function (path, options) {\r\n            options=options||{};\r\n            var dest=options.dest=options.dest||{};\r\n            options.style=options.style||\"flat-absolute\";\r\n            options.excludes=options.excludes||[];\r\n            assert.is(options.excludes,Array);\r\n            if (!options.base) {\r\n                options.base=path;\r\n            }\r\n            assert.is(path, P.AbsDir);\r\n            var tr=this.opendirEx(path,options);\r\n            if (options.style==\"no-recursive\") return tr;\r\n            var t=this;\r\n            for (var f in tr) {\r\n                var meta=tr[f];\r\n                var p=P.rel(path,f);\r\n                var relP=P.relPath(p,options.base);\r\n                switch(options.style) {\r\n                    case \"flat-relative\":\r\n                    case \"hierarchical\":\r\n                        if (options.excludes.indexOf(relP)>=0) {\r\n                            continue;\r\n                        }\r\n                        break;\r\n                    case \"flat-absolute\":\r\n                        if (options.excludes.indexOf(p)>=0) {\r\n                            continue;\r\n                        }\r\n                        break;\r\n                }\r\n                if (t.isDir(p)) {\r\n                    switch(options.style) {\r\n                    case \"flat-absolute\":\r\n                    case \"flat-relative\":\r\n                        t.getDirTree(p,options);\r\n                        break;\r\n                    case \"hierarchical\":\r\n                        options.dest={};\r\n                        dest[f]=t.getDirTree(p,options);\r\n                        break;\r\n                    }\r\n                } else {\r\n                    switch(options.style) {\r\n                    case \"flat-absolute\":\r\n                        dest[p]=meta;\r\n                        break;\r\n                    case \"flat-relative\":\r\n                        dest[relP]=meta;\r\n                        break;\r\n                    case \"hierarchical\":\r\n                        dest[f]=meta;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            return dest;\r\n        }\r\n        /*get: function (path) {\r\n            assert.eq(this.resolveFS(path), this);\r\n            return new SFile(this, path);\r\n            //var r=this.resolveFS(path);\r\n            //return new SFile(r.fs, r.path);\r\n        }*/\r\n\r\n    });\r\n    return FS;\r\n});\r\n\r\ndefine('Util',[],function () {\r\nfunction getQueryString(key, default_)\r\n{\r\n   if (default_==null) default_=\"\";\r\n   key = key.replace(/[\\[]/,\"\\\\\\[\").replace(/[\\]]/,\"\\\\\\]\");\r\n   var regex = new RegExp(\"[\\\\?&]\"+key+\"=([^&#]*)\");\r\n   var qs = regex.exec(window.location.href);\r\n   if(qs == null)\r\n    return default_;\r\n   else\r\n    return decodeURLComponentEx(qs[1]);\r\n}\r\nfunction decodeURLComponentEx(s){\r\n    return decodeURIComponent(s.replace(/\\+/g, '%20'));\r\n}\r\nfunction endsWith(str,postfix) {\r\n    return str.substring(str.length-postfix.length)===postfix;\r\n}\r\nfunction startsWith(str,prefix) {\r\n    return str.substring(0, prefix.length)===prefix;\r\n}\r\nfunction privatize(o){\r\n    if (o.__privatized) return o;\r\n    var res={__privatized:true};\r\n    for (var n in o) {\r\n        (function (n) {\r\n            var m=o[n];\r\n            if (n.match(/^_/)) return;\r\n            if (typeof m!=\"function\") return;\r\n            res[n]=function () {\r\n                var r=m.apply(o,arguments);\r\n                return r;\r\n            };\r\n        })(n);\r\n    }\r\n    return res;\r\n}\r\nfunction extend(d,s) {\r\n    for (var i in (s||{})) {d[i]=s[i];} \r\n    return d;\r\n}\r\nreturn {\r\n    getQueryString:getQueryString,\r\n    endsWith: endsWith, startsWith: startsWith,\r\n    privatize: privatize,extend:extend\r\n};\r\n});\r\n\r\n/*\r\n* FileSaver.js\r\n* A saveAs() FileSaver implementation.\r\n*\r\n* By Eli Grey, http://eligrey.com\r\n*\r\n* License : https://github.com/eligrey/FileSaver.js/blob/master/LICENSE.md (MIT)\r\n* source  : http://purl.eligrey.com/github/FileSaver.js\r\n*/\r\ndefine('FileSaver',[],function (){\r\n\r\n// The one and only way of getting global scope in all environments\r\n// https://stackoverflow.com/q/3277182/1008999\r\nvar _global = typeof window === 'object' && window.window === window\r\n  ? window : typeof self === 'object' && self.self === self\r\n  ? self : typeof global === 'object' && global.global === global\r\n  ? global\r\n  : this\r\n\r\nfunction bom (blob, opts) {\r\n  if (typeof opts === 'undefined') opts = { autoBom: false }\r\n  else if (typeof opts !== 'object') {\r\n    console.warn('Depricated: Expected third argument to be a object')\r\n    opts = { autoBom: !opts }\r\n  }\r\n\r\n  // prepend BOM for UTF-8 XML and text/* types (including HTML)\r\n  // note: your browser will automatically convert UTF-16 U+FEFF to EF BB BF\r\n  if (opts.autoBom && /^\\s*(?:text\\/\\S*|application\\/xml|\\S*\\/\\S*\\+xml)\\s*;.*charset\\s*=\\s*utf-8/i.test(blob.type)) {\r\n    return new Blob([String.fromCharCode(0xFEFF), blob], { type: blob.type })\r\n  }\r\n  return blob\r\n}\r\n\r\nfunction download (url, name, opts) {\r\n  var xhr = new XMLHttpRequest()\r\n  xhr.open('GET', url)\r\n  xhr.responseType = 'blob'\r\n  xhr.onload = function () {\r\n    saveAs(xhr.response, name, opts)\r\n  }\r\n  xhr.onerror = function () {\r\n    console.error('could not download file')\r\n  }\r\n  xhr.send()\r\n}\r\n\r\nfunction corsEnabled (url) {\r\n  var xhr = new XMLHttpRequest()\r\n  // use sync to avoid popup blocker\r\n  xhr.open('HEAD', url, false)\r\n  xhr.send()\r\n  return xhr.status >= 200 && xhr.status <= 299\r\n}\r\n\r\n// `a.click()` doesn't work for all browsers (#465)\r\nfunction click(node) {\r\n  try {\r\n    node.dispatchEvent(new MouseEvent('click'))\r\n  } catch (e) {\r\n    var evt = document.createEvent('MouseEvents')\r\n    evt.initMouseEvent('click', true, true, window, 0, 0, 0, 80,\r\n                          20, false, false, false, false, 0, null)\r\n    node.dispatchEvent(evt)\r\n  }\r\n}\r\n\r\nvar saveAs = _global.saveAs ||\r\n// probably in some web worker\r\n(typeof window !== 'object' || window !== _global)\r\n  ? function saveAs () { /* noop */ }\r\n\r\n// Use download attribute first if possible (#193 Lumia mobile)\r\n: 'download' in HTMLAnchorElement.prototype\r\n? function saveAs (blob, name, opts) {\r\n  var URL = _global.URL || _global.webkitURL\r\n  var a = document.createElement('a')\r\n  name = name || blob.name || 'download'\r\n\r\n  a.download = name\r\n  a.rel = 'noopener' // tabnabbing\r\n\r\n  // TODO: detect chrome extensions & packaged apps\r\n  // a.target = '_blank'\r\n\r\n  if (typeof blob === 'string') {\r\n    // Support regular links\r\n    a.href = blob\r\n    if (a.origin !== location.origin) {\r\n      corsEnabled(a.href)\r\n        ? download(blob, name, opts)\r\n        : click(a, a.target = '_blank')\r\n    } else {\r\n      click(a)\r\n    }\r\n  } else {\r\n    // Support blobs\r\n    a.href = URL.createObjectURL(blob)\r\n    setTimeout(function () { URL.revokeObjectURL(a.href) }, 4E4) // 40s\r\n    setTimeout(function () { click(a) }, 0)\r\n  }\r\n}\r\n\r\n// Use msSaveOrOpenBlob as a second approach\r\n: 'msSaveOrOpenBlob' in navigator\r\n? function saveAs (blob, name, opts) {\r\n  name = name || blob.name || 'download'\r\n\r\n  if (typeof blob === 'string') {\r\n    if (corsEnabled(blob)) {\r\n      download(blob, name, opts)\r\n    } else {\r\n      var a = document.createElement('a')\r\n      a.href = blob\r\n      a.target = '_blank'\r\n      setTimeout(function () { click(a) })\r\n    }\r\n  } else {\r\n    navigator.msSaveOrOpenBlob(bom(blob, opts), name)\r\n  }\r\n}\r\n\r\n// Fallback to using FileReader and a popup\r\n: function saveAs (blob, name, opts, popup) {\r\n  // Open a popup immediately do go around popup blocker\r\n  // Mostly only avalible on user interaction and the fileReader is async so...\r\n  popup = popup || open('', '_blank')\r\n  if (popup) {\r\n    popup.document.title =\r\n    popup.document.body.innerText = 'downloading...'\r\n  }\r\n\r\n  if (typeof blob === 'string') return download(blob, name, opts)\r\n\r\n  var force = blob.type === 'application/octet-stream'\r\n  var isSafari = /constructor/i.test(_global.HTMLElement) || _global.safari\r\n  var isChromeIOS = /CriOS\\/[\\d]+/.test(navigator.userAgent)\r\n\r\n  if ((isChromeIOS || (force && isSafari)) && typeof FileReader === 'object') {\r\n    // Safari doesn't allow downloading of blob urls\r\n    var reader = new FileReader()\r\n    reader.onloadend = function () {\r\n      var url = reader.result\r\n      url = isChromeIOS ? url : url.replace(/^data:[^;]*;/, 'data:attachment/file;')\r\n      if (popup) popup.location.href = url\r\n      else location = url\r\n      popup = null // reverse-tabnabbing #460\r\n    }\r\n    reader.readAsDataURL(blob)\r\n  } else {\r\n    var URL = _global.URL || _global.webkitURL\r\n    var url = URL.createObjectURL(blob)\r\n    if (popup) popup.location = url\r\n    else location.href = url\r\n    popup = null // reverse-tabnabbing #460\r\n    setTimeout(function () { URL.revokeObjectURL(url) }, 4E4) // 40s\r\n  }\r\n}\r\n\r\n_global.saveAs = saveAs.saveAs = saveAs\r\n\r\nif (typeof module !== 'undefined') {\r\n  module.exports = saveAs;\r\n}\r\nreturn saveAs;\r\n});\r\n\r\ndefine('Content',[\"assert\",\"Util\",\"FileSaver\"],function (assert,Util,saveAs) {\r\n    var Content=function () {};\r\n    var extend=Util.extend;\r\n    // ------ constructor\r\n    Content.plainText=function (s,contentType){\r\n        var b=new Content;\r\n        b.contentType=contentType||\"text/plain\";\r\n        b.plain=s;\r\n        return b;\r\n    };\r\n    Content.url=function (s) {\r\n        var b=new Content;\r\n        b.url=s;\r\n        return b;\r\n    };\r\n    Content.buffer2ArrayBuffer = function (a) {\r\n        if (Content.isBuffer(a)) {\r\n            var u=new Uint8Array(a);\r\n            var r=u.buffer;\r\n            if (r instanceof ArrayBuffer) return r;\r\n            var ary=Array.prototype.slice.call(u);\r\n            return assert(new Uint8Array(ary).buffer,\"n2a: buf is not set\");\r\n        }\r\n        return assert(a,\"n2a: a is not set\");\r\n    };\r\n    Content.arrayBuffer2Buffer= function (a) {\r\n        if (a instanceof ArrayBuffer) {\r\n            var b=new Buffer(new Uint8Array(a));\r\n            return b;\r\n        }\r\n        return assert(a,\"a2n: a is not set\");\r\n    };\r\n\r\n    Content.bin=function (bin, contentType) {\r\n        assert(contentType, \"contentType should be set\");\r\n        var b=new Content;\r\n        if (Content.isNodeBuffer(bin)) {\r\n            b.bufType=\"node\";\r\n            b.nodeBuffer=bin;\r\n        } else if (bin instanceof ArrayBuffer) {\r\n            b.bufType=\"array2\";\r\n            b.arrayBuffer=bin;\r\n        } else if (bin && Content.isBuffer(bin.buffer)) {\r\n            // in node.js v8.9.1 ,\r\n            ///  bin is Buffer, bin.buffer is ArrayBuffer\r\n            //   and bin.buffer is content of different file(memory leak?) \r\n            b.bufType=\"array1\";\r\n            b.arrayBuffer=bin.buffer;\r\n        } else {\r\n            throw new Error(bin+\" is not a bin\");\r\n        }\r\n        b.contentType=contentType;\r\n        return b;\r\n    };\r\n    Content.looksLikeDataURL=function (text) {\r\n        return text.match(/^data:/);\r\n    };\r\n    Content.download=saveAs;\r\n    // why blob is not here... because blob content requires FileReader (cannot read instantly!)\r\n    //------- methods\r\n    var p=Content.prototype;\r\n    p.toBin = function (binType) {\r\n        binType=binType || (Content.hasNodeBuffer() ? Buffer: ArrayBuffer);\r\n        if (this.nodeBuffer) {\r\n            if (binType===Buffer) {\r\n                return this.nodeBuffer;\r\n            } else {\r\n                return this.arrayBuffer=( Content.buffer2ArrayBuffer(this.nodeBuffer) );\r\n            }\r\n        } else if (this.arrayBuffer) {\r\n            if (binType===ArrayBuffer) {\r\n                return this.arrayBuffer;\r\n            } else {\r\n                return this.nodeBuffer=( Content.arrayBuffer2Buffer(this.arrayBuffer) );\r\n            }\r\n        } else if (this.url) {\r\n            var d=new DataURL(this.url, binType);\r\n            return this.setBuffer(d.buffer);\r\n        } else if (this.plain!=null) {\r\n            return this.setBuffer( Content.str2utf8bytes(this.plain, binType) );\r\n        }\r\n        throw new Error(\"No data\");\r\n    };\r\n    p.setBuffer=function (b) {\r\n        assert(b,\"b is not set\");\r\n        if (Content.isNodeBuffer(b)) {\r\n            return this.nodeBuffer=b;\r\n        } else {\r\n            return this.arrayBuffer=b;\r\n        }\r\n    };\r\n    p.toArrayBuffer=function () {\r\n        return this.toBin(ArrayBuffer);\r\n    };\r\n    p.toNodeBuffer=function () {\r\n        return this.toBin(Buffer);\r\n    };\r\n    p.toURL=function () {\r\n        if (this.url) {\r\n            return this.url;\r\n        } else {\r\n            if (!this.arrayBuffer && this.plain!=null) {\r\n                this.arrayBuffer=Content.str2utf8bytes(this.plain,ArrayBuffer);\r\n            }\r\n            if (this.arrayBuffer || this.nodeBuffer) {\r\n                var d=new DataURL(this.arrayBuffer || this.nodeBuffer,this.contentType);\r\n                return this.url=d.url;\r\n            }\r\n        }\r\n        throw new Error(\"No data\");\r\n    };\r\n    p.toPlainText=function () {\r\n        if (this.hasPlainText()) {\r\n            return this.plain;\r\n        } else {\r\n            if (this.url && !this.hasBin() ) {\r\n                var d=new DataURL(this.url,ArrayBuffer);\r\n                this.arrayBuffer=d.buffer;\r\n            }\r\n            if (this.hasBin()) {\r\n                return this.plain=Content.utf8bytes2str(\r\n                        this.nodeBuffer || new Uint8Array(this.arrayBuffer)\r\n                );\r\n            }\r\n        }\r\n        throw new Error(\"No data\");\r\n    };\r\n    p.hasURL=function (){return this.url;};\r\n    p.hasPlainText=function (){return this.plain!=null;};\r\n    p.hasBin=function (){return this.nodeBuffer || this.arrayBuffer;};\r\n    p.hasNodeBuffer= function () {return this.nodeBuffer;};\r\n    p.hasArrayBuffer= function () {return this.arrayBuffer;};\r\n    p.toBlob=function () {\r\n        return new Blob([this.toBin(ArrayBuffer)],{type:this.contentType});\r\n    };\r\n    p.download=function (name) {\r\n        Content.download(this.toBlob(),name);\r\n    };\r\n    //--------Util funcs\r\n    // From http://hakuhin.jp/js/base64.html#BASE64_DECODE_ARRAY_BUFFER\r\n    Content.Base64_To_ArrayBuffer=function (base64,binType){\r\n\t    var A=binType||ArrayBuffer;\r\n        base64=base64.replace(/[\\n=]/g,\"\");\r\n        var dic = new Object();\r\n        dic[0x41]= 0; dic[0x42]= 1; dic[0x43]= 2; dic[0x44]= 3; dic[0x45]= 4; dic[0x46]= 5; dic[0x47]= 6; dic[0x48]= 7; dic[0x49]= 8; dic[0x4a]= 9; dic[0x4b]=10; dic[0x4c]=11; dic[0x4d]=12; dic[0x4e]=13; dic[0x4f]=14; dic[0x50]=15;\r\n        dic[0x51]=16; dic[0x52]=17; dic[0x53]=18; dic[0x54]=19; dic[0x55]=20; dic[0x56]=21; dic[0x57]=22; dic[0x58]=23; dic[0x59]=24; dic[0x5a]=25; dic[0x61]=26; dic[0x62]=27; dic[0x63]=28; dic[0x64]=29; dic[0x65]=30; dic[0x66]=31;\r\n        dic[0x67]=32; dic[0x68]=33; dic[0x69]=34; dic[0x6a]=35; dic[0x6b]=36; dic[0x6c]=37; dic[0x6d]=38; dic[0x6e]=39; dic[0x6f]=40; dic[0x70]=41; dic[0x71]=42; dic[0x72]=43; dic[0x73]=44; dic[0x74]=45; dic[0x75]=46; dic[0x76]=47;\r\n        dic[0x77]=48; dic[0x78]=49; dic[0x79]=50; dic[0x7a]=51; dic[0x30]=52; dic[0x31]=53; dic[0x32]=54; dic[0x33]=55; dic[0x34]=56; dic[0x35]=57; dic[0x36]=58; dic[0x37]=59; dic[0x38]=60; dic[0x39]=61; dic[0x2b]=62; dic[0x2f]=63;\r\n        var num = base64.length;\r\n        var n = 0;\r\n        var b = 0;\r\n        var e;\r\n\r\n        if(!num) return (new A(0));\r\n        //if(num < 4) return null;\r\n        //if(num % 4) return null;\r\n\r\n        // AA     12    1\r\n        // AAA    18    2\r\n        // AAAA   24    3\r\n        // AAAAA  30    3\r\n        // AAAAAA 36    4\r\n        // num*6/8\r\n        e = Math.floor(num / 4 * 3);\r\n        if(base64.charAt(num - 1) == '=') e -= 1;\r\n        if(base64.charAt(num - 2) == '=') e -= 1;\r\n\r\n        var ary_buffer = new A( e );\r\n        var ary_u8 = (Content.isNodeBuffer(ary_buffer) ? ary_buffer : new Uint8Array( ary_buffer ));//new Uint8Array( ary_buffer );\r\n        var i = 0;\r\n        var p = 0;\r\n        while(p < e){\r\n            b = dic[base64.charCodeAt(i)];\r\n            if(b === undefined) fail(\"Invalid letter: \"+base64.charCodeAt(i));//return null;\r\n            n = (b << 2);\r\n            i ++;\r\n\r\n            b = dic[base64.charCodeAt(i)];\r\n            if(b === undefined) fail(\"Invalid letter: \"+base64.charCodeAt(i))\r\n            ary_u8[p] = n | ((b >> 4) & 0x3);\r\n            n = (b & 0x0f) << 4;\r\n            i ++;\r\n            p ++;\r\n            if(p >= e) break;\r\n\r\n            b = dic[base64.charCodeAt(i)];\r\n            if(b === undefined) fail(\"Invalid letter: \"+base64.charCodeAt(i))\r\n            ary_u8[p] = n | ((b >> 2) & 0xf);\r\n            n = (b & 0x03) << 6;\r\n            i ++;\r\n            p ++;\r\n            if(p >= e) break;\r\n\r\n            b = dic[base64.charCodeAt(i)];\r\n            if(b === undefined) fail(\"Invalid letter: \"+base64.charCodeAt(i))\r\n            ary_u8[p] = n | b;\r\n            i ++;\r\n            p ++;\r\n        }\r\n        function fail(m) {\r\n            console.log(m);\r\n            console.log(base64,i);\r\n            throw new Error(m);\r\n        }\r\n        return ary_buffer;\r\n    };\r\n\r\n    Content.Base64_From_ArrayBuffer=function (ary_buffer){\r\n        var dic = [\r\n            'A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P',\r\n            'Q','R','S','T','U','V','W','X','Y','Z','a','b','c','d','e','f',\r\n            'g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','v',\r\n            'w','x','y','z','0','1','2','3','4','5','6','7','8','9','+','/'\r\n        ];\r\n        var base64 = \"\";\r\n        var ary_u8 = new Uint8Array( ary_buffer );\r\n        var num = ary_u8.length;\r\n        var n = 0;\r\n        var b = 0;\r\n\r\n        var i = 0;\r\n        while(i < num){\r\n            b = ary_u8[i];\r\n            base64 += dic[(b >> 2)];\r\n            n = (b & 0x03) << 4;\r\n            i ++;\r\n            if(i >= num) break;\r\n\r\n            b = ary_u8[i];\r\n            base64 += dic[n | (b >> 4)];\r\n            n = (b & 0x0f) << 2;\r\n            i ++;\r\n            if(i >= num) break;\r\n\r\n            b = ary_u8[i];\r\n            base64 += dic[n | (b >> 6)];\r\n            base64 += dic[(b & 0x3f)];\r\n            i ++;\r\n        }\r\n\r\n        var m = num % 3;\r\n        if(m){\r\n            base64 += dic[n];\r\n        }\r\n        if(m == 1){\r\n            base64 += \"==\";\r\n        }else if(m == 2){\r\n            base64 += \"=\";\r\n        }\r\n        return base64;\r\n    };\r\n\r\n    Content.hasNodeBuffer=function () {\r\n        return typeof Buffer!=\"undefined\";\r\n    };\r\n    Content.isNodeBuffer=function (data) {\r\n        return (Content.hasNodeBuffer() && data instanceof Buffer);\r\n    };\r\n    Content.isBuffer=function (data) {\r\n        return data instanceof ArrayBuffer || Content.isNodeBuffer(data);\r\n    };\r\n    Content.utf8bytes2str=function (bytes) {\r\n        var e=[];\r\n        for (var i=0 ; i<bytes.length ; i++) {\r\n             e.push(\"%\"+(\"0\"+bytes[i].toString(16)).slice(-2));\r\n        }\r\n        //try {\r\n            return decodeURIComponent(e.join(\"\"));\r\n        /*} catch (er) {\r\n            console.log(e.join(\"\"));\r\n            throw er;\r\n        }*/\r\n    };\r\n    Content.str2utf8bytes=function (str, binType) {\r\n        var e=encodeURIComponent(str);\r\n        var r=/^%(..)/;\r\n        var a=[];\r\n        var ad=0;\r\n        for (var i=0 ; i<e.length; i++) {\r\n            var m=r.exec( e.substring(i));\r\n            if (m) {\r\n                a.push(parseInt(\"0x\"+m[1]));\r\n                i+=m[0].length-1;\r\n            } else a.push(e.charCodeAt(i));\r\n        }\r\n        return (typeof Buffer!=\"undefined\" && binType===Buffer ? new Buffer(a) : new Uint8Array(a).buffer);\r\n    };\r\n    //-------- DataURL\r\n    var A=Content.hasNodeBuffer() ? Buffer :ArrayBuffer;\r\n    //var isBuffer=Util.isBuffer;\r\n    var DataURL=function (data, contentType){\r\n      // data: String/Array/ArrayBuffer\r\n      if (typeof data==\"string\") {\r\n          this.url=data;\r\n          this.binType=contentType || A;\r\n          this.dataURL2bin(data);\r\n      } else if (data && Content.isBuffer(data.buffer)) {\r\n          this.buffer=data.buffer;\r\n          assert.is(contentType,String);\r\n          this.contentType=contentType;\r\n          this.bin2dataURL(this.buffer, this.contentType);\r\n      } else if (Content.isBuffer(data)) {\r\n          this.buffer=data;\r\n          assert.is(contentType,String);\r\n          this.contentType=contentType;\r\n          this.bin2dataURL(this.buffer, this.contentType);\r\n      } else {\r\n          console.log(arguments);\r\n          assert.fail(\"Invalid args: \",arguments);\r\n      }\r\n   };\r\n   Content.DataURL=DataURL;\r\n   extend(DataURL.prototype,{\r\n      bin2dataURL: function (b, contentType) {\r\n          assert(Content.isBuffer(b));\r\n          assert.is(contentType,String);\r\n  \t     var head=this.dataHeader(contentType);\r\n\t     var base64=Content.Base64_From_ArrayBuffer(b);\r\n\t     assert.is(base64,String);\r\n\t     return this.url=head+base64;\r\n\t  },\r\n\t  dataURL2bin: function (dataURL) {\r\n          assert.is(arguments,[String]);\r\n\t      var reg=/^data:([^;]+);base64,/i;\r\n\t      var r=reg.exec(dataURL);\r\n\t      assert(r, [\"malformed dataURL:\", dataURL] );\r\n\t      this.contentType=r[1];\r\n\t      this.buffer=Content.Base64_To_ArrayBuffer(dataURL.substring(r[0].length) , this.binType);\r\n          return assert.is(this.buffer , this.binType);\r\n  \t  },\r\n  \t  dataHeader: function (ctype) {\r\n\t      assert.is(arguments,[String]);\r\n\t      return \"data:\"+ctype+\";base64,\";\r\n   \t  },\r\n   \t  toString: function () {return assert.is(this.url,String);}\r\n   });\r\n\r\n    return Content;\r\n});\r\n\r\n/*global process, global, Buffer, requirejs, require*/\r\ndefine('NativeFS',[\"FSClass\",\"assert\",\"PathUtil\",\"extend\",\"Content\"],\r\n        function (FS,A,P,extend,Content) {\r\n    var assert=A,fs;\r\n    const requireTries=[\r\n        ()=>require(\"fs\"),()=>requirejs.nodeRequire(\"fs\"),()=>global.require(\"fs\")\r\n    ];\r\n    for (let fsf of requireTries) {\r\n        try {\r\n            fs=fsf();\r\n            fs.existsSync('test.txt');\r\n            process.cwd();// fails here in NW.js Worker( fs is OK, process is absent)\r\n            break;\r\n        } catch(e){fs=null;}\r\n    }\r\n    if (!fs) {\r\n        return function () {\r\n            throw new Error(\"This system not support native FS\");\r\n        };\r\n    }\r\n    var NativeFS=function (rootPoint) {\r\n        if (rootPoint) {\r\n            A.is(rootPoint, P.AbsDir);\r\n            this.rootPoint=rootPoint;\r\n        }\r\n    };\r\n    var hasDriveLetter=P.hasDriveLetter(process.cwd());\r\n    NativeFS.available=true;\r\n    var SEP=P.SEP;\r\n    //var json=JSON; // JSON changes when page changes, if this is node module, JSON is original JSON\r\n    var Pro=NativeFS.prototype=new FS();\r\n    Pro.toNativePath = function (path) {\r\n        // rootPoint: on NativePath   C:/jail/\r\n        // mountPoint: on VirtualFS   /mnt/natfs/\r\n        if (!this.rootPoint) return path;\r\n        A.is(path, P.Absolute);\r\n        A(this.inMyFS(path),path+\" is not fs of \"+this);\r\n        //console.log(\"tonat:MP\",P.rel( this.rootPoint, P.relPath(path, this.mountPoint || P.SEP)));\r\n        return P.rel( this.rootPoint, P.relPath(path, this.mountPoint || P.SEP));\r\n    };\r\n    Pro.arrayBuffer2Buffer= function (a) {\r\n        if (a instanceof ArrayBuffer) {\r\n            var b=new Buffer(new Uint8Array(a));\r\n            return b;\r\n        }\r\n        return a;\r\n    };\r\n\r\n    FS.addFSType(\"NativeFS\",function (path, options) {\r\n            return new NativeFS(options.r);\r\n    });\r\n    NativeFS.prototype.fstype=function () {\r\n        return \"Native\"+(this.rootPoint?\"(\"+this.rootPoint+\")\":\"\");\r\n    };\r\n    NativeFS.prototype.inMyFS=function (path) {\r\n        //console.log(\"inmyfs\",path);\r\n        if (this.mountPoint) {\r\n            return P.startsWith(path, this.mountPoint);\r\n        } else {\r\n//            console.log(path, hasDriveLetter , P.hasDriveLetter(path));\r\n            return !( !!hasDriveLetter ^ !!P.hasDriveLetter(path));\r\n        }\r\n    };\r\n    function E(r){return r;}\r\n    FS.delegateMethods(NativeFS.prototype, {\r\n        getReturnTypes: function(path, options) {\r\n            E(path,options);\r\n            assert.is(arguments,[String]);\r\n            return {\r\n                getContent: ArrayBuffer, opendir:[String]\r\n            };\r\n        },\r\n        getContent: function (path, options) {\r\n            options=options||{};\r\n            A.is(path,P.Absolute);\r\n            var np=this.toNativePath(path);\r\n            this.assertExist(path);\r\n            /*if (this.isText(path)) {\r\n                return Content.plainText( fs.readFileSync(np, {encoding:\"utf8\"}) );\r\n            } else {*/\r\n                return Content.bin( fs.readFileSync(np) , this.getContentType(path));\r\n            //}\r\n        },\r\n        size: function(path) {\r\n            var np=this.toNativePath(path);\r\n            var st=fs.statSync(np);\r\n            return st.size;\r\n        },\r\n        setContent: function (path,content) {\r\n            A.is(arguments,[P.Absolute,Content]);\r\n            var pa=P.up(path);\r\n            if (pa) this.getRootFS().resolveFS(pa).mkdir(pa);\r\n            var np=this.toNativePath(path);\r\n            if (content.hasBin() || !content.hasPlainText() ) {\r\n                fs.writeFileSync(np, content.toNodeBuffer() );\r\n            } else {\r\n                // !hasBin && hasText\r\n                fs.writeFileSync(np, content.toPlainText());\r\n            }\r\n        },\r\n        appendContent: function (path,content) {\r\n            A.is(arguments,[P.Absolute,Content]);\r\n            var pa=P.up(path);\r\n            if (pa) this.getRootFS().resolveFS(pa).mkdir(pa);\r\n            var np=this.toNativePath(path);\r\n            if (content.hasBin() || !content.hasPlainText() ) {\r\n                fs.appendFileSync(np, content.toNodeBuffer() );\r\n            } else {\r\n                // !hasBin && hasText\r\n                fs.appendFileSync(np, content.toPlainText());\r\n            }\r\n        },\r\n        getMetaInfo: function(path, options) {\r\n            this.assertExist(path, options);\r\n            var s=this.stat(path);\r\n            s.lastUpdate=s.mtime.getTime();\r\n            return s;\r\n        },\r\n        setMetaInfo: function(path, info, options) {\r\n            E(path, info, options);\r\n            //options.lastUpdate\r\n\r\n            //TODO:\r\n        },\r\n        isReadOnly: function (path) {\r\n            E(path);\r\n            // TODO:\r\n            return false;\r\n        },\r\n        stat: function (path) {\r\n            A.is(path,P.Absolute);\r\n            var np=this.toNativePath(path);\r\n            return fs.statSync(np);\r\n        },\r\n        mkdir: function(path, options) {\r\n            options=options||{};\r\n            assert.is(arguments,[P.Absolute]);\r\n            if (this.exists(path)){\r\n                if (this.isDir(path)) {\r\n                    return;\r\n                } else {\r\n                    throw new Error(this+\" is a file. not a dir.\");\r\n                }\r\n            }\r\n            this.assertWriteable(path);\r\n            var pa=P.up(path);\r\n            if (pa) this.getRootFS().resolveFS(pa).mkdir(pa);\r\n            var np=this.toNativePath(path);\r\n            fs.mkdirSync(np);\r\n            return this.assertExist(np);\r\n        },\r\n        opendir: function (path, options) {\r\n            assert.is(arguments,[String]);\r\n            options=options||{};\r\n            var np=this.toNativePath(path);\r\n            var ts=P.truncSEP(np);\r\n            var r=fs.readdirSync(np);\r\n            if (!options.nosep) {\r\n                r=r.map(function (e) {\r\n                    var s=fs.statSync(ts+SEP+e);\r\n                    var ss=s.isDirectory()?SEP:\"\";\r\n                    return e+ss;\r\n                });\r\n            }\r\n            var res=[]; //this.dirFromFstab(path);\r\n            return assert.is(res.concat(r),Array);\r\n        },\r\n        rm: function(path, options) {\r\n            assert.is(arguments,[P.Absolute]);\r\n            options=options||{};\r\n            this.assertExist(path);\r\n            var np=this.toNativePath(path);\r\n            if (this.isDir(path)) {\r\n                return fs.rmdirSync(np);\r\n            } else {\r\n                return fs.unlinkSync(np);\r\n            }\r\n        },\r\n        // mv: is Difficult, should check dst.fs==src.fs\r\n        //     and both have not subFileSystems\r\n        exists: function (path, options) {\r\n            options=options||{};\r\n            var np=this.toNativePath(path);\r\n            return fs.existsSync(np);\r\n        },\r\n        isDir: function (path) {\r\n            if (!this.exists(path)) {\r\n                return P.isDir(path);\r\n            }\r\n            return this.stat(path).isDirectory();\r\n        },\r\n        /*link: function(path, to, options) {\r\n        }//TODO\r\n        isLink:\r\n        */\r\n        touch: function (path) {\r\n            if (!this.exists(path) && this.isDir(path)) {\r\n                this.mkdir(path);\r\n            } else if (this.exists(path) /*&& !this.isDir(path)*/ ) {\r\n                // TODO(setlastupdate)\r\n                fs.utimesSync(path,Date.now()/1000,Date.now()/1000);\r\n            }\r\n        },\r\n        getURL:function (path) {\r\n            return \"file:///\"+path.replace(/\\\\/g,\"/\");\r\n        },\r\n        onAddObserver: function (apath,options) {\r\n            var t=this;\r\n            var rfs=t.getRootFS();\r\n            options=options||{};\r\n            var isDir=this.isDir(apath);\r\n            //console.log(\"Invoke oao\",options);\r\n            var w=fs.watch(apath, options, function (evt,rpath) {\r\n                //console.log(path);\r\n                var fpath=isDir ? P.rel(apath,rpath) : apath;\r\n                var meta;\r\n                if (t.exists(fpath)) {\r\n                    meta=extend({eventType:evt},t.getMetaInfo(fpath));\r\n                } else {\r\n                    meta={eventType:evt};\r\n                }\r\n                rfs.notifyChanged(fpath,meta);\r\n            });\r\n            return {\r\n                remove: function () {\r\n                    w.close();\r\n                }\r\n            };\r\n        }\r\n    });\r\n    return NativeFS;\r\n});\r\n\r\ndefine('LSFS',[\"FSClass\",\"PathUtil\",\"extend\",\"assert\",\"Util\",\"Content\"],\r\n        function(FS,P,extend,assert,Util,Content) {\r\n    var LSFS = function(storage,options) {\r\n        assert(storage,\" new LSFS fail: no storage\");\r\n    \tthis.storage=storage;\r\n    \tthis.options=options||{};\r\n    \tif (this.options.useDirCache) this.dirCache={};\r\n    };\r\n    var isDir = P.isDir.bind(P);\r\n    var up = P.up.bind(P);\r\n    var endsWith= P.endsWith.bind(P);\r\n    //var getName = P.name.bind(P);\r\n    //var Path=P.Path;\r\n    var Absolute=P.Absolute;\r\n    var SEP= P.SEP;\r\n    function now(){\r\n        return new Date().getTime();\r\n    }\r\n    LSFS.ramDisk=function (options) {\r\n        var s={};\r\n        s[P.SEP]=\"{}\";\r\n        options=options||{};\r\n        if (!(\"useDirCache\" in options)) options.useDirCache=true;\r\n        return new LSFS(s,options);\r\n    };\r\n    FS.addFSType(\"localStorage\",function (path, options) {\r\n        return new LSFS(localStorage,options);\r\n    });\r\n    FS.addFSType(\"ram\",function (path, options) {\r\n        return LSFS.ramDisk(options);\r\n    });\r\n\r\n    LSFS.now=now;\r\n    LSFS.prototype=new FS();\r\n    //private methods\r\n    LSFS.prototype.resolveKey=function (path) {\r\n        assert.is(path,P.Absolute);\r\n        if (this.mountPoint) {\r\n            return P.SEP+P.relPath(path,this.mountPoint);//FromMountPoint(path);\r\n        } else {\r\n            return path;\r\n        }\r\n    };\r\n    LSFS.prototype.getItem=function (path) {\r\n        assert.is(path,P.Absolute);\r\n        var key=this.resolveKey(path);\r\n        return this.storage[key];\r\n    };\r\n    LSFS.prototype.setItem=function (path, value) {\r\n        assert.is(path,P.Absolute);\r\n        var key=this.resolveKey(path);\r\n        /*if (key.indexOf(\"..\")>=0) {\r\n            console.log(path,key,value);\r\n        }*/\r\n        assert(key.indexOf(\"..\")<0);\r\n        assert(P.startsWith(key,P.SEP));\r\n        this.storage[key]=value;\r\n    };\r\n    LSFS.prototype.removeItem=function (path) {\r\n        assert.is(path,P.Absolute);\r\n        var key=this.resolveKey(path);\r\n        delete this.storage[key];\r\n    };\r\n    LSFS.prototype.itemExists=function (path) {\r\n        assert.is(path,P.Absolute);\r\n        var key=this.resolveKey(path);\r\n        assert(this.storage,\"No storage\");\r\n        return key in this.storage;\r\n    };\r\n    /*LSFS.prototype.inMyFS=function (path){\r\n        return !this.mountPoint || P.startsWith(path, this.mountPoint);\r\n    };*/\r\n    LSFS.prototype.getDirInfo=function getDirInfo(path) {\r\n        assert.is(arguments,[P.AbsDir]);\r\n        if (path == null) throw new Error(\"getDir: Null path\");\r\n        if (!endsWith(path, SEP)) path += SEP;\r\n        assert(this.inMyFS(path));\r\n        if (this.dirCache && this.dirCache[path]) return this.dirCache[path];\r\n        var dinfo =  {},dinfos;\r\n        try {\r\n            dinfos = this.getItem(path);\r\n            if (dinfos) {\r\n                dinfo = JSON.parse(dinfos);\r\n            }\r\n        } catch (e) {\r\n            console.log(\"dinfo err : \" , path , dinfos);\r\n        }\r\n        if (this.dirCache) this.dirCache[path]=dinfo;\r\n        return dinfo;\r\n    };\r\n    LSFS.prototype.putDirInfo=function putDirInfo(path, dinfo, trashed) {\r\n  \t    assert.is(arguments,[P.AbsDir, Object]);\r\n  \t    if (!isDir(path)) throw new Error(\"Not a directory : \" + path);\r\n  \t    assert(this.inMyFS(path));\r\n  \t    if (this.dirCache) this.dirCache[path] = dinfo;\r\n  \t    this.setItem(path, JSON.stringify(dinfo));\r\n        var ppath = up(path);\r\n        if (ppath == null) return;\r\n        if (!this.inMyFS(ppath)) {\r\n            //assert(this.getRootFS()!==this);\r\n            //this.getRootFS().resolveFS(ppath).touch(ppath);\r\n            return;\r\n        }\r\n        var pdinfo = this.getDirInfo(ppath);\r\n        this._touch(pdinfo, ppath, P.name(path), trashed);\r\n    };\r\n    LSFS.prototype._touch=function _touch(dinfo, path, name, trashed) {\r\n        // path:path of dinfo\r\n        // trashed: this touch is caused by trashing the file/dir.\r\n        assert.is(arguments,[Object, String, String]);\r\n        assert(this.inMyFS(path));\r\n        var eventType=\"change\";\r\n        if (!dinfo[name]) {\r\n            eventType=\"create\";\r\n            dinfo[name] = {};\r\n            if (trashed) dinfo[name].trashed = true;\r\n        }\r\n        if (!trashed) delete dinfo[name].trashed;\r\n        dinfo[name].lastUpdate = now();\r\n        var meta=extend({eventType:eventType},dinfo[name]);\r\n        this.getRootFS().notifyChanged(P.rel(path,name), meta);\r\n        this.putDirInfo(path, dinfo, trashed);\r\n    };\r\n    LSFS.prototype.removeEntry=function removeEntry(dinfo, path, name) { // path:path of dinfo\r\n        assert.is(arguments,[Object, String, String]);\r\n        if (dinfo[name]) {\r\n            dinfo[name] = {\r\n                lastUpdate: now(),\r\n                trashed: true\r\n            };\r\n            this.getRootFS().notifyChanged(P.rel(path,name), {eventType:\"trash\"});\r\n            this.putDirInfo(path, dinfo, true);\r\n        }\r\n    };\r\n    LSFS.prototype.removeEntryWithoutTrash=function (dinfo, path, name) { // path:path of dinfo\r\n        assert.is(arguments,[Object, String, String]);\r\n        if (dinfo[name]) {\r\n            delete dinfo[name];\r\n            this.getRootFS().notifyChanged(P.rel(path,name), {eventType:\"delete\"});\r\n            this.putDirInfo(path, dinfo, true);\r\n        }\r\n    };\r\n    LSFS.prototype.isRAM=function (){\r\n        return this.storage!==localStorage;\r\n    };\r\n    LSFS.prototype.fstype=function () {\r\n        return (this.isRAM() ? \"ramDisk\" : \"localStorage\" );\r\n    };\r\n    LSFS.getUsage=function () {\r\n        var using=0;\r\n        for (var i in localStorage) {\r\n            if (typeof localStorage[i]==\"string\"){\r\n                using+=localStorage[i].length;\r\n            }\r\n        }\r\n        return using;\r\n    };\r\n    LSFS.getCapacity=function () {\r\n        var seq=0;\r\n        var str=\"a\";\r\n        var KEY=\"___checkls___\";\r\n        var using=0;\r\n        var lim=Math.pow(2,25);//32MB?\r\n        try {\r\n            // make 1KB str\r\n            for (var i=0; i<10 ;i++) {\r\n                str+=str;\r\n            }\r\n            for (var i in localStorage) {\r\n                if (i.substring(0,KEY.length)==KEY) delete localStorage[i];\r\n                else if (typeof localStorage[i]==\"string\"){\r\n                    using+=localStorage[i].length;\r\n                }\r\n            }\r\n            var ru=using;\r\n            while (add()) {\r\n                if (str.length<lim) {\r\n                    str+=str;\r\n                } else break;\r\n            }\r\n            while(str.length>1024) {\r\n                str=str.substring(str.length/2);\r\n                add();\r\n            }\r\n            return {using:ru, max:using};\r\n        } finally {\r\n            for (var i=0; i<seq; i++) {\r\n                 delete localStorage[KEY+i];\r\n            }\r\n        }\r\n        function add() {\r\n            try {\r\n                localStorage[KEY+seq]=str;\r\n                seq++;\r\n                using+=str.length;\r\n                //console.log(\"Added \"+str.length, str.length, using);\r\n                return true;\r\n            } catch(e) {\r\n                delete localStorage[KEY+seq];\r\n                //console.log(\"Add Fail \"+str.length);\r\n                return false;\r\n            }\r\n        }\r\n    };\r\n\r\n    // public methods (with resolve fs)\r\n    FS.delegateMethods(LSFS.prototype, {\r\n        isReadOnly: function () {return this.options.readOnly;},\r\n        getReturnTypes: function(path, options) {\r\n            assert.is(arguments,[String]);\r\n            return {\r\n                getContent: String, opendir:[String]\r\n            };\r\n        },\r\n        getContent: function(path, options) {\r\n            assert.is(arguments,[Absolute]);\r\n            this.assertExist(path); // Do not use this??( because it does not follow symlinks)\r\n            var c;\r\n            var cs=this.getItem(path);\r\n            if (Content.looksLikeDataURL(cs)) {\r\n                c=Content.url(cs);\r\n            } else {\r\n                c=Content.plainText(cs);\r\n            }\r\n            return c;\r\n        },\r\n        setContent: function(path, content, options) {\r\n            assert.is(arguments,[Absolute,Content]);\r\n            this.assertWriteable(path);\r\n            var t=null;\r\n            if (content.hasPlainText()) {\r\n                t=content.toPlainText();\r\n                if (Content.looksLikeDataURL(t)) t=null;\r\n            }\r\n            if (t!=null) {\r\n                this.setItem(path, t);\r\n            } else {\r\n                this.setItem(path, content.toURL());\r\n            }\r\n            this.touch(path);\r\n        },\r\n        getMetaInfo: function(path, options) {\r\n            this.assertExist(path, {includeTrashed:true});\r\n            assert.is(arguments,[Absolute]);\r\n            if (path==P.SEP) {\r\n                return {};\r\n            }\r\n            var parent=assert(P.up(path));\r\n            if (!this.inMyFS(parent)) {\r\n                return {};\r\n            }\r\n            var name=P.name(path);\r\n            assert.is(parent,P.AbsDir);\r\n            var pinfo=this.getDirInfo(parent);\r\n            return assert(pinfo[name]);\r\n        },\r\n        setMetaInfo: function(path, info, options) {\r\n            assert.is(arguments,[String,Object]);\r\n            this.assertWriteable(path);\r\n            var parent=assert(P.up(path));\r\n            if (!this.inMyFS(parent)) {\r\n                return;\r\n            }\r\n            var pinfo=this.getDirInfo(parent);\r\n            var name=P.name(path);\r\n            pinfo[name]=info;\r\n            this.putDirInfo(parent, pinfo, pinfo[name].trashed);\r\n        },\r\n        mkdir: function(path, options) {\r\n            assert.is(arguments,[Absolute]);\r\n            this.assertWriteable(path);\r\n\t\t\tthis.touch(path);\r\n        },\r\n        opendir: function(path, options) {\r\n            assert.is(arguments,[String]);\r\n            //succ: iterator<string> // next()\r\n            // options: {includeTrashed:Boolean}\r\n            options=options||{};\r\n            var inf=this.getDirInfo(path);\r\n            var res=[]; //this.dirFromFstab(path);\r\n            for (var i in inf) {\r\n                assert(inf[i]);\r\n                if (!inf[i].trashed || options.includeTrashed) res.push(i);\r\n            }\r\n            return assert.is(res,Array);\r\n        },\r\n        rm: function(path, options) {\r\n            assert.is(arguments,[Absolute]);\r\n            options=options||{};\r\n            this.assertWriteable(path);\r\n            var parent=P.up(path);\r\n            if (parent==null || !this.inMyFS(parent)) {\r\n                throw new Error(path+\": cannot remove. It is root of this FS.\");\r\n            }\r\n            this.assertExist(path,{includeTrashed:options.noTrash });\r\n            if (P.isDir(path)) {\r\n                var lis=this.opendir(path);\r\n                if (lis.length>0) {\r\n                    this.err(path,\"Directory not empty\");\r\n                }\r\n                if (options.noTrash) {\r\n                    this.removeItem(path);\r\n                }\r\n            } else {\r\n                this.removeItem(path);\r\n            }\r\n            var pinfo=this.getDirInfo(parent);\r\n            if (options.noTrash) {\r\n                this.removeEntryWithoutTrash(pinfo, parent, P.name(path) );\r\n            } else {\r\n                this.removeEntry(pinfo, parent, P.name(path) );\r\n            }\r\n        },\r\n        exists: function (path,options) {\r\n            assert.is(arguments,[Absolute]);\r\n            options=options||{};\r\n            var name=P.name(path);\r\n            var parent=P.up(path);\r\n            if (parent==null || !this.inMyFS(parent)) return true;\r\n            var pinfo=this.getDirInfo(parent);\r\n            var res=pinfo[name];\r\n            if (res && res.trashed && this.itemExists(path)) {\r\n                if (this.isDir(path)) {\r\n\r\n                } else {\r\n                    //assert.fail(\"Inconsistent \"+path+\": trashed, but remains in storage\");\r\n                }\r\n            }\r\n            if (!res && this.itemExists(path)) {\r\n                //assert.fail(\"Inconsistent \"+path+\": not exists in metadata, but remains in storage\");\r\n            }\r\n            if (res && !res.trashed && !res.link && !this.itemExists(path)) {\r\n                //assert.fail(\"Inconsistent \"+path+\": exists in metadata, but not in storage\");\r\n            }\r\n            if (res && !options.includeTrashed) {\r\n                res=!res.trashed;\r\n            }\r\n            return !!res;\r\n        },\r\n        link: function(path, to, options) {\r\n            assert.is(arguments,[P.Absolute,P.Absolute]);\r\n            this.assertWriteable(path);\r\n            if (this.exists(path)) this.err(path,\"file exists\");\r\n            if (P.isDir(path) && !P.isDir(to)) {\r\n                this.err(path,\" can not link to file \"+to);\r\n            }\r\n            if (!P.isDir(path) && P.isDir(to)) {\r\n                this.err(path,\" can not link to directory \"+to);\r\n            }\r\n            var m={};//assert(this.getMetaInfo(path));\r\n            m.link=to;\r\n            m.lastUpdate=now();\r\n            this.setMetaInfo(path, m);\r\n            //console.log(this.getMetaInfo(path));\r\n            //console.log(this.storage);\r\n            //console.log(this.getMetaInfo(P.up(path)));\r\n            assert(this.exists(path));\r\n            assert(this.isLink(path));\r\n        },\r\n        isLink: function (path) {\r\n            assert.is(arguments,[P.Absolute]);\r\n            if (!this.exists(path)) return null;\r\n            var m=assert(this.getMetaInfo(path));\r\n            return m.link;\r\n        },\r\n        touch: function (path) {\r\n            assert.is(arguments,[Absolute]);\r\n            this.assertWriteable(path);\r\n            if (!this.itemExists(path)) {\r\n                if (P.isDir(path)) {\r\n                    if (this.dirCache) this.dirCache[path]={};\r\n                    this.setItem(path,\"{}\");\r\n                } else {\r\n                    this.setItem(path,\"\");\r\n                }\r\n            }\r\n            var parent=up(path);\r\n            if (parent!=null) {\r\n                if (this.inMyFS(parent)) {\r\n                    var pinfo=this.getDirInfo(parent);\r\n                    this._touch(pinfo, parent , P.name(path), false);\r\n                } else {\r\n                    assert(this.getRootFS()!==this);\r\n                    this.getRootFS().resolveFS(parent).touch(parent);\r\n                }\r\n            }\r\n        },\r\n        getURL: function (path) {\r\n            return this.getContent(path).toURL();\r\n        },\r\n        opendirEx: function (path,options) {\r\n            assert.is(path,P.AbsDir);\r\n            options=options||{};\r\n            var res={};\r\n            var d=this.getDirInfo(path);\r\n            if (options.includeTrashed) {\r\n                //console.log(\"INCLTR\",d);\r\n                return d;\r\n            }\r\n            for (var k in d) {\r\n                if (d[k].trashed) continue;\r\n                res[k]=d[k];\r\n            }\r\n            return res;\r\n        }\r\n    });\r\n    return LSFS;\r\n\r\n});\r\n\r\n/**\r\n *\r\n * jquery.binarytransport.js\r\n *\r\n * @description. jQuery ajax transport for making binary data type requests.\r\n * @version 1.0\r\n * @author Henry Algus <henryalgus@gmail.com>\r\n *\r\n */\r\n\r\n// use this transport for \"binary\" data type\r\nif (typeof $!==\"undefined\")\r\n$.ajaxTransport(\"+binary\", function(options, originalOptions, jqXHR){\r\n    // check for conditions and support for blob / arraybuffer response type\r\n    if (window.FormData && ((options.dataType && (options.dataType == 'binary')) || (options.data && ((window.ArrayBuffer && options.data instanceof ArrayBuffer) || (window.Blob && options.data instanceof Blob)))))\r\n    {\r\n        return {\r\n            // create new XMLHttpRequest\r\n            send: function(headers, callback){\r\n                // setup all variables\r\n                var xhr = new XMLHttpRequest(),\r\n                url = options.url,\r\n                type = options.type,\r\n                async = options.async || true,\r\n                // blob or arraybuffer. Default is blob\r\n                dataType = options.responseType || \"blob\",\r\n                data = options.data || null,\r\n                username = options.username || null,\r\n                password = options.password || null;\r\n\r\n                xhr.addEventListener('load', function(){\r\n                    var data = {};\r\n                    data[options.dataType] = xhr.response;\r\n                    // make callback and send data\r\n                    callback(xhr.status, xhr.statusText, data, xhr.getAllResponseHeaders());\r\n                });\r\n\r\n                xhr.open(type, url, async, username, password);\r\n\r\n                // setup custom headers\r\n                for (var i in headers ) {\r\n                    xhr.setRequestHeader(i, headers[i] );\r\n                }\r\n\r\n                xhr.responseType = dataType;\r\n                xhr.send(data);\r\n            },\r\n            abort: function(){\r\n                jqXHR.abort();\r\n            }\r\n        };\r\n    }\r\n});\r\n\r\ndefine(\"jquery.binarytransport\", function(){});\r\n\r\ndefine('WebFS',[\"FSClass\",\"jquery.binarytransport\",\"DeferredUtil\",\"Content\",\"PathUtil\"],\r\n        function (FS,j,DU,Content,P) {\r\n    // FS.mount(location.protocol+\"//\"+location.host+\"/\", \"web\");\r\n    var WebFS=function (){};\r\n    var p=WebFS.prototype=new FS();\r\n    FS.addFSType(\"web\", function () {\r\n        return new WebFS();\r\n    });\r\n    p.fstype=function () {return \"Web\";};\r\n    p.supportsSync=function () {return false;};\r\n    p.inMyFS=function (path) {\r\n        return P.isURL(path);\r\n    };\r\n    FS.delegateMethods(p, {\r\n        exists: function () {return true;},\r\n        getContentAsync: function (path){\r\n            var t=this;\r\n            return DU.promise(function (succ,err) {\r\n                $.get(path,function (blob) {\r\n                    var reader = new FileReader();\r\n                    reader.addEventListener(\"loadend\", function() {\r\n                        succ(Content.bin(reader.result, t.getContentType(path)));\r\n                    });\r\n                    reader.readAsArrayBuffer(blob);\r\n                },\"binary\").fail(err);\r\n            });\r\n        },\r\n        /*setContentAsync: function (path){\r\n\r\n        },*/\r\n        getURL: function (path) {\r\n            return path;\r\n        }\r\n    });\r\n\r\n    return WebFS;\r\n\r\n});\r\n\r\ndefine('Env',[\"assert\",\"PathUtil\"],function (A,P) {\r\n    var Env=function (value) {\r\n        this.value=value;\r\n    };\r\n    Env.prototype={\r\n            expand:function (str) {\r\n                A.is(str,String);\r\n                var t=this;\r\n                return str.replace(/\\$\\{([a-zA-Z0-9_]+)\\}/g, function (a,key) {\r\n                    return t.get(key);\r\n                });\r\n            },\r\n            expandPath:function (path) {\r\n                A.is(path,String);\r\n                path=this.expand(path);\r\n                path=path.replace(/\\/+/g,\"/\");\r\n                path=path.replace(/^[a-z][a-z]+:\\//, function (r) { return r+\"/\"; } );\r\n                return A.is(path,P.Path);\r\n            },\r\n            get: function (key) {\r\n                return this.value[key];\r\n            },\r\n            set: function (key, value) {\r\n                this.value[key]=value;\r\n            }\r\n    };\r\n    return Env;\r\n});\r\ndefine('SFile',[\"extend\",\"assert\",\"PathUtil\",\"Util\",\"Content\",\"FSClass\",\"FileSaver\",\"DeferredUtil\"],\r\nfunction (extend,A,P,Util,Content,FSClass,saveAs,DU) {\r\n\r\nvar SFile=function (rootFS, path) {\r\n    A.is(path, P.Absolute);\r\n    this._path=path;\r\n    this.rootFS=rootFS;\r\n    this.fs=rootFS.resolveFS(path);\r\n    if (this.isDir() && !P.isDir(path)) {\r\n        this._path+=P.SEP;\r\n    }\r\n};\r\nSFile.is=function (path) {\r\n    return path && typeof (path.isSFile)==\"function\" && path.isSFile();\r\n};\r\n/*function getPath(f) {\r\n    if (SFile.is(f)) {\r\n        return f.path();\r\n    } else {\r\n        A.is(f,P.Absolute);\r\n        return f;\r\n    }\r\n}*/\r\nSFile.prototype={\r\n    isSFile: function (){return true;},\r\n    setPolicy: function (p) {\r\n        if (this.policy) throw new Error(\"policy already set\");\r\n        this.policy=p;\r\n        return this._clone();\r\n    },\r\n    getPolicy: function (/*p*/) {\r\n        return this.policy;\r\n    },\r\n    _clone: function (){\r\n        return this._resolve(this.path());\r\n    },\r\n    _resolve: function (path, options) {\r\n        var res;\r\n        options=options||{};\r\n        if (SFile.is(path)) {\r\n            res=path;\r\n        } else {\r\n            A.is(path,P.Absolute);\r\n            var topdir;\r\n            var policy=options.policy || this.policy;\r\n            if (policy && (topdir=policy.topDir)) {\r\n                if (topdir.path) topdir=topdir.path();\r\n                if (!P.startsWith(path, topdir)) {\r\n                    throw new Error(path+\": cannot access. Restricted to \"+topdir);\r\n                }\r\n            }\r\n            res=new SFile(this.rootFS, path);\r\n            res.policy=policy;\r\n        }\r\n        if (res.policy) {\r\n            return Util.privatize(res);\r\n        } else {\r\n            return res;\r\n        }\r\n    },\r\n    contains: function (file) {\r\n        A(SFile.is(file),file+\" shoud be a SFile object.\");\r\n        if (!this.isDir()) return false;\r\n        return P.startsWith( file.path(), this.path());\r\n    },\r\n    path: function () {\r\n        return this._path;\r\n    },\r\n    name: function () {\r\n        return P.name(this.path());\r\n    },\r\n    truncExt: function (ext) {\r\n        return P.truncExt(this.path(),ext);\r\n    },\r\n    ext: function () {\r\n        return P.ext(this.path());\r\n    },\r\n    relPath: function (base) {\r\n        // base should be SFile or Path from rootFS\r\n        var bp=(base.path ?\r\n                base.path() :\r\n                base );\r\n        return P.relPath(this.path(), A.is(bp,P.Absolute) );\r\n    },\r\n    up: function () {\r\n        var pathR=this.path();\r\n        var pa=P.up(pathR);\r\n        if (pa==null) return null;\r\n        return this._resolve(pa);\r\n    },\r\n    rel: function (relPath) {\r\n        A.is(relPath, P.Relative);\r\n        this.assertDir();\r\n        var pathR=this.path();\r\n        return this._resolve(P.rel(pathR, relPath));\r\n    },\r\n    sibling: function (n) {\r\n        return this.up().rel(n);\r\n    },\r\n    startsWith: function (pre) {\r\n        return P.startsWith(this.name(),pre);\r\n    },\r\n    endsWith: function (post) {\r\n        return P.endsWith(this.name(),post);\r\n    },\r\n    equals:function (o) {\r\n        return (o && typeof o.path==\"function\" && o.path()==this.path());\r\n    },\r\n    toString:function (){\r\n        return this.path();\r\n    },\r\n    //Common\r\n    touch: function () {\r\n        return this.act.fs.touch(this.act.path);\r\n    },\r\n    isReadOnly: function () {\r\n        return this.act.fs.isReadOnly(this.act.path);\r\n    },\r\n    isTrashed:function () {\r\n        var m=this.metaInfo();\r\n        if (!m) return false;\r\n        return m.trashed;\r\n    },\r\n    metaInfo: function () {\r\n        if (arguments.length==0) {\r\n            return this.getMetaInfo.apply(this,arguments);\r\n        } else {\r\n            return this.setMetaInfo.apply(this,arguments);\r\n        }\r\n    },\r\n    getMetaInfo: function (options) {\r\n        return this.act.fs.getMetaInfo(this.act.path,options);\r\n    },\r\n    setMetaInfo: function (info, options) {\r\n        return this.act.fs.setMetaInfo(this.act.path,info, options);\r\n    },\r\n    getDirTree: function (options) {\r\n        return this.act.fs.getDirTree(this.act.path, options);\r\n    },\r\n    assertExists: function () {\r\n        A(this.exists(),this.path()+\" does not exist.\");\r\n    },\r\n    lastUpdate:function () {\r\n        this.assertExists();\r\n        return this.metaInfo().lastUpdate;\r\n    },\r\n    exists: function (options) {\r\n        var args=Array.prototype.slice.call(arguments);\r\n        if (typeof args[0]===\"function\") {\r\n            var f=args.shift();\r\n            return DU.resolve(this.exists.apply(this,args)).then(f);\r\n        }\r\n        options=options||{};\r\n        var p=this.fs.exists(this.path(),options);\r\n        if (p || options.noFollowLink) {\r\n            return p;\r\n        } else {\r\n            return this.act.fs.exists(this.act.path,{noFollowLink:true});\r\n        }\r\n    },\r\n    rm: function (options) {\r\n        //   ln /test/c /a/b/\r\n        //   rm a/b/c/\r\n        //   rm a/b/c/d\r\n        var t=this;\r\n        options=options||{};\r\n        if (this.isLink()) {\r\n            return DU.resolve(this.fs.rm(this.path(),options));\r\n        }\r\n        /*if (!this.exists({noFollowLink:true})) {\r\n            return this.act.fs.rm(this.act.path, options);\r\n        }*/\r\n        var a;\r\n        if (this.isDir() && (options.recursive||options.r)) {\r\n            a=this.each(function (f) {\r\n                return f.rm(options);\r\n            });\r\n        } else {\r\n            a=DU.resolve();\r\n        }\r\n        return a.then(function () {\r\n            return t.act.fs.rm(t.act.path, options);\r\n        });\r\n        //var pathT=this.path();\r\n        //this.fs.rm(pathT, options);\r\n    },\r\n    removeWithoutTrash: function (options) {\r\n        options=options||{};\r\n        options.noTrash=true;\r\n        this.rm(options);\r\n    },\r\n    isDir: function () {\r\n        return this.act.fs.isDir(this.act.path);\r\n    },\r\n    // File\r\n    text:function (f) {\r\n    \tif (typeof f===\"function\") {\r\n\t\t\treturn this.getText(f);\r\n\t\t}\r\n        if (arguments.length>0) {\r\n            return this.setText(arguments[0]);\r\n        } else {\r\n            return this.getText();\r\n        }\r\n    },\r\n    setText:function (t) {\r\n        A.is(t,String);\r\n        if (this.isDir()) {\r\n            throw new Error(\"Cannot write to directory: \"+this.path());\r\n        }\r\n        var ct=this.contentType({def:null});\r\n        //if (this.isText()) {\r\n        if (ct!==null && !ct.match(/^text/) && Content.looksLikeDataURL(t)) {\r\n            // bad knowhow: if this is a binary file apparently, convert to URL\r\n            return DU.throwNowIfRejected(this.setContent(Content.url(t)));\r\n            //return DU.resolve(this.act.fs.setContent(this.act.path, Content.url(t)));\r\n        } else {\r\n            // if use fs.setContentAsync, the error should be handled by .fail\r\n            // setText should throw error immediately (Why? maybe old style of text(\"foo\") did it so...)\r\n            return DU.throwNowIfRejected(this.setContent(Content.plainText(t)));\r\n            //return DU.resolve(this.act.fs.setContent(this.act.path, Content.plainText(t)));\r\n        }\r\n    },\r\n    appendText:function (t) {\r\n        A.is(t,String);\r\n        //if (this.isText()) {\r\n        return this.act.fs.appendContent(this.act.path, Content.plainText(t));\r\n        /*} else {\r\n            throw new Error(\"append only for text file\");\r\n        }*/\r\n    },\r\n    getContent: function (f) {\r\n        if (typeof f==\"function\") {\r\n            return this.act.fs.getContentAsync(this.act.path).then(f);\r\n        }\r\n        return this.act.fs.getContent(this.act.path);\r\n    },\r\n    setContent: function (c) {\r\n        if (this.isDir()) {\r\n            throw new Error(\"Cannot write to directory: \"+this.path());\r\n        }\r\n        // why setContentAsync? AsyncでもDU.resolveはsyncをサポートしていればsyncでやってくれる...はず，Promiseだと遅延するからだめ．今までJQばっかりだったから問題が起きていなかった．\r\n        // なので，fs2/promise.jsを追加．\r\n        return this.act.fs.setContentAsync(this.act.path,c);\r\n    },\r\n\r\n    getText:function (f) {\r\n    \tif (typeof f===\"function\") {\r\n    \t\t//var t=this;\r\n    \t    return this.getContent(forceText).then(f);\r\n    \t}\r\n        return forceText(this.act.fs.getContent(this.act.path));\r\n        function forceText(c) {\r\n\t    \t//if (t.isText()) {\r\n            try {\r\n                return c.toPlainText();\r\n            } catch(e) {\r\n    \t    \treturn c.toURL();\r\n    \t    }\r\n        }\r\n    },\r\n    getDataURL: function (f) {\r\n        if (typeof f===\"function\") {\r\n            return this.getContent(function (c) {\r\n                return c.toURL();\r\n            });\r\n        }\r\n        return this.getContent().toURL();\r\n    },\r\n    setDataURL: function (u) {\r\n        return this.setContent(Content.url(u));\r\n    },\r\n    dataURL:function (d) {\r\n        if (typeof d===\"string\") return this.setDataURL(d);\r\n        if (typeof d===\"function\") return this.getDataURL(d);\r\n        return this.getDataURL();\r\n    },\r\n    isText: function () {\r\n        return this.act.fs.isText(this.act.path);\r\n    },\r\n    contentType: function (options) {\r\n        return this.act.fs.getContentType(this.act.path,options);\r\n    },\r\n    bytes: function (b) {\r\n        if (Content.isBuffer(b)) return this.setBytes(b);\r\n        return this.getBytes();\r\n    },\r\n    setBytes:function (b) {\r\n        return this.act.fs.setContent(this.act.path, Content.bin(b,this.contentType()));\r\n    },\r\n    getBytes:function (options) {\r\n        options=options||{};\r\n        return this.act.fs.getContent(this.act.path).toBin(options.binType);\r\n    },\r\n    getURL: function () {\r\n        return this.act.fs.getURL(this.act.path);\r\n    },\r\n    lines:function (lines) {\r\n        if (lines instanceof Array) {//WRITE\r\n            return this.text(lines.join(\"\\n\"));\r\n        } else if (typeof lines===\"function\") {//READ async\r\n            return this.text(function (r) {\r\n                return lines(r.replace(/\\r/g,\"\").split(\"\\n\"));\r\n            });\r\n        }\r\n        return this.text().replace(/\\r/g,\"\").split(\"\\n\");\r\n    },\r\n    obj: function () {\r\n        var file=this;\r\n        if (arguments.length==0) {\r\n            var t=file.text();\r\n            if (!t) return null;\r\n            return JSON.parse(t);\r\n        } else {\r\n            file.text(JSON.stringify(A.is(arguments[0],Object) ));\r\n        }\r\n    },\r\n    copyFrom: function (src, options) {\r\n        return src.copyTo(this,options);\r\n    },\r\n    copyTo: function (dst, options) {\r\n        A(dst && dst.isSFile(),dst+\" is not a file\");\r\n        var src=this;\r\n        options=options||{};\r\n        var srcIsDir=src.isDir();\r\n        var dstIsDir=dst.isDir();\r\n        if (!srcIsDir && dstIsDir) {\r\n            dst=dst.rel(src.name());\r\n            A(!dst.isDir(), dst+\" is a directory.\");\r\n            dstIsDir=false;\r\n        }\r\n        if (srcIsDir && !dstIsDir) {\r\n           this.err(\"Cannot move dir \"+src.path()+\" to file \"+dst.path());\r\n        } else if (!srcIsDir && !dstIsDir) {\r\n            if (options.echo) options.echo(src+\" -> \"+dst);\r\n            var res=this.act.fs.cp(this.act.path, dst.getResolvedLinkPath(),options);\r\n            res=DU.resolve(res);\r\n            if (options.a) {\r\n                return res.then(function () {\r\n                    return dst.setMetaInfo(src.getMetaInfo());\r\n                });\r\n            }\r\n            return res;\r\n        } else {\r\n            A(srcIsDir && dstIsDir,\"Both src and dst should be dir\");\r\n            return src.each(function (s) {\r\n                var r;\r\n                var dstf=dst.rel(s.name());\r\n                if (options.progress) {\r\n                    r=options.progress(dstf,{src:s,dst:dstf});\r\n                }\r\n                return DU.resolve(r).then(function () {\r\n                    return dstf.copyFrom(s, options);\r\n                });\r\n            },options);\r\n        }\r\n        //file.text(src.text());\r\n        //if (options.a) file.metaInfo(src.metaInfo());\r\n    },\r\n    moveFrom: function (src, options) {\r\n        var t=this;\r\n        return t.exists(function (ex) {\r\n            return t.copyFrom(src,options).then(function () {\r\n                return src.rm({recursive:true});\r\n            },function (e) {\r\n                // rollback\r\n                if (!ex) return t.exists(function (ex) {\r\n                    if (ex) return t.rm({recursive:true});\r\n                }).then(function () {throw e;});\r\n                throw e;\r\n            });\r\n        });\r\n    },\r\n    moveTo: function (dst, options) {\r\n        return dst.moveFrom(this,options);\r\n    },\r\n    // Dir\r\n    assertDir:function () {\r\n        A.is(this.path(),P.Dir);\r\n        return this;\r\n    },\r\n    each:function (f,options) {\r\n        var dir=this.assertDir();\r\n        return dir.listFilesAsync(options).then(function (ls) {\r\n            return DU.each(ls,f);// ls.forEach(f)\r\n        });\r\n    },\r\n    eachrev:function (f,options) {\r\n        var dir=this.assertDir();\r\n        return dir.listFilesAsync(options).then(function (ls) {\r\n            return DU.each(ls.reverse(),f);// ls.forEach(f)\r\n        });\r\n    },\r\n    recursive:function (fun,options) {\r\n        var dir=this.assertDir();\r\n        options=dir.convertOptions(options);\r\n        return dir.each(function (f) {\r\n            if (f.isDir()) return f.recursive(fun,options);\r\n            else return fun(f);\r\n        },options);\r\n    },\r\n    _listFiles:function (options,async) {\r\n        A(options==null || typeof options==\"object\");\r\n        var dir=this.assertDir();\r\n        //var path=this.path();\r\n        var ord;\r\n        options=dir.convertOptions(options);\r\n        if (!ord) ord=options.order;\r\n        if (async) {\r\n            return this.act.fs.opendirAsync(this.act.path, options).\r\n            then(cvt);\r\n        } else {\r\n            return cvt( this.act.fs.opendir(this.act.path, options));\r\n        }\r\n        function cvt(di) {\r\n            var res=[];\r\n            for (var i=0;i<di.length; i++) {\r\n                var name=di[i];\r\n                //if (!options.includeTrashed && dinfo[i].trashed) continue;\r\n                var f=dir.rel(name);\r\n                if (options.excludesF(f) ) continue;\r\n                res.push(f);\r\n            }\r\n            if (typeof ord==\"function\" && res.sort) res.sort(ord);\r\n            return res;\r\n        }\r\n    },\r\n    listFilesAsync:function (options) {\r\n        return this._listFiles(options,true);\r\n    },\r\n    listFiles:function (options) {\r\n        return this._listFiles(options,false);\r\n    },\r\n    ls:function (options) {\r\n        A(options==null || typeof options==\"object\");\r\n        var dir=this.assertDir();\r\n        if (!options) {\r\n            return this.act.fs.opendir(this.act.path, options);\r\n        }\r\n        var res=dir.listFiles(options);\r\n        return res.map(function (f) {\r\n            return f.name();\r\n        });\r\n    },\r\n    convertOptions:function(o) {\r\n        var options=Util.extend({},o);\r\n        /*var dir=*/this.assertDir();\r\n        var pathR=this.path();\r\n        var excludes=options.excludes || {};\r\n        if (typeof excludes===\"function\") {\r\n            options.excludesF=excludes;\r\n        } else if (typeof excludes===\"object\") {\r\n            if (excludes instanceof Array) {\r\n                var nex={};\r\n                excludes.forEach(function (e) {\r\n                    if (P.startsWith(e,\"/\")) {\r\n                        nex[e]=1;\r\n                    } else {\r\n                        nex[pathR+e]=1;\r\n                    }\r\n                });\r\n                excludes=nex;\r\n            }\r\n            options.excludesF=function (f) {\r\n                return excludes[f.path()];\r\n            };\r\n        }\r\n        return A.is(options,{excludesF:Function});\r\n    },\r\n    mkdir: function () {\r\n        return this.touch();\r\n    },\r\n    link: function (to,options) {// % ln to path\r\n        if (this.exists()) throw new Error(this.path()+\": exists.\");\r\n        return this.act.fs.link(this.act.path,to.path(),options);\r\n    },\r\n    resolveLink:function () {\r\n        return this._resolve(this.act.path);\r\n    },\r\n    isLink: function () {\r\n        return this.fs.isLink(this.path());\r\n    },\r\n    getResolvedLinkPath: function () {\r\n        return this.act.path;\r\n    },\r\n    getFS:function () {\r\n        return this.act.fs;\r\n    },\r\n    observe: function (h) {\r\n        return this.getFS().getRootFS().addObserver(this.path(),h);\r\n    },\r\n    getBlob: function () {\r\n        return new Blob([this.bytes()],{type:this.contentType()});\r\n    },\r\n    setBlob: function (blob) {\r\n        var t=this;\r\n        return DU.promise(function (succ/*,err*/) {\r\n            var reader = new FileReader();\r\n            reader.addEventListener(\"loadend\", function() {\r\n                // reader.result contains the contents of blob as a typed array\r\n                DU.resolve(t.setBytes(reader.result)).then(succ);\r\n            });\r\n            reader.readAsArrayBuffer(blob);\r\n        });\r\n    },\r\n    size: function (f) {\r\n        if (!f) {\r\n            if (!this.isDir()) {\r\n                return this.act.fs.size(this.act.path);\r\n                //return this.getBytes().byteLength;\r\n            } else {\r\n                var sum=0;\r\n                this.each(function (f) {\r\n                    sum+=f.size();\r\n                });\r\n                return sum;\r\n            }\r\n        } else {\r\n            //TODO: async\r\n        }\r\n    },\r\n    download: function () {\r\n        if (this.isDir()) throw new Error(this+\": Download dir is not support yet. Use 'zip' instead.\");\r\n        saveAs(this.getBlob(),this.name());\r\n    },\r\n    err: function () {\r\n        var a=Array.prototype.slice.call(arguments);\r\n        console.log.apply(console,a);\r\n        throw new Error(a.join(\"\"));\r\n    },\r\n    exportAsObject: function (options) {\r\n        var base=this;\r\n        var data={};\r\n        this.recursive(function (f) {\r\n            data[f.relPath(base)]=f.text();\r\n        },options);\r\n        var req={base:base.path(),data:data};\r\n        return req;\r\n    },\r\n    importFromObject: function (data/*, options*/) {\r\n        if (typeof data===\"string\") data=JSON.parse(data);\r\n        data=data.data;\r\n        for (var k in data) {\r\n            this.rel(k).text(data[k]);\r\n        }\r\n    },\r\n    watch: function (_1,_2) {\r\n        var options={},handler=function(){};\r\n        if (typeof _1===\"object\") options=_1;\r\n        if (typeof _2===\"object\") options=_2;\r\n        if (typeof _1===\"function\") handler=_1;\r\n        if (typeof _2===\"function\") handler=_2;\r\n        var rfs=this.getFS().getRootFS();\r\n        //var t=this;\r\n        rfs.addObserver(this.path(),function (path, meta) {\r\n            handler(meta.eventType, rfs.get(path),meta );\r\n        });\r\n    },\r\n    convertResult:function (valueOrPromise) {\r\n        if (this.syncMode===true) return forceSync(valueOrPromise);\r\n        if (this.syncMode===false) return DU.resolve(valueOrPromise);\r\n        return valueOrPromise;\r\n    }\r\n};\r\nfunction forceSync(promise) {\r\n    var state;\r\n    var err,res;\r\n    var np=DU.resolve(promise).then(function (r) {\r\n        if (!state) {\r\n            state=\"resolved\";\r\n            res=r;\r\n        }\r\n        return r;\r\n    },function (e) {\r\n        if (!state) {\r\n            state=\"rejected\";\r\n            err=e;\r\n        }\r\n        throw e;\r\n    });\r\n    if (!state) return np;\r\n    if (state===\"rejected\") throw err;\r\n    return res;\r\n}\r\nObject.defineProperty(SFile.prototype,\"act\",{\r\n    get: function () {\r\n        if (this._act) return this._act;\r\n        this._act={};// path/fs after follwed symlink\r\n        this._act.path=this.fs.resolveLink(this._path);\r\n        this._act.fs=this.rootFS.resolveFS(this._act.path);\r\n        A.is(this._act, {fs:FSClass, path:P.Absolute});\r\n        return this._act;\r\n    }\r\n});\r\n\r\nreturn SFile;\r\n});\r\n\r\ndefine('RootFS',[\"assert\",\"FSClass\",\"PathUtil\",\"SFile\"], function (assert,FS,P,SFile) {\r\n    var RootFS=function (defaultFS){\r\n        assert.is(defaultFS,FS);\r\n        this.mount(null, defaultFS);\r\n    };\r\n    var dst=RootFS.prototype;\r\n    var p={\r\n            err: function (path, mesg) {\r\n                throw new Error(path+\": \"+mesg);\r\n            },\r\n            // mounting\r\n            fstab: function () {\r\n                return this._fstab=this._fstab||[];//[{fs:this, path:P.SEP}];\r\n            },\r\n            unmount: function (path, options) {\r\n                assert.is(arguments,[P.AbsDir] );\r\n                var t=this.fstab();\r\n                console.log(t);\r\n                for (var i=0; i<t.length; i++) {\r\n                    if (t[i].mountPoint==path) {\r\n                        t.splice(i,1);\r\n                        return true;\r\n                    }\r\n                }\r\n                return false;\r\n            },\r\n            availFSTypes:function (){\r\n                return FS.availFSTypes();\r\n            },\r\n            mount: function (path, fs, options) {\r\n                if (typeof fs==\"string\") {\r\n                    var fact=assert( FS.availFSTypes()[fs] ,\"fstype \"+fs+\" is undefined.\");\r\n                    fs=fact(path, options||{});\r\n                }\r\n                assert.is(fs,FS);\r\n                fs.mounted(this, path);\r\n                this.fstab().unshift(fs);\r\n            },\r\n            resolveFS:function (path, options) {\r\n                assert.is(path,P.Absolute);\r\n                var res;\r\n                this.fstab().forEach(function (fs) {\r\n                    if (res) return;\r\n                    if (fs.inMyFS(path)) {\r\n                        res=fs;\r\n                    }\r\n                });\r\n                if (!res) this.err(path,\"Cannot resolve\");\r\n                return assert.is(res,FS);\r\n            },\r\n            get: function (path) {\r\n                assert.is(path,P.Absolute);\r\n                return new SFile(this.resolveFS(path), path);\r\n            },\r\n            addObserver: function (_1,_2,_3) {\r\n                this.observers=this.observers||[];\r\n                var options={},path,f;\r\n                if (typeof _1===\"string\") path=_1;\r\n                if (typeof _2===\"string\") path=_2;\r\n                if (typeof _3===\"string\") path=_3;\r\n                if (typeof _1===\"object\") options=_1;\r\n                if (typeof _2===\"object\") options=_2;\r\n                if (typeof _3===\"object\") options=_3;\r\n                if (typeof _1===\"function\") f=_1;\r\n                if (typeof _2===\"function\") f=_2;\r\n                if (typeof _3===\"function\") f=_3;\r\n                assert.is(path,String);\r\n                assert.is(f,Function);\r\n                var fs=this.resolveFS(path);\r\n                var remover=fs.onAddObserver(path,options);\r\n                var observers=this.observers;\r\n                var observer={\r\n                    path:path,\r\n                    handler:f,\r\n                    remove: function () {\r\n                        var i=observers.indexOf(this);\r\n                        observers.splice(i,1);\r\n                        if (remover) remover.remove();\r\n                    }\r\n                };\r\n                this.observers.push(observer);\r\n                return observer;\r\n            },\r\n            notifyChanged: function (path,metaInfo) {\r\n                if (!this.observers) return;\r\n                this.observers.forEach(function (ob) {\r\n                    if (P.isChildOf(path,ob.path)) {\r\n                        ob.handler(path,metaInfo);\r\n                    }\r\n                });\r\n            },\r\n            getRootFS:function () {\r\n                return this;\r\n            }\r\n    };\r\n    for (var i in p) {\r\n        dst[i]=p[i];\r\n    }\r\n    return RootFS;\r\n});\r\n\r\ndefine('zip',[\"SFile\",/*\"jszip\",*/\"FileSaver\",\"Util\",\"DeferredUtil\"],\r\nfunction (SFile,/*JSZip,*/fsv,Util,DU) {\r\n    var zip={};\r\n    zip.setJSZip=function (JSZip) {\r\n        zip.JSZip=JSZip;\r\n        if (!DU.external.Promise) {\r\n            DU.external.Promise=JSZip.external.Promise;\r\n        }\r\n    };\r\n    if (typeof JSZip!==\"undefined\") zip.setJSZip(JSZip);\r\n    zip.zip=function (dir,dstZip,options) {\r\n        if (!SFile.is(dstZip)) options=dstZip;\r\n        options=options||{};\r\n        var jszip = new zip.JSZip();\r\n        function loop(dst, dir) {\r\n            return dir.each(function (f) {\r\n                var r=DU.resolve();\r\n                if (options.progress) {\r\n                    r=options.progress(f);\r\n                }\r\n                return r.then(function () {\r\n                    if (f.isDir()) {\r\n                        var sf=dst.folder(f.name().replace(/[\\/\\\\]$/,\"\"));\r\n                        return loop(sf, f);\r\n                    } else {\r\n                        return f.getContent(function (c) {\r\n                            dst.file(f.name(),c.toArrayBuffer());\r\n                        });\r\n                    }\r\n                });\r\n            },options);\r\n        }\r\n        return loop(jszip, dir).then(function () {\r\n            return DU.resolve(jszip.generateAsync({\r\n                type:\"arraybuffer\",\r\n                compression:\"DEFLATE\"\r\n            }));\r\n        }).then(function (content) {\r\n            //console.log(\"zip.con\",content);\r\n            if (SFile.is(dstZip)) {\r\n                return dstZip.setBytes(content);\r\n            } else {\r\n                saveAs(\r\n                    new Blob([content],{type:\"application/zip\"}),\r\n                    dir.name().replace(/[\\/\\\\]$/,\"\")+\".zip\"\r\n                );\r\n            }\r\n        });\r\n    };\r\n    zip.unzip=function (arrayBuf,destDir,options) {\r\n        var c;\r\n        var status={};\r\n        options=options||{};\r\n        if (SFile.is(arrayBuf)) {\r\n        \tc=arrayBuf.getContent();\r\n        \tarrayBuf=c.toArrayBuffer();\r\n        }\r\n        if (!options.onCheckFile) {\r\n            options.onCheckFile=function (f) {\r\n                if (options.overwrite) {\r\n                    return f;\r\n                } else {\r\n                    if (f.exists()) {\r\n                        return false;\r\n                    }\r\n                    return f;\r\n                }\r\n            };\r\n        }\r\n        var jszip=new zip.JSZip();\r\n        return DU.resolve(jszip.loadAsync(arrayBuf)).then(function () {\r\n            return DU.each(jszip.files,function (key,zipEntry) {\r\n                //var zipEntry=jszip.files[i];\r\n                var buf,dest;\r\n                return DU.resolve(zipEntry.async(\"arraybuffer\")).then(function (_buf) {\r\n                    buf=_buf;\r\n                    dest=destDir.rel(zipEntry.name);\r\n                    if (options.progress) {\r\n                        return DU.resolve(options.progress(dest));\r\n                    }\r\n                }).then(function () {\r\n                    console.log(\"Inflating\",zipEntry.name);\r\n                    if (dest.isDir()) return;\r\n                    var s={\r\n                        file:dest,\r\n                        status:\"uploaded\"\r\n                    };\r\n                    status[dest.path()]=s;\r\n                    var c=FS.Content.bin( buf, dest.contentType() );\r\n                    var res=options.onCheckFile(dest,c);\r\n                    if (res===false) {\r\n                        s.status=\"cancelled\";\r\n                        dest=null;\r\n                    }\r\n                    if (SFile.is(res)) {\r\n                        if (dest.path()!==res.path()) s.redirectedTo=res;\r\n                        dest=res;\r\n                    }\r\n                    if (dest) return dest.setContent(c);\r\n                });\r\n            });\r\n        }).then(function () {\r\n            console.log(\"unzip done\",status);\r\n            return status;\r\n        });\r\n    };\r\n    return zip;\r\n});\r\n\r\n/*(function (global, factory) {\r\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? factory() :\r\n\ttypeof define === 'function' && define.amd ? define(factory) :\r\n\t(factory());\r\n}(this, (function () { 'use strict';*/\r\n// modified from https://github.com/taylorhakes/promise-polyfill/blob/master/dist/polyfill.js\r\n// if promise resolved immediately, it will run f of then(f)\r\n// P.resolve(5).then(e=>console.log(e)); console.log(3)  ->  show 5 3, while original is 3 5\r\ndefine('promise',[], function() {\r\n\r\n/**\r\n * @this {Promise}\r\n */\r\nfunction finallyConstructor(callback) {\r\n  var constructor = this.constructor;\r\n  return this.then(\r\n    function(value) {\r\n      // @ts-ignore\r\n      return constructor.resolve(callback()).then(function() {\r\n        return value;\r\n      });\r\n    },\r\n    function(reason) {\r\n      // @ts-ignore\r\n      return constructor.resolve(callback()).then(function() {\r\n        // @ts-ignore\r\n        return constructor.reject(reason);\r\n      });\r\n    }\r\n  );\r\n}\r\n\r\n// Store setTimeout reference so promise-polyfill will be unaffected by\r\n// other code modifying setTimeout (like sinon.useFakeTimers())\r\nvar setTimeoutFunc = setTimeout;\r\n\r\nfunction isArray(x) {\r\n  return Boolean(x && typeof x.length !== 'undefined');\r\n}\r\n\r\nfunction noop() {}\r\n\r\n// Polyfill for Function.prototype.bind\r\nfunction bind(fn, thisArg) {\r\n  return function() {\r\n    fn.apply(thisArg, arguments);\r\n  };\r\n}\r\n\r\n/**\r\n * @constructor\r\n * @param {Function} fn\r\n */\r\nfunction Promise(fn) {\r\n  if (!(this instanceof Promise))\r\n    throw new TypeError('Promises must be constructed via new');\r\n  if (typeof fn !== 'function') throw new TypeError('not a function');\r\n  /** @type {!number} */\r\n  this._state = 0;\r\n  /** @type {!boolean} */\r\n  this._handled = false;\r\n  /** @type {Promise|undefined} */\r\n  this._value = undefined;\r\n  /** @type {!Array<!Function>} */\r\n  this._deferreds = [];\r\n\r\n  doResolve(fn, this);\r\n}\r\n\r\nfunction handle(self, deferred) {\r\n  while (self._state === 3) {\r\n    self = self._value;\r\n  }\r\n  if (self._state === 0) {\r\n    self._deferreds.push(deferred);\r\n    return;\r\n  }\r\n  self._handled = true;\r\n  Promise._immediateFn(function() {\r\n    var cb = self._state === 1 ? deferred.onFulfilled : deferred.onRejected;\r\n    if (cb === null) {\r\n      (self._state === 1 ? resolve : reject)(deferred.promise, self._value);\r\n      return;\r\n    }\r\n    var ret;\r\n    try {\r\n      ret = cb(self._value);\r\n    } catch (e) {\r\n      reject(deferred.promise, e);\r\n      return;\r\n    }\r\n    resolve(deferred.promise, ret);\r\n  });\r\n}\r\n\r\nfunction resolve(self, newValue) {\r\n  try {\r\n    // Promise Resolution Procedure: https://github.com/promises-aplus/promises-spec#the-promise-resolution-procedure\r\n    if (newValue === self)\r\n      throw new TypeError('A promise cannot be resolved with itself.');\r\n    if (\r\n      newValue &&\r\n      (typeof newValue === 'object' || typeof newValue === 'function')\r\n    ) {\r\n      var then = newValue.then;\r\n      if (newValue instanceof Promise) {\r\n        self._state = 3;\r\n        self._value = newValue;\r\n        finale(self);\r\n        return;\r\n      } else if (typeof then === 'function') {\r\n        doResolve(bind(then, newValue), self);\r\n        return;\r\n      }\r\n    }\r\n    self._state = 1;\r\n    self._value = newValue;\r\n    finale(self);\r\n  } catch (e) {\r\n    reject(self, e);\r\n  }\r\n}\r\n\r\nfunction reject(self, newValue) {\r\n  self._state = 2;\r\n  self._value = newValue;\r\n  finale(self);\r\n}\r\n\r\nfunction finale(self) {\r\n  if (self._state === 2 && self._deferreds.length === 0) {\r\n    Promise._immediateFn(function() {\r\n      if (!self._handled) {\r\n        Promise._unhandledRejectionFn(self._value);\r\n      }\r\n    });\r\n  }\r\n\r\n  for (var i = 0, len = self._deferreds.length; i < len; i++) {\r\n    handle(self, self._deferreds[i]);\r\n  }\r\n  self._deferreds = null;\r\n}\r\n\r\n/**\r\n * @constructor\r\n */\r\nfunction Handler(onFulfilled, onRejected, promise) {\r\n  this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\r\n  this.onRejected = typeof onRejected === 'function' ? onRejected : null;\r\n  this.promise = promise;\r\n}\r\n\r\n/**\r\n * Take a potentially misbehaving resolver function and make sure\r\n * onFulfilled and onRejected are only called once.\r\n *\r\n * Makes no guarantees about asynchrony.\r\n */\r\nfunction doResolve(fn, self) {\r\n  var done = false;\r\n  try {\r\n    fn(\r\n      function(value) {\r\n        if (done) return;\r\n        done = true;\r\n        resolve(self, value);\r\n      },\r\n      function(reason) {\r\n        if (done) return;\r\n        done = true;\r\n        reject(self, reason);\r\n      }\r\n    );\r\n  } catch (ex) {\r\n    if (done) return;\r\n    done = true;\r\n    reject(self, ex);\r\n  }\r\n}\r\n\r\nPromise.prototype['catch'] = function(onRejected) {\r\n  return this.then(null, onRejected);\r\n};\r\n\r\nPromise.prototype.then = function(onFulfilled, onRejected) {\r\n  // @ts-ignore\r\n  var prom = new this.constructor(noop);\r\n\r\n  handle(this, new Handler(onFulfilled, onRejected, prom));\r\n  return prom;\r\n};\r\n\r\nPromise.prototype['finally'] = finallyConstructor;\r\n\r\nPromise.all = function(arr) {\r\n  return new Promise(function(resolve, reject) {\r\n    if (!isArray(arr)) {\r\n      return reject(new TypeError('Promise.all accepts an array'));\r\n    }\r\n\r\n    var args = Array.prototype.slice.call(arr);\r\n    if (args.length === 0) return resolve([]);\r\n    var remaining = args.length;\r\n\r\n    function res(i, val) {\r\n      try {\r\n        if (val && (typeof val === 'object' || typeof val === 'function')) {\r\n          var then = val.then;\r\n          if (typeof then === 'function') {\r\n            then.call(\r\n              val,\r\n              function(val) {\r\n                res(i, val);\r\n              },\r\n              reject\r\n            );\r\n            return;\r\n          }\r\n        }\r\n        args[i] = val;\r\n        if (--remaining === 0) {\r\n          resolve(args);\r\n        }\r\n      } catch (ex) {\r\n        reject(ex);\r\n      }\r\n    }\r\n\r\n    for (var i = 0; i < args.length; i++) {\r\n      res(i, args[i]);\r\n    }\r\n  });\r\n};\r\n\r\nPromise.resolve = function(value) {\r\n  if (value && typeof value === 'object' && value.constructor === Promise) {\r\n    return value;\r\n  }\r\n\r\n  return new Promise(function(resolve) {\r\n    resolve(value);\r\n  });\r\n};\r\n\r\nPromise.reject = function(value) {\r\n  return new Promise(function(resolve, reject) {\r\n    reject(value);\r\n  });\r\n};\r\n\r\nPromise.race = function(arr) {\r\n  return new Promise(function(resolve, reject) {\r\n    if (!isArray(arr)) {\r\n      return reject(new TypeError('Promise.race accepts an array'));\r\n    }\r\n\r\n    for (var i = 0, len = arr.length; i < len; i++) {\r\n      Promise.resolve(arr[i]).then(resolve, reject);\r\n    }\r\n  });\r\n};\r\n\r\n// Use polyfill for setImmediate for performance gains\r\nPromise._immediateFn = function (fn) {fn();};/*\r\n  // @ts-ignore\r\n  (typeof setImmediate === 'function' &&\r\n    function(fn) {\r\n      // @ts-ignore\r\n      setImmediate(fn);\r\n    }) ||\r\n  function(fn) {\r\n    setTimeoutFunc(fn, 0);\r\n  };\r\n*/\r\n\r\nPromise._unhandledRejectionFn = function _unhandledRejectionFn(/*err*/) {\r\n  if (typeof console !== 'undefined' && console) {\r\n    //console.warn('Possible Unhandled Promise Rejection:', err); // eslint-disable-line no-console\r\n  }\r\n};\r\n/** @suppress {undefinedVars} */\r\n/*\r\nvar globalNS = (function() {\r\n  // the only reliable means to get the global object is\r\n  // `Function('return this')()`\r\n  // However, this causes CSP violations in Chrome apps.\r\n  if (typeof self !== 'undefined') {\r\n    return self;\r\n  }\r\n  if (typeof window !== 'undefined') {\r\n    return window;\r\n  }\r\n  if (typeof global !== 'undefined') {\r\n    return global;\r\n  }\r\n  throw new Error('unable to locate global object');\r\n})();\r\n\r\nif (!('Promise' in globalNS)) {\r\n  globalNS['Promise'] = Promise;\r\n} else if (!globalNS.Promise.prototype['finally']) {\r\n  globalNS.Promise.prototype['finally'] = finallyConstructor;\r\n}*/\r\nreturn Promise;\r\n});\r\n\r\ndefine('FS',[\"FSClass\",\"NativeFS\",\"LSFS\", \"WebFS\", \"PathUtil\",\"Env\",\"assert\",\"SFile\",\"RootFS\",\"Content\",\"zip\",\"DeferredUtil\",\"promise\"],\r\n        function (FSClass,NativeFS,LSFS,WebFS, P,Env,A,SFile,RootFS,Content,zip,DU,PR) {\r\n    var FS={};\r\n    FS.assert=A;\r\n    FS.Content=Content;\r\n    FS.Class=FSClass;\r\n    FS.DeferredUtil=DU;\r\n    if (!DU.config.useJQ) {\r\n        DU.external.Promise=PR;\r\n    }\r\n    FS.Env=Env;\r\n    FS.LSFS=LSFS;\r\n    FS.NativeFS=NativeFS;\r\n    FS.PathUtil=P;\r\n    FS.RootFS=RootFS;\r\n    FS.SFile=SFile;\r\n    FS.WebFS=WebFS;\r\n    FS.zip=zip;\r\n    //if (zip.JSZip) DU.external.Promise=zip.JSZip.external.Promise;\r\n    if (typeof window==\"object\") window.FS=FS;\r\n    var rootFS;\r\n    var env=new Env({});\r\n    FS.addFSType=FSClass.addFSType;\r\n    FS.availFSTypes=FSClass.availFSTypes;\r\n\r\n    FS.setEnvProvider=function (e) {\r\n        env=e;\r\n    };\r\n    FS.getEnvProvider=function () {\r\n        return env;\r\n    };\r\n    FS.setEnv=function (key, value) {\r\n        if (typeof key==\"object\") {\r\n            for (var k in key) {\r\n                env.set(k,key[k]);\r\n            }\r\n        }else {\r\n            env.set(key,value);\r\n        }\r\n    };\r\n    FS.getEnv=function (key) {\r\n        if (typeof key==\"string\") {\r\n            return env.get(key);\r\n        }else {\r\n            return env.value;\r\n        }\r\n    };\r\n    FS.localStorageAvailable=function () {\r\n        try {\r\n            // Fails when Secret mode + iframe in other domain\r\n            return (typeof localStorage===\"object\");\r\n        } catch(e) {\r\n            return false;\r\n        }\r\n    };\r\n    FS.init=function (fs) {\r\n        if (rootFS) return;\r\n        if (!fs) {\r\n            if (NativeFS.available) {\r\n                fs=new NativeFS();\r\n            } else if (FS.localStorageAvailable()) {\r\n                fs=new LSFS(localStorage);\r\n            } else if (typeof importScripts===\"function\") {\r\n                // Worker\r\n                /* global self*/\r\n                self.addEventListener(\"message\", function (e) {\r\n                    var data=e.data;\r\n                    if (typeof data===\"string\") {\r\n                        data=JSON.parse(data);\r\n                    }\r\n                    switch(data.type) {\r\n                    case \"upload\":\r\n                        FS.get(data.base).importFromObject(data.data);\r\n                        break;\r\n                    case \"observe\":\r\n                        rootFS.observe(data.path, function (path,meta) {\r\n                            self.postMessage(JSON.stringify({\r\n                                type: \"changed\",\r\n                                path: path,\r\n                                content: FS.get(path).text(),\r\n                                meta: meta\r\n                            }));\r\n                        });\r\n                        break;\r\n                    }\r\n                });\r\n                fs=LSFS.ramDisk();\r\n            } else {\r\n                fs=LSFS.ramDisk();\r\n            }\r\n        }\r\n        rootFS=new RootFS(fs);\r\n    };\r\n    FS.getRootFS=function () {\r\n        FS.init();\r\n        return rootFS;\r\n    };\r\n    FS.get=function () {\r\n        FS.init();\r\n        return rootFS.get.apply(rootFS,arguments);\r\n    };\r\n    FS.expandPath=function () {\r\n        return env.expandPath.apply(env,arguments);\r\n    };\r\n    FS.resolve=function (path, base) {\r\n        FS.init();\r\n        if (SFile.is(path)) return path;\r\n        path=env.expandPath(path);\r\n        if (base && !P.isAbsolutePath(path)) {\r\n            base=env.expandPath(base);\r\n            return FS.get(base).rel(path);\r\n        }\r\n        return FS.get(path);\r\n    };\r\n    FS.mount=function () {\r\n        FS.init();\r\n        return rootFS.mount.apply(rootFS,arguments);\r\n    };\r\n    FS.unmount=function () {\r\n        FS.init();\r\n        return rootFS.unmount.apply(rootFS,arguments);\r\n    };\r\n    FS.isFile=function (f) {\r\n        return SFile.is(f);\r\n    };\r\n    return FS;\r\n});\r\n\r\n//-----------\r\n\tvar resMod;\r\n\trequirejs([\"FS\"], function (r) {\r\n\t  resMod=r;\r\n\t});\r\n\tif (typeof window!==\"undefined\" && window.FS===undefined) window.FS=resMod;\r\n\tif (typeof module!==\"undefined\") module=resMod;\r\n\treturn resMod;\r\n});\r\n//})(window);\r\n\n/*global window,self,global*/\r\ndefine('root',[],function (){\r\n    if (typeof window!==\"undefined\") return window;\r\n    if (typeof self!==\"undefined\") return self;\r\n    if (typeof global!==\"undefined\") return global;\r\n    return (function (){return this;})();\r\n});\r\n\ndefine('Platform',[],function () {\r\n    var WebSite={};\r\n    // from https://w3g.jp/blog/js_browser_sniffing2015\r\n    var u=window.navigator.userAgent.toLowerCase();\r\n    WebSite.tablet=(u.indexOf(\"windows\") != -1 && u.indexOf(\"touch\") != -1) ||\r\n    u.indexOf(\"ipad\") != -1 ||\r\n    (u.indexOf(\"android\") != -1 && u.indexOf(\"mobile\") == -1) ||\r\n    (u.indexOf(\"firefox\") != -1 && u.indexOf(\"tablet\") != -1) ||\r\n    u.indexOf(\"kindle\") != -1 || u.indexOf(\"silk\") != -1 ||\r\n    u.indexOf(\"playbook\") != -1;\r\n    WebSite.mobile=(u.indexOf(\"windows\") != -1 && u.indexOf(\"phone\") != -1) ||\r\n    u.indexOf(\"iphone\") != -1 || u.indexOf(\"ipod\") != -1 ||\r\n    (u.indexOf(\"android\") != -1 && u.indexOf(\"mobile\") != -1) ||\r\n    (u.indexOf(\"firefox\") != -1 && u.indexOf(\"mobile\") != -1) || u.indexOf(\"blackberry\") != -1;\r\n    return WebSite;\r\n});\r\n\n/*global process, require, BuiltinAssets, requirejs, global */\r\ndefine('WebSite',[\"FS\",\"Platform\",\"root\"], function (FS,Platform,root) {\r\n\tvar P=FS.PathUtil;\r\n\tvar loc=document.location.href;\r\n\tconst WebSite=root.WebSite||{};\r\n\troot.WebSite=WebSite;\r\n\tWebSite.runType=WebSite.runType||root.WebSite_runType;\r\n\tvar prot=location.protocol;\r\n\tvar k;\r\n\r\n\tvar VER=1639557686041;\r\n\tif (!prot.match(/^http/)) prot=\"https:\";\r\n\tswitch(WebSite.runType) {\r\n\tcase \"IDE\":\r\n\t\tObject.assign(WebSite,{\r\n\t\t\turlAliases: WebSite.urlAliases||{}, top: \".\",\r\n\t\t\ttablet:Platform.tablet,\r\n\t\t\tmobile:Platform.mobile\r\n\t\t});\r\n\t\tWebSite.builtinAssetNames={\r\n\t\t\t\"images/Ball.png\":{name:\"$pat_ball\", url: \"images/Ball.png\"},\r\n\t\t\t\"images/base.png\":{name:\"$pat_base\", url: \"images/base.png\", pwidth:32, pheight:32},\r\n\t\t\t\"images/Sample.png\":{name:\"$pat_sample\", url: \"images/Sample.png\"},\r\n\t\t\t\"images/inputPad.png\":{name:\"$pat_inputPad\", url: \"images/inputPad.png\"},\r\n\t\t\t\"images/neko.png\":{name:\"$pat_neko\", url: \"images/neko.png\", pwidth:32, pheight:32},\r\n\t\t\t\"images/mapchip.png\":{name:\"$pat_mapchip\", url: \"images/mapchip.png\", pwidth:32, pheight:32}\r\n\t\t};\r\n\t\tif (!WebSite.pluginTop) {\r\n\t\t\tWebSite.pluginTop=WebSite.top+\"/js/plugins\";\r\n\t\t}\r\n\t\tWebSite.sampleImg=WebSite.top+\"/images\";\r\n\t\tWebSite.isNW=(typeof process==\"object\" && (process.__node_webkit||process.__nwjs));\r\n\t\tWebSite.mp4Disabled=WebSite.isNW;\r\n\t\tWebSite.tonyuHome=\"/Tonyu/\";\r\n\t\tWebSite.PathSep=\"/\";\r\n\t\tif (WebSite.isNW) {\r\n\t\t\tWebSite.PathSep=require(\"path\").sep;\r\n\t\t\tWebSite.cwd=P.directorify(process.cwd().replace(/\\\\/g,\"/\"));\r\n\t\t\t//WebSite.exeDir=WebSite.execDir=P.up(P.fixSep(process.execPath)); not suitable when mac\r\n\t\t\tif (process.env.TONYU_HOME) {\r\n\t\t\t\tWebSite.tonyuHome=P.directorify(process.env.TONYU_HOME);\r\n\t\t\t} else {\r\n\t\t\t\tWebSite.tonyuHome=P.rel(WebSite.cwd,\"fs/Tonyu/\");\r\n\t\t\t}\r\n\t\t\tWebSite.logdir=process.env.TONYU_LOGDIR;//\"C:/var/log/Tonyu/\";\r\n\t\t\tWebSite.wwwDir=P.rel(WebSite.cwd,\"www/\");\r\n\t\t\tWebSite.platform=process.platform;\r\n\t\t\tWebSite.ffmpeg=P.rel(WebSite.cwd,(WebSite.platform==\"win32\"?\r\n\t\t\t\t\t\"ffmpeg/bin/ffmpeg.exe\":\"ffmpeg/bin/ffmpeg\"));\r\n\t\t\tWebSite.pkgInfo=require(P.rel(WebSite.cwd, \"package.json\"));\r\n\t\t\tif (process.env.TONYU_PROJECTS) {\r\n\t\t\t\tWebSite.projects=process.env.TONYU_PROJECTS.replace(/\\\\/g,\"/\").split(require('path').delimiter);\r\n\t\t\t} else if ( WebSite.pkgInfo && WebSite.pkgInfo.config && WebSite.pkgInfo.config.prjDirs ){\r\n\t\t\t\tWebSite.projects=WebSite.pkgInfo.config.prjDirs.map(function (d) {\r\n\t\t\t\t\td=P.directorify(d);\r\n\t\t\t\t\tif (P.isAbsolute(d)) return d;\r\n\t\t\t\t\treturn P.rel(WebSite.cwd,d);\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tWebSite.projects=[P.rel(WebSite.cwd,\"Projects/\"),\r\n\t\t\t\t\tP.rel(WebSite.tonyuHome,\"Projects/\")];\r\n\t\t\t}\r\n\t\t\tWebSite.kernelDir=P.rel(WebSite.wwwDir,\"Kernel/\");\r\n\t\t} else {\r\n\t\t\tif (loc.match(/edit\\.tonyu\\.jp\\/n\\//)) {\r\n\t\t\t\tWebSite.wwwDir=prot+\"//\"+location.host+\"/n/\";\r\n\t\t\t} else {\r\n\t\t\t\t// Why?\r\n\t\t\t\tWebSite.wwwDir=prot+\"//\"+location.host+\"/\";\r\n\t\t\t}\r\n\t\t\tWebSite.projects=[P.rel(WebSite.tonyuHome,\"Projects/\")];\r\n\t\t}\r\n\t\t//WebSite.kernelDir=WebSite.top+\"/Kernel/\";\r\n\t\t// kernelDir must be absolute\r\n\t\tWebSite.kernelDir=P.rel(WebSite.wwwDir,\"Kernel/\");\r\n\t\t// compiledKernel is URL , not file path.\r\n\t\t// It is correct as long as the html pages in www/ (not html/build|dev )\r\n\t\tWebSite.compiledKernel=\"Kernel/js/concat.js\";   //P.rel(WebSite.kernelDir,\"js/concat.js\");\r\n\t\tWebSite.compiledTools={\r\n\t\t\tmapEditor2: \"Tools/MapEditor2/js/concat.js\",\r\n\t\t};\r\n\t\tsetNS2DepSpec();\r\n\t\tif (loc.match(/localhost\\/tonyu2/)) {\r\n\t\t\tWebSite.wwwDir=prot+\"//\"+location.host+\"/tonyu2/\";\r\n\t\t\tWebSite.kernelDir=WebSite.wwwDir+\"Kernel/\";\r\n\t\t\tWebSite.compiledKernel=WebSite.kernelDir+\"js/concat.js\";\r\n\t\t\tWebSite.uploadTmpUrl=prot+\"//localhost/tsite/tonyu/e/cgi-bin/uploadTmp.cgi\";\r\n\t\t\tWebSite.newVersionUrl=prot+\"//localhost/tsite/tonyu/project/newVersion.cgi\";\r\n\t\t\tWebSite.quickUploadURL=prot+\"//localhost/tsite/tonyu/project/quickDone.cgi\";\r\n\t\t\tWebSite.scriptServer=\"https://localhost/tonyu2/\";\r\n\t\t} else {\r\n\t\t\tWebSite.uploadTmpUrl=prot+\"//edit.tonyu.jp/cgi-bin/uploadTmp.cgi\";\r\n\t\t\tWebSite.newVersionUrl=prot+\"//www.tonyu.jp/project/newVersion.cgi\";\r\n\t\t\tWebSite.quickUploadURL=prot+\"//www.tonyu.jp/project/quickDone.cgi\";\r\n\t\t\tWebSite.scriptServer=\"https://edit.tonyu.jp/\";\r\n\t\t}\r\n\t\tFS.setEnvProvider(new FS.Env(WebSite));\r\n\t\tWebSite.sysVersion=VER;\r\n\t\tWebSite.version=2;\r\n\t\tWebSite.projectEditorURL=\"project2.html\";\r\n\t\tsetDefaultResource(WebSite);\r\n\t\treturn WebSite;\r\n\tcase \"singleHTML\":\r\n\t\tObject.assign(WebSite,{\r\n\t\t\turlAliases: WebSite.urlAliases||{}, top: \".\",\r\n\t\t\ttablet:Platform.tablet,\r\n\t\t\tmobile:Platform.mobile\r\n\t\t});\r\n\t\tif (typeof BuiltinAssets===\"object\") {\r\n\t\t\tfor (k in BuiltinAssets) {\r\n\t\t\t\tWebSite.urlAliases[k]=BuiltinAssets[k];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tWebSite.tonyuHome=\"/Tonyu/\";\r\n\t\tWebSite.projects=[P.rel(WebSite.tonyuHome,\"Projects/\")];\r\n\t\tif (loc.match(/localhost\\/tonyu2/)) {\r\n\t\t\tWebSite.scriptServer=\"http://localhost/tonyu2/\";\r\n\t\t} else {\r\n\t\t\tWebSite.scriptServer=\"https://edit.tonyu.jp/\";\r\n\t\t}\r\n\t\tWebSite.pluginTop=WebSite.scriptServer+\"js/plugins\";\r\n\t\tWebSite.isNW=(typeof process==\"object\" && (process.__node_webkit||process.__nwjs));\r\n\t\tWebSite.PathSep=\"/\";\r\n\t\tWebSite.compiledKernel=WebSite.scriptServer+\"Kernel/js/concat.js\";\r\n\t\tWebSite.compiledTools={\r\n\t\t\tmapEditor2: `${WebSite.scriptServer}Tools/MapEditor2/js/concat.js`,\r\n\t\t};\r\n\t\tsetNS2DepSpec();\r\n\t\tFS.setEnvProvider(new FS.Env(WebSite));\r\n\t\tWebSite.sysVersion=VER;\r\n\t\tsetDefaultResource(WebSite);\r\n\t\treturn WebSite;\r\n\tcase \"multiHTML\":\r\n\t\tObject.assign(WebSite,{\r\n\t\t\turlAliases: WebSite.urlAliases||{}, top: \".\",\r\n\t\t\ttablet:Platform.tablet,\r\n\t\t\tmobile:Platform.mobile\r\n\t\t});\r\n\t\tWebSite.tonyuHome=\"/Tonyu/\";\r\n\t\tWebSite.pluginTop=WebSite.top+\"/js/plugins\";\r\n\t\tWebSite.isNW=(typeof process==\"object\" && (process.__node_webkit||process.__nwjs));\r\n\t\tWebSite.PathSep=\"/\";\r\n\t\tWebSite.mp4Disabled=WebSite.isNW;\r\n\t\tif (WebSite.isNW) {\r\n\t\t\tWebSite.PathSep=getPathSep();\r\n\t\t\tWebSite.cwd=P.directorify(process.cwd().replace(/\\\\/g,\"/\"));\r\n\t\t\tWebSite.platform=process.platform;\r\n\t\t}\r\n\t\t// this sets at runScript2.js\r\n\t\t//WebSite.compiledKernel=WebSite.top+\"/js/kernel.js\";\r\n\t\t//-------------\r\n\t\tFS.setEnvProvider(new FS.Env(WebSite));\r\n\t\tWebSite.sysVersion=VER;\r\n\t\treturn WebSite;\r\n\tcase \"manual\":// for BitArrow\r\n\t\treturn WebSite;\r\n\tdefault:\r\n\t\tthrow new Error(\"WebSite.runType is not set\");\r\n\t}\r\n\tfunction setNS2DepSpec() {\r\n\t\tWebSite.ns2depspec=[\r\n\t        {namespace:\"kernel\", url: WebSite.compiledKernel},\r\n\t        {namespace:\"mapEditor2\", url: WebSite.compiledTools.mapEditor2},\r\n\t    ];\r\n\t}\r\n\tfunction setDefaultResource(WebSite) {\r\n\t\tWebSite.defaultResource={\r\n\t       images:[\r\n\t          {name:\"$pat_base\", url: \"images/base.png\", pwidth:32, pheight:32},\r\n\t          {name:\"$pat_sample\", url: \"images/Sample.png\"},\r\n\t          {name:\"$pat_neko\", url: \"images/neko.png\", pwidth:32, pheight:32},\r\n\t          {name:\"$pat_mapchip\", url: \"images/mapchip.png\", pwidth:32, pheight:32}\r\n\t       ],\r\n\t       sounds:[]\r\n\t    };\r\n\t}\r\n\t//WebSite.blobPath=WebSite.serverTop+\"/serveBlob\";        //TODO: urlchange!\r\n\t/*WebSite.url={\r\n\t\tgetDirInfo:WebSite.serverTop+\"/getDirInfo\",\r\n\t\tgetFiles:WebSite.serverTop+\"/File2LSSync\",\r\n\t\tputFiles:WebSite.serverTop+\"/LS2FileSync\"\r\n\t};*/\r\n\tfunction getPathSep() {\r\n\t\tconst requireTries=[\r\n\t\t\t()=>require(\"path\"),\r\n\t\t\t()=>requirejs.nodeRequire(\"path\"),\r\n\t\t\t()=>global.require(\"path\")\r\n\t\t];\r\n\t\tfor (let fsf of requireTries) {\r\n\t\t\ttry {\r\n\t\t\t\tconst path=fsf();\r\n\t\t\t\tif (typeof path.sep===\"string\") return path.sep;\r\n\t\t\t} catch(e){\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn \"/\";\r\n\t}\r\n});\r\n\ndefine('plugins',[\"WebSite\",\"root\"],function (WebSite,root){\r\n    var plugins={};\r\n    var installed= {\r\n        box2d:{src: \"Box2dWeb-2.1.a.3.min.js\",detection:/BodyActor/,symbol:\"Box2D\" },\r\n        timbre: {src:\"timbre.js\",symbol:\"T\" },\r\n        gif: {src:\"gif-concat.js\",detection:/GIFWriter/,symbol:\"GIF\"},\r\n        Mezonet: {src:\"Mezonet.js\", symbol: \"Mezonet\"},\r\n        PicoAudio: {src:\"PicoAudio.min.js\", symbol:\"PicoAudio\"},\r\n        JSZip: {src:\"jszip.min.js\", symbol:\"JSZip\"},\r\n        // single js is required for runScript1.js\r\n        jquery_ui: {src:\"jquery-ui.js\", detection:/\\$InputBox/,symbol:\"$.ui\"}\r\n    };\r\n    plugins.installed=installed;\r\n    plugins.detectNeeded=function (src,res) {\r\n        for (var name in installed) {\r\n            var d=installed[name].detection;\r\n            if (d) {\r\n                var r=d.exec(src);\r\n                if (r) res[name]=1;\r\n            }\r\n        }\r\n        return res;\r\n    };\r\n    plugins.loaded=function (name) {\r\n        var i=installed[name];\r\n        if (!i) throw new Error(\"plugin not found: \"+name);\r\n        return hasInGlobal(i.symbol);\r\n    };\r\n    function hasInGlobal(name) {\r\n        // name: dot ok\r\n        var g=window;\r\n        name.split(\".\").forEach(function (e) {\r\n            if (!g) return;\r\n            g=g[e];\r\n        });\r\n        return g;\r\n    }\r\n    plugins.loadAll=function (names,options) {\r\n        options=convOpt(options);\r\n        var namea=[];\r\n        for (var name in names) {\r\n            if (installed[name] && !plugins.loaded(name)) {\r\n                namea.push(name);\r\n            }\r\n        }\r\n        var i=0;\r\n        console.log(\"loading plugins\",namea);\r\n        setTimeout(loadNext,0);\r\n        function loadNext() {\r\n            if (i>=namea.length) options.onload();\r\n            else plugins.load(namea[i++],loadNext);\r\n        }\r\n    };\r\n    function convOpt(options) {\r\n        if (typeof options==\"function\") options={onload:options};\r\n        if (!options) options={};\r\n        if (!options.onload) options.onload=function (){};\r\n        return options;\r\n    }\r\n    plugins.load=function (name,options) {\r\n        var i=installed[name];\r\n        if (!i) throw new Error(\"plugin not found: \"+name);\r\n        options=convOpt(options);\r\n        var src=WebSite.pluginTop+\"/\"+i.src;\r\n        var reqj=root.requirejs;\r\n        /*if (typeof requireSimulator===\"undefined\") {\r\n            if (typeof requirejs===\"function\") reqj=requirejs;\r\n        } else {\r\n            if (requireSimulator.real) reqj=requireSimulator.real.requirejs;\r\n        }*/\r\n        if (reqj) {\r\n            if (!src.match(/^https?:/)) src=src.replace(/\\.js$/,\"\");\r\n            console.log(\"Loading plugin via requirejs\",src);\r\n            reqj([src], function (res) {\r\n                if (!window[i.symbol] && res) window[i.symbol]=res;\r\n                options.onload(res);\r\n            });\r\n        } else {\r\n            console.log(\"Loading plugin via <script>\",src);\r\n            var s=document.createElement(\"script\");\r\n            s.src=src;\r\n            s.onload=options.onload;\r\n            document.body.appendChild(s);\r\n            //$(\"<script>\").on(\"load\",options.onload).attr(\"src\",src).appendTo(\"body\");\r\n        }\r\n        //setTimeout(options.onload,500);\r\n\r\n    };\r\n    plugins.request=function (name) {\r\n        if (plugins.loaded(name)) return;\r\n        var req=new Error(\"Plugin \"+name+\" required\");\r\n        req.pluginName=name;\r\n    };\r\n    return plugins;\r\n});\r\n\n(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\r\nconst ja={\r\n    superClassIsUndefined:\"親クラス {1}は定義されていません\",\r\n    classIsUndefined:\"クラス {1}は定義されていません\",\r\n    invalidLeftValue:\"'{1}'は左辺には書けません．\",\r\n    fieldDeclarationRequired: \"{1}は宣言されていません（フィールドの場合，明示的に宣言してください）．\",\r\n    duplicateKeyInObjectLiteral:\"オブジェクトリテラルのキー名'{1}'が重複しています\",\r\n    cannotUseStringLiteralAsAShorthandOfObjectValue:\"オブジェクトリテラルのパラメタに単独の文字列は使えません\",\r\n    breakShouldBeUsedInIterationOrSwitchStatement:\"break； は繰り返しまたはswitch文の中で使います.\" ,\r\n    continueShouldBeUsedInIterationStatement:\"continue； は繰り返しの中で使います.\",\r\n    cannotUseObjectLiteralAsTheExpressionOfStatement:\"オブジェクトリテラル単独の式文は書けません．\",\r\n    undefinedMethod:\"メソッド{1}はありません．\",\r\n    notAWaitableMethod: \"メソッド{1}は待機可能メソッドではありません\",\r\n    circularDependencyDetected: \"次のクラス間に循環参照があります: {1}\",\r\n    cannotWriteReturnInTryStatement: \"現実装では、tryの中にreturnは書けません\",\r\n    cannotWriteBreakInTryStatement: \"現実装では、tryの中にbreakは書けません\",\r\n    cannotWriteContinueInTryStatement: \"現実装では、tryの中にcontinueは書けません\",\r\n    cannotWriteTwoOrMoreCatch: \"現実装では、catch節1個のみをサポートしています\",\r\n    lexicalError:\"文法エラー(Token)\",\r\n    parseError:\"文法エラー\",\r\n    ambiguousClassName: \"曖昧なクラス名： {1}.{2}, {3}\",\r\n    cannotInvokeMethod: \"{1}(={2})のメソッド {3}を呼び出せません\",\r\n    notAMethod :\"{1}{2}(={3})はメソッドではありません\",\r\n    notAFunction: \"{1}は関数ではありません\",\r\n    uninitialized: \"{1}(={2})は初期化されていなません\",\r\n    newIsRequiredOnInstanciate: \"クラス名{1}はnewをつけて呼び出して下さい。\",\r\n    bootClassIsNotFound: \"{1}というクラスはありません．\",\r\n    infiniteLoopDetected: \"無限ループをストップしました。\\n\"+\r\n        \"   プロジェクト オプションで無限ループチェックの有無を設定できます。\\n\"+\r\n        \"   [参考]https://edit.tonyu.jp/doc/options.html\\n\",\r\n};\r\nconst en={\r\n    \"superClassIsUndefined\" : \"Super Class '{1}' is not defined\", //親クラス {1}は定義されていません\r\n    \"classIsUndefined\" : \"Class {1} is Undefined\", //クラス {1}は定義されていません\r\n    \"invalidLeftValue\" : \"{1} is not a valid Left Value\", //'{1}'は左辺には書けません．\r\n    \"fieldDeclarationRequired\" : \"'{1}' is not declared, If you have meant it is a Field, Declare Explicitly.\", //{1}は宣言されていません（フィールドの場合，明示的に宣言してください）．\r\n    \"duplicateKeyInObjectLiteral\" : \"Duplicate Key In Object Literal: {1}\", //オブジェクトリテラルのキー名'{1}'が重複しています\r\n    \"cannotUseStringLiteralAsAShorthandOfObjectValue\" : \"Cannot Use String Literal as a Shorthand of Object Value\", //オブジェクトリテラルのパラメタに単独の文字列は使えません\r\n    \"breakShouldBeUsedInIterationOrSwitchStatement\" : \"break; Should be Used In Iteration or switch Statement\", //break； は 繰り返しまたはswitch文の中で使います.\r\n    \"continueShouldBeUsedInIterationStatement\" : \"continue; Should be Used In Iteration Statement\", //continue； は繰り返しの中で使います.\r\n    \"cannotUseObjectLiteralAsTheExpressionOfStatement\" : \"Cannot Use Object Literal As The Expression Of Statement\", //オブ ジェクトリテラル単独の式文は書けません．\r\n    \"undefinedMethod\" : \"Undefined Method: '{1}'\", //メソッド{1}はありません．\r\n    \"notAWaitableMethod\" : \"Not A Waitable Method: '{1}'\", //メソッド{1}は待機可能メソッドではありません\r\n    \"circularDependencyDetected\" : \"Circular Dependency Detected: {1}\", //次のクラス間に循環参照があります: {1}\r\n    \"cannotWriteReturnInTryStatement\" : \"Cannot Write Return In Try Statement\", //現実装では、tryの中にreturnは書けません\r\n    \"cannotWriteBreakInTryStatement\" : \"Cannot Write Break In Try Statement\", //現実装では、tryの中にbreakは書けません\r\n    \"cannotWriteContinueInTryStatement\" : \"Cannot Write Continue In Try Statement\", //現実装では、tryの中にcontinueは書けま せん\r\n    \"cannotWriteTwoOrMoreCatch\" : \"Cannot Write Two Or More Catch\", //現実装では、catch節1個のみをサポートしています\r\n    \"lexicalError\" : \"Lexical Error\", //文法エラー(Token)\r\n    \"parseError\" : \"Parse Error\", //文法エラー\r\n    \"ambiguousClassName\" : \"Ambiguous Class Name: {1}.{2} vs {3}\", //曖昧なクラス名： {1}.{2}, {3}\r\n    \"cannotInvokeMethod\" : \"Cannot Invoke Method {1}(={2}).{3}\", //{1}(={2})のメソッド {3}を呼び出せません\r\n    \"notAMethod\" : \"Not A Method: {1}{2}(={3})\", //{1}{2}(={3})はメソッドではありません\r\n    \"notAFunction\" : \"Not A Function: {1}\", //{1}は関数ではありません\r\n    \"uninitialized\" : \"Uninitialized: {1}(={2})\", //{1}(={2})は初期化されていなません\r\n    \"newIsRequiredOnInstanciate\" : \"new is required to Instanciate {1}\", //クラス名{1}はnewをつけて呼び出して下さい。\r\n    \"bootClassIsNotFound\" : \"Boot Class {1} Is Not Found\", //{1}というクラスはありません．\r\n    \"infiniteLoopDetected\" : \"Infinite Loop Detected\",\r\n};\r\n/*let buf=\"\";\r\n    for (let k of Object.keys(ja)) {\r\n        buf+=`\"${k}\" : \"${englishify(k)}\", //${ja[k]}\\n`;\r\n    }\r\n    console.log(buf);*/\r\n\r\nlet dict=en;\r\nfunction R(name,...params) {\r\n    let mesg=dict[name];\r\n    if (!mesg) {\r\n        return englishify(name)+(params.length?\": \"+params.join(\",\"):\"\");\r\n    }\r\n    return buildMesg(mesg, ...params);//+\"です！\";\r\n}\r\nfunction buildMesg() {\r\n    var a=Array.prototype.slice.call(arguments);\r\n    var format=a.shift();\r\n    if (a.length===1 && a[0] instanceof Array) a=a[0];\r\n    var P=\"vroijvowe0r324\";\r\n    format=format.replace(/\\{([0-9])\\}/g,P+\"$1\"+P);\r\n    format=format.replace(new RegExp(P+\"([0-9])\"+P,\"g\"),function (_,n) {\r\n        return a[parseInt(n)-1]+\"\";\r\n    });\r\n    return format;\r\n}\r\nfunction englishify(name) {\r\n    name=name.replace(/([A-Z])/g,\" $1\");\r\n    name=name[0].toUpperCase()+name.substring(1);\r\n    return name;\r\n}\r\nR.setLocale=locale=>{\r\n    if (locale===\"ja\") dict=ja;\r\n    if (locale===\"en\") dict=en;\r\n};\r\nmodule.exports=R;\r\n\r\n},{}],2:[function(require,module,exports){\r\n    const Assertion=function(failMesg) {\r\n        this.failMesg=flatten(failMesg || \"Assertion failed: \");\r\n    };\r\n    var $a;\r\n    Assertion.prototype={\r\n        _regedType:{},\r\n        registerType: function (name,t) {\r\n            this._regedType[name]=t;\r\n        },\r\n        MODE_STRICT:\"strict\",\r\n        MODE_DEFENSIVE:\"defensive\",\r\n        MODE_BOOL:\"bool\",\r\n        fail:function () {\r\n            var a=$a(arguments);\r\n            var value=a.shift();\r\n            a=flatten(a);\r\n            a=this.failMesg.concat(value).concat(a).concat([\"mode\",this._mode]);\r\n            console.log.apply(console,a);\r\n            if (this.isDefensive()) return value;\r\n            if (this.isBool()) return false;\r\n            throw new Error(a.join(\" \"));\r\n        },\r\n        subAssertion: function () {\r\n            var a=$a(arguments);\r\n            a=flatten(a);\r\n            return new Assertion(this.failMesg.concat(a));\r\n        },\r\n        assert: function (t,failMesg) {\r\n            if (!t) return this.fail(t,failMesg);\r\n            return t;\r\n        },\r\n        eq: function (a,b) {\r\n            if (a!==b) return this.fail(a,\"!==\",b);\r\n            return this.isBool()?true:a;\r\n        },\r\n        ne: function (a,b) {\r\n            if (a===b) return this.fail(a,\"===\",b);\r\n            return this.isBool()?true:a;\r\n        },\r\n        isset: function (a, n) {\r\n            if (a==null) return this.fail(a, (n||\"\")+\" is null/undef\");\r\n            return this.isBool()?true:a;\r\n        },\r\n        is: function (value,type) {\r\n            var t=type,v=value;\r\n            if (t==null) {\r\n                return this.fail(value, \"assert.is: type must be set\");\r\n                // return t; Why!!!!???? because is(args,[String,Number])\r\n            }\r\n            if (t._assert_func) {\r\n                t._assert_func.apply(this,[v]);\r\n                return this.isBool()?true:value;\r\n            }\r\n            this.assert(value!=null,[value, \"should be \",t]);\r\n            if (t instanceof Array || (typeof global==\"object\" && typeof global.Array==\"function\" && t instanceof global.Array) ) {\r\n                if (!value || typeof value.length!=\"number\") {\r\n                    return this.fail(value, \"should be array:\");\r\n                }\r\n                var self=this;\r\n                for (var i=0 ;i<t.length; i++) {\r\n                    let na=self.subAssertion(\"failed at \",value,\"[\",i,\"]: \");\r\n                    if (t[i]==null) {\r\n                        console.log(\"WOW!7\", v[i],t[i]);\r\n                    }\r\n                    na.is(v[i],t[i]);\r\n                }\r\n                return this.isBool()?true:value;\r\n            }\r\n            if (t===String || t==\"string\") {\r\n                this.assert(typeof(v)==\"string\",[v,\"should be a string \"]);\r\n                return this.isBool()?true:value;\r\n            }\r\n            if (t===Number || t==\"number\") {\r\n                this.assert(typeof(v)==\"number\",[v,\"should be a number\"]);\r\n                return this.isBool()?true:value;\r\n            }\r\n            if (t instanceof RegExp || (typeof global==\"object\" && typeof global.RegExp==\"function\" && t instanceof global.RegExp)) {\r\n                this.is(v,String);\r\n                this.assert(t.exec(v),[v,\"does not match to\",t]);\r\n                return this.isBool()?true:value;\r\n            }\r\n            if (t===Function) {\r\n                this.assert(typeof v==\"function\",[v,\"should be a function\"]);\r\n                return this.isBool()?true:value;\r\n            }\r\n            if (typeof t==\"function\") {\r\n                this.assert((v instanceof t),[v, \"should be \",t]);\r\n                return this.isBool()?true:value;\r\n            }\r\n            if (t && typeof t==\"object\") {\r\n                for (var k in t) {\r\n                    let na=this.subAssertion(\"failed at \",value,\".\",k,\":\");\r\n                    na.is(value[k],t[k]);\r\n                }\r\n                return this.isBool()?true:value;\r\n            }\r\n            if (typeof t==\"string\") {\r\n                var ty=this._regedType[t];\r\n                if (ty) return this.is(value,ty);\r\n                //console.log(\"assertion Warning:\",\"unregistered type:\", t, \"value:\",value);\r\n                return this.isBool()?true:value;\r\n            }\r\n            return this.fail(value, \"Invaild type: \",t);\r\n        },\r\n        ensureError: function (action, err) {\r\n            try {\r\n                action();\r\n            } catch(e) {\r\n                if(typeof err==\"string\") {\r\n                    assert(e+\"\"===err,action+\" thrown an error \"+e+\" but expected:\"+err);\r\n                }\r\n                console.log(\"Error thrown successfully: \",e.message);\r\n                return;\r\n            }\r\n            this.fail(action,\"should throw an error\",err);\r\n        },\r\n        setMode:function (mode) {\r\n            this._mode=mode;\r\n        },\r\n        isDefensive:function () {\r\n            return this._mode===this.MODE_DEFENSIVE;\r\n        },\r\n        isBool:function () {\r\n            return this._mode===this.MODE_BOOL;\r\n        },\r\n        isStrict:function () {\r\n            return !this.isDefensive() && !this.isBool();\r\n        }\r\n    };\r\n    $a=function (args) {\r\n        var a=[];\r\n        for (var i=0; i<args.length ;i++) a.push(args[i]);\r\n        return a;\r\n    };\r\n    var top=new Assertion();\r\n    var assert=function () {\r\n        try {\r\n            return top.assert.apply(top,arguments);\r\n        } catch(e) {\r\n            throw new Error(e.message);\r\n        }\r\n    };\r\n    [\"setMode\",\"isDefensive\",\"is\",\"isset\",\"ne\",\"eq\",\"ensureError\"].forEach(function (m) {\r\n        assert[m]=function () {\r\n            try {\r\n                return top[m].apply(top,arguments);\r\n            } catch(e) {\r\n                console.log(e.stack);\r\n                //if (top.isDefensive()) return arguments[0];\r\n                //if (top.isBool()) return false;\r\n                throw new Error(e.message);\r\n            }\r\n        };\r\n    });\r\n    assert.fail=top.fail.bind(top);\r\n    assert.MODE_STRICT=top.MODE_STRICT;\r\n    assert.MODE_DEFENSIVE=top.MODE_DEFENSIVE;\r\n    assert.MODE_BOOL=top.MODE_BOOL;\r\n    assert.f=function (f) {\r\n        return {\r\n            _assert_func: f\r\n        };\r\n    };\r\n    assert.opt=function (t) {\r\n        return assert.f(function (v) {\r\n            return v==null || v instanceof t;\r\n        });\r\n    };\r\n    assert.and=function () {\r\n        var types=$a(arguments);\r\n        assert(types instanceof Array);\r\n        return assert.f(function (value) {\r\n            var t=this;\r\n            for (var i=0; i<types.length; i++) {\r\n                t.is(value,types[i]);\r\n            }\r\n        });\r\n    };\r\n    function flatten(a) {\r\n        if (a instanceof Array) {\r\n            var res=[];\r\n            a.forEach(function (e) {\r\n                res=res.concat(flatten(e));\r\n            });\r\n            return res;\r\n        }\r\n        return [a];\r\n    }\r\n    function isArg(a) {\r\n        return \"length\" in a && \"caller\" in a && \"callee\" in a;\r\n    }\r\n    module.exports=assert;\r\n\r\n},{}],3:[function(require,module,exports){\r\n/*global window,self,global*/\r\n(function (deps, factory) {\r\n    module.exports=factory();\r\n})([],function (){\r\n    if (typeof window!==\"undefined\") return window;\r\n    if (typeof self!==\"undefined\") return self;\r\n    if (typeof global!==\"undefined\") return global;\r\n    return (function (){return this;})();\r\n});\r\n\r\n},{}],4:[function(require,module,exports){\r\n//\t\tfunction (assert,TT,IT,DU) {\r\nvar assert=require(\"../lib/assert\");\r\nvar root=require(\"../lib/root\");\r\nvar TonyuThreadF=require(\"./TonyuThread\");\r\nvar IT=require(\"./tonyuIterator\");\r\nconst R=require(\"../lib/R\");\r\nmodule.exports=function () {\r\n\t// old browser support\r\n\tif (!root.performance) {\r\n\t\troot.performance = {};\r\n\t}\r\n\tif (!root.performance.now) {\r\n\t\troot.performance.now = function now() {\r\n\t\t\treturn Date.now();\r\n\t\t};\r\n\t}\r\n\tvar preemptionTime=60;\r\n\tvar klass={};\r\n\tvar Tonyu,TT;\r\n\tfunction thread() {\r\n\t\tvar t=new TT();\r\n\t\tt.handleEx=handleEx;\r\n\t\treturn t;\r\n\t}\r\n\tfunction timeout(t) {\r\n\t\treturn new Promise(function (s) {\r\n\t\t\tsetTimeout(s,t);\r\n\t\t});\r\n\t}\r\n\t/*function animationFrame() {\r\n\t\treturn new Promise( function (f) {\r\n\t\t\trequestAnimationFrame(f);\r\n\t\t});\r\n\t}*/\r\n\r\n\tfunction handleEx(e) {\r\n\t\tif (Tonyu.onRuntimeError) {\r\n\t\t\tTonyu.onRuntimeError(e);\r\n\t\t} else {\r\n\t\t\t//if (typeof $LASTPOS==\"undefined\") $LASTPOS=0;\r\n\t\t\tif (root.alert) root.alert(\"Error: \"+e);\r\n\t\t\tconsole.log(e.stack);\r\n\t\t\tthrow e;\r\n\t\t}\r\n\t}\r\n\tklass.addMeta=addMeta;\r\n\tfunction addMeta(fn,m) {\r\n\t\t// why use addMeta?\r\n\t\t// because when compiled from source, additional info(src file) is contained.\r\n\t\t// k.meta={...} erases these info\r\n\t\tassert.is(arguments,[String,Object]);\r\n\t\treturn extend(klass.getMeta(fn), m);\r\n\t}\r\n\tklass.removeMeta=function (n) {\r\n\t\tdelete classMetas[n];\r\n\t};\r\n\tklass.removeMetaAll=function (ns) {\r\n\t\tns+=\".\";\r\n\t\tfor (let n in classMetas) {\r\n\t\t\tif (n.substring(0,ns.length)===ns) delete classMetas[n];\r\n\t\t}\r\n\t};\r\n\tklass.getMeta=function (k) {// Class or fullName\r\n\t\tif (typeof k==\"function\") {\r\n\t\t\treturn k.meta;\r\n\t\t} else if (typeof k==\"string\"){\r\n\t\t\tvar mm = classMetas[k];\r\n\t\t\tif (!mm) classMetas[k]=mm={};\r\n\t\t\treturn mm;\r\n\t\t}\r\n\t};\r\n\tklass.ensureNamespace=function (top,nsp) {\r\n\t\tvar keys=nsp.split(\".\");\r\n\t\tvar o=top;\r\n\t\tvar i;\r\n\t\tfor (i=0; i<keys.length; i++) {\r\n\t\t\tvar k=keys[i];\r\n\t\t\tif (!o[k]) o[k]={};\r\n\t\t\to=o[k];\r\n\t\t}\r\n\t\treturn o;\r\n\t};\r\n\t/*Function.prototype.constructor=function () {\r\n\t\tthrow new Error(\"This method should not be called\");\r\n\t};*/\r\n\tconst propReg=/^__([gs]et)ter__(.*)$/;\r\n\tklass.propReg=propReg;\r\n\tconst property={\r\n\t\tisPropertyMethod(name) {\r\n\t\t\treturn propReg.exec(name);\r\n\t\t},\r\n\t\tmethodFor(type, name) {\r\n\t\t\treturn `__${type}ter__${name}`;\r\n\t\t}\r\n\t};\r\n\tklass.property=property;\r\n\tklass.define=function (params) {\r\n\t\t// fullName, shortName,namspace, superclass, includes, methods:{name/fiber$name: func}, decls\r\n\t\tvar parent=params.superclass;\r\n\t\tvar includes=params.includes;\r\n\t\tvar fullName=params.fullName;\r\n\t\tvar shortName=params.shortName;\r\n\t\tvar namespace=params.namespace;\r\n\t\tvar methodsF=params.methods;\r\n\t\tvar decls=params.decls;\r\n\t\tvar nso=klass.ensureNamespace(Tonyu.classes, namespace);\r\n\t\tvar outerRes;\r\n\t\tfunction chkmeta(m,ctx) {\r\n\t\t\tctx=ctx||{};\r\n\t\t\tif (ctx.isShim) return m;\r\n\t\t\tctx.path=ctx.path||[];\r\n\t\t\tctx.path.push(m);\r\n\t\t\tif (m.isShim) {\r\n\t\t\t\tconsole.log(\"chkmeta::ctx\",ctx);\r\n\t\t\t\tthrow new Error(\"Shim found \"+m.extenderFullName);\r\n\t\t\t}\r\n\t\t\tif (m.superclass) chkmeta(m.superclass,ctx);\r\n\t\t\tif (!m.includes) {\r\n\t\t\t\tconsole.log(\"chkmeta::ctx\",ctx);\r\n\t\t\t\tthrow new Error(\"includes not found\");\r\n\t\t\t}\r\n\t\t\tm.includes.forEach(function (mod) {\r\n\t\t\t\tchkmeta(mod,ctx);\r\n\t\t\t});\r\n\t\t\tctx.path.pop();\r\n\t\t\treturn m;\r\n\t\t}\r\n\t\tfunction chkclass(c,ctx) {\r\n\t\t\tif (!c.prototype.hasOwnProperty(\"getClassInfo\")) throw new Error(\"NO\");\r\n\t\t\tif (!c.meta) {\r\n\t\t\t\tconsole.log(\"metanotfound\",c);\r\n\t\t\t\tthrow new Error(\"meta not found\");\r\n\t\t\t}\r\n\t\t\tchkmeta(c.meta,ctx);\r\n\t\t\treturn c;\r\n\t\t}\r\n\t\tfunction extender(parent,ctx) {\r\n\t\t\tvar isShim=!ctx.init;\r\n\t\t\tvar includesRec=ctx.includesRec;\r\n\t\t\tif (includesRec[fullName]) return parent;\r\n\t\t\tincludesRec[fullName]=true;\r\n\t\t\t//console.log(ctx.initFullName, fullName);//,  includesRec[fullName],JSON.stringify(ctx));\r\n\t\t\tincludes.forEach(function (m) {\r\n\t\t\t\tparent=m.extendFrom(parent,extend(ctx,{init:false}));\r\n\t\t\t});\r\n\t\t\tvar methods=typeof methodsF===\"function\"? methodsF(parent):methodsF;\r\n\t\t\t/*if (typeof Profiler!==\"undefined\") {\r\n\t\t\t\tProfiler.profile(methods, fullName);\r\n\t\t\t}*/\r\n\t\t\tvar init=methods.initialize;\r\n\t\t\tdelete methods.initialize;\r\n\t\t\tvar res;\r\n\t\t\tres=(init?\r\n\t\t\t\tfunction () {\r\n\t\t\t\t\tif (!(this instanceof res)) useNew(fullName);\r\n\t\t\t\t\tinit.apply(this,arguments);\r\n\t\t\t\t}:\r\n\t\t\t\t(parent? function () {\r\n\t\t\t\t\tif (!(this instanceof res)) useNew(fullName);\r\n\t\t\t\t\tparent.apply(this,arguments);\r\n\t\t\t\t}:function (){\r\n\t\t\t\t\tif (!(this instanceof res)) useNew(fullName);\r\n\t\t\t\t})\r\n\t\t\t);\r\n\t\t\tres.prototype=bless(parent,{constructor:res});\r\n\t\t\tif (isShim) {\r\n\t\t\t\tres.meta={isShim:true,extenderFullName:fullName};\r\n\t\t\t} else {\r\n\t\t\t\tres.meta=addMeta(fullName,{\r\n\t\t\t\t\tfullName:fullName,shortName:shortName,namespace:namespace,decls:decls,\r\n\t\t\t\t\tsuperclass:ctx.nonShimParent ? ctx.nonShimParent.meta : null,\r\n\t\t\t\t\tincludesRec:includesRec,\r\n\t\t\t\t\tincludes:includes.map(function(c){return c.meta;})\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tres.meta.func=res;\r\n\t\t\t// methods: res's own methods(no superclass/modules)\r\n\t\t\tres.methods=methods;\r\n\t\t\tvar prot=res.prototype;\r\n\t\t\tvar props={};\r\n\t\t\t//var propReg=klass.propReg;//^__([gs]et)ter__(.*)$/;\r\n\t\t\t//var k;\r\n\t\t\tfor (let k in methods) {\r\n\t\t\t\tif (k.match(/^fiber\\$/)) continue;\r\n\t\t\t\tprot[k]=methods[k];\r\n\t\t\t\tvar fbk=\"fiber$\"+k;\r\n\t\t\t\tif (methods[fbk]) {\r\n\t\t\t\t\tprot[fbk]=methods[fbk];\r\n\t\t\t\t\tprot[fbk].methodInfo=prot[fbk].methodInfo||{name:k,klass:res,fiber:true};\r\n\t\t\t\t\tprot[k].fiber=prot[fbk];\r\n\t\t\t\t}\r\n\t\t\t\tif (k!==\"__dummy\" && !prot[k]) {\r\n\t\t\t\t\tconsole.log(\"WHY!\",prot[k],prot,k);\r\n\t\t\t\t\tthrow new Error(\"WHY!\"+k);\r\n\t\t\t\t}\r\n\t\t\t\tprot[k].methodInfo=prot[k].methodInfo||{name:k,klass:res};\r\n\t\t\t\t// if profile...\r\n\t\t\t\tconst r=property.isPropertyMethod(k);\r\n\t\t\t\tif (r) {\r\n\t\t\t\t\tprops[r[2]]=1;\r\n\t\t\t\t\t// __(r[1]g/setter)__r[2]\r\n\t\t\t\t\t//props[r[2]]=props[r[2]]||{};\r\n\t\t\t\t\t//props[r[2]][r[1]]=prot[k];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tprot.isTonyuObject=true;\r\n\t\t\t//console.log(\"Prots1\",props);\r\n\t\t\tfor (let k of Object.keys(props)) {\r\n\t\t\t\tconst desc={};\r\n\t\t\t\tfor (let type of [\"get\", \"set\"]) {\r\n\t\t\t\t\tconst tter=prot[property.methodFor(type, k)];\r\n\t\t\t\t\tif (tter) {\r\n\t\t\t\t\t\tdesc[type]=tter;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t//console.log(\"Prots2\",k, desc);\r\n\t\t\t\tObject.defineProperty(prot, k , desc);\r\n\t\t\t}\r\n\t\t\tprot.getClassInfo=function () {\r\n\t\t\t\treturn res.meta;\r\n\t\t\t};\r\n\t\t\treturn chkclass(res,{isShim:isShim});\r\n\t\t}\r\n\t\tvar res=extender(parent,{\r\n\t\t\tinit:true,\r\n\t\t\tinitFullName:fullName,\r\n\t\t\tincludesRec:(parent?extend({},parent.meta.includesRec):{}),\r\n\t\t\tnonShimParent:parent\r\n\t\t});\r\n\t\tres.extendFrom=extender;\r\n\t\t//addMeta(fullName, res.meta);\r\n\t\tnso[shortName]=res;\r\n\t\touterRes=res;\r\n\t\t//console.log(\"defined\", fullName, Tonyu.classes,Tonyu.ID);\r\n\t\treturn chkclass(res,{isShim:false});\r\n\t};\r\n\tklass.isSourceChanged=function (k) {\r\n\t\tk=k.meta||k;\r\n\t\tif (k.src && k.src.tonyu) {\r\n\t\t\tif (!k.nodeTimestamp) return true;\r\n\t\t\treturn k.src.tonyu.lastUpdate()> k.nodeTimestamp;\r\n\t\t}\r\n\t\treturn false;\r\n\t};\r\n\tklass.shouldCompile=function (k) {\r\n\t\tk=k.meta||k;\r\n\t\tif (k.hasSemanticError) return true;\r\n\t\tif (klass.isSourceChanged(k)) return true;\r\n\t\tvar dks=klass.getDependingClasses(k);\r\n\t\tfor (var i=0 ; i<dks.length ;i++) {\r\n\t\t\tif (klass.shouldCompile(dks[i])) return true;\r\n\t\t}\r\n\t};\r\n\tklass.getDependingClasses=function (k) {\r\n\t\tk=k.meta||k;\r\n\t\tvar res=[];\r\n\t\tif (k.superclass) res=[k.superclass];\r\n\t\tif (k.includes) res=res.concat(k.includes);\r\n\t\treturn res;\r\n\t};\r\n\tfunction bless( klass, val) {\r\n\t\tif (!klass) return extend({},val);\r\n\t\treturn extend( Object.create(klass.prototype) , val);\r\n\t\t//return extend( new klass() , val);\r\n\t}\r\n\tfunction extend (dst, src) {\r\n\t\tif (src && typeof src==\"object\") {\r\n\t\t\tfor (var i in src) {\r\n\t\t\t\tdst[i]=src[i];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn dst;\r\n\t}\r\n\r\n\t//alert(\"init\");\r\n\tvar globals={};\r\n\tvar classes={};// classes.namespace.classname= function\r\n\tvar classMetas={}; // classes.namespace.classname.meta ( or env.classes / ctx.classes)\r\n\tfunction setGlobal(n,v) {\r\n\t\tglobals[n]=v;\r\n\t}\r\n\tfunction getGlobal(n) {\r\n\t\treturn globals[n];\r\n\t}\r\n\tfunction getClass(n) {\r\n\t\t//CFN: n.split(\".\")\r\n\t\tvar ns=n.split(\".\");\r\n\t\tvar res=classes;\r\n\t\tns.forEach(function (na) {\r\n\t\t\tif (!res) return;\r\n\t\t\tres=res[na];\r\n\t\t});\r\n\t\tif (!res && ns.length==1) {\r\n\t\t\tvar found;\r\n\t\t\tfor (var nn in classes) {\r\n\t\t\t\tvar nr=classes[nn][n];\r\n\t\t\t\tif (nr) {\r\n\t\t\t\t\tif (!res) { res=nr; found=nn+\".\"+n; }\r\n\t\t\t\t\telse throw new Error(R(\"ambiguousClassName\",nn,n,found));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn res;//classes[n];\r\n\t}\r\n\tfunction bindFunc(t,meth) {\r\n\t\tif (typeof meth!=\"function\") return meth;\r\n\t\tvar res=function () {\r\n\t\t\treturn meth.apply(t,arguments);\r\n\t\t};\r\n\t\tres.methodInfo=Tonyu.extend({thiz:t},meth.methodInfo||{});\r\n\t\tif (meth.fiber) {\r\n\t\t\tres.fiber=function fiber_func() {\r\n\t\t\t\treturn meth.fiber.apply(t,arguments);\r\n\t\t\t};\r\n\t\t\tres.fiber.methodInfo=Tonyu.extend({thiz:t},meth.fiber.methodInfo||{});\r\n\t\t}\r\n\t\treturn res;\r\n\t}\r\n\tfunction invokeMethod(t, name, args, objName) {\r\n\t\tif (!t) throw new Error(R(\"cannotInvokeMethod\",objName,t,name));\r\n\t\tvar f=t[name];\r\n\t\tif (typeof f!=\"function\") throw new Error(R(\"notAMethod\", (objName==\"this\"? \"\": objName+\".\"),name,f));\r\n\t\treturn f.apply(t,args);\r\n\t}\r\n\tfunction callFunc(f,args, fName) {\r\n\t\tif (typeof f!=\"function\") throw new Error(R(\"notAFunction\",fName));\r\n\t\treturn f.apply({},args);\r\n\t}\r\n\tfunction checkNonNull(v, name) {\r\n\t\tif (v!=v || v==null) throw new Error(R(\"uninitialized\",name,v));\r\n\t\treturn v;\r\n\t}\r\n\tfunction A(args) {\r\n\t\tvar res=[];\r\n\t\tfor (var i=1 ; i<args.length; i++) {\r\n\t\t\tres[i-1]=args[i];\r\n\t\t}\r\n\t\treturn res;\r\n\t}\r\n\tfunction useNew(c) {\r\n\t\tthrow new Error(R(\"newIsRequiredOnInstanciate\",c));\r\n\t}\r\n\tfunction not_a_tonyu_object(o) {\r\n\t\tconsole.log(\"Not a tonyu object: \",o);\r\n\t\tthrow new Error(o+\" is not a tonyu object\");\r\n\t}\r\n\tfunction hasKey(k, obj) {\r\n\t\treturn k in obj;\r\n\t}\r\n\tfunction run(bootClassName) {\r\n\t\tvar bootClass=getClass(bootClassName);\r\n\t\tif (!bootClass) throw new Error( R(\"bootClassIsNotFound\",bootClassName));\r\n\t\tTonyu.runMode=true;\r\n\t\tvar boot=new bootClass();\r\n\t\t//var th=thread();\r\n\t\t//th.apply(boot,\"main\");\r\n\t\tvar TPR=Tonyu.globals.$currentProject||Tonyu.currentProject;\r\n\t\tif (TPR) {\r\n\t\t\t//TPR.runningThread=th;\r\n\t\t\tTPR.runningObj=boot;\r\n\t\t}\r\n\t\t//$LASTPOS=0;\r\n\t\t//th.steps();\r\n\t}\r\n\tvar lastLoopCheck=root.performance.now();\r\n\tvar prevCheckLoopCalled;\r\n\tfunction checkLoop() {\r\n\t\tvar now=root.performance.now();\r\n\t\tif (now-lastLoopCheck>1000) {\r\n\t\t\tresetLoopCheck(10000);\r\n\t\t\tthrow new Error(R(\"infiniteLoopDetected\"));\r\n\t\t}\r\n\t\tprevCheckLoopCalled=now;\r\n\t}\r\n\tfunction resetLoopCheck(disableTime) {\r\n\t\tlastLoopCheck=root.performance.now()+(disableTime||0);\r\n\t}\r\n\tfunction is(obj,klass) {\r\n\t\tif (!obj) return false;\r\n\t\tif (obj instanceof klass) return true;\r\n\t\tif (typeof obj.getClassInfo===\"function\" && klass.meta) {\r\n\t\t\treturn obj.getClassInfo().includesRec[klass.meta.fullName];\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\t//setInterval(resetLoopCheck,16);\r\n\tTonyu={thread:thread, /*threadGroup:threadGroup,*/\r\n\t\t\tklass:klass, bless:bless, extend:extend,\r\n\t\t\tglobals:globals, classes:classes, classMetas:classMetas, setGlobal:setGlobal, getGlobal:getGlobal, getClass:getClass,\r\n\t\t\ttimeout:timeout,//animationFrame:animationFrame, /*asyncResult:asyncResult,*/\r\n\t\t\tbindFunc:bindFunc,not_a_tonyu_object:not_a_tonyu_object,is:is,\r\n\t\t\thasKey:hasKey,invokeMethod:invokeMethod, callFunc:callFunc,checkNonNull:checkNonNull,\r\n\t\t\titerator:IT,run:run,checkLoop:checkLoop,resetLoopCheck:resetLoopCheck,//DeferredUtil:DU,\r\n\t\t\tVERSION:1560828115159,//EMBED_VERSION\r\n\t\t\tA:A,ID:Math.random()};\r\n\tTT=TonyuThreadF(Tonyu);\r\n\tif (root.Tonyu) {\r\n\t\tconsole.error(\"Tonyu called twice!\");\r\n\t\tthrow new Error(\"Tonyu called twice!\");\r\n\t}\r\n\troot.Tonyu=Tonyu;\r\n\treturn Tonyu;\r\n}();\r\n\r\n},{\"../lib/R\":1,\"../lib/assert\":2,\"../lib/root\":3,\"./TonyuThread\":5,\"./tonyuIterator\":6}],5:[function(require,module,exports){\r\n//\tvar Klass=require(\"../lib/Klass\");\r\nconst R=require(\"../lib/R\");\r\nmodule.exports=function (Tonyu) {\r\n\tvar cnts={enterC:{},exitC:0};\r\n\tvar idSeq=1;\r\n\t//try {window.cnts=cnts;}catch(e){}\r\n\tclass TonyuThread {\r\n\t\tconstructor() {\r\n\t\t\tthis.frame=null;\r\n\t\t\tthis._isDead=false;\r\n\t\t\t//this._isAlive=true;\r\n\t\t\tthis.cnt=0;\r\n\t\t\tthis._isWaiting=false;\r\n\t\t\tthis.fSuspended=false;\r\n\t\t\tthis.tryStack=[];\r\n\t\t\tthis.preemptionTime=60;\r\n\t\t\tthis.onEndHandlers=[];\r\n\t\t\tthis.onTerminateHandlers=[];\r\n\t\t\tthis.id=idSeq++;\r\n\t\t\tthis.age=0; // inc if object pooled\r\n\t\t}\r\n\t\tisAlive() {\r\n\t\t\treturn !this.isDead();\r\n\t\t\t//return this.frame!=null && this._isAlive;\r\n\t\t}\r\n\t\tisDead() {\r\n\t\t\tthis._isDead=this._isDead || (this.frame==null) ||\r\n\t\t\t(this._threadGroup && (\r\n\t\t\t\t\tthis._threadGroup.objectPoolAge!=this.tGrpObjectPoolAge ||\r\n\t\t\t\t\tthis._threadGroup.isDeadThreadGroup()\r\n\t\t\t));\r\n\t\t\treturn this._isDead;\r\n\t\t}\r\n\t\tsetThreadGroup(g) {// g:TonyuThread\r\n\t\t\tthis._threadGroup=g;\r\n\t\t\tthis.tGrpObjectPoolAge=g.objectPoolAge;\r\n\t\t\t//if (g) g.add(fb);\r\n\t\t}\r\n\t\tisWaiting() {\r\n\t\t\treturn this._isWaiting;\r\n\t\t}\r\n\t\tsuspend() {\r\n\t\t\tthis.fSuspended=true;\r\n\t\t\tthis.cnt=0;\r\n\t\t}\r\n\t\tenter(frameFunc) {\r\n\t\t\t//var n=frameFunc.name;\r\n\t\t\t//cnts.enterC[n]=(cnts.enterC[n]||0)+1;\r\n\t\t\tthis.frame={prev:this.frame, func:frameFunc};\r\n\t\t}\r\n\t\tapply(obj, methodName, args) {\r\n\t\t\tif (!args) args=[];\r\n\t\t\tvar method;\r\n\t\t\tif (typeof methodName==\"string\") {\r\n\t\t\t\tmethod=obj[\"fiber$\"+methodName];\r\n\t\t\t\tif (!method) {\r\n\t\t\t\t\tthrow new Error(R(\"undefinedMethod\",methodName));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (typeof methodName==\"function\") {\r\n\t\t\t\tmethod=methodName.fiber;\r\n\t\t\t\tif (!method) {\r\n\t\t\t\t\tvar n=methodName.methodInfo ? methodName.methodInfo.name : methodName.name;\r\n\t\t\t\t\tthrow new Error(R(\"notAWaitableMethod\",n));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\targs=[this].concat(args);\r\n\t\t\tvar pc=0;\r\n\t\t\treturn this.enter(function (th) {\r\n\t\t\t\tswitch (pc){\r\n\t\t\t\tcase 0:\r\n\t\t\t\t\tmethod.apply(obj,args);\r\n\t\t\t\t\tpc=1;break;\r\n\t\t\t\tcase 1:\r\n\t\t\t\t\tth.termStatus=\"success\";\r\n\t\t\t\t\tth.notifyEnd(th.retVal);\r\n\t\t\t\t\targs[0].exit();\r\n\t\t\t\t\tpc=2;break;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\tnotifyEnd(r) {\r\n\t\t\tthis.onEndHandlers.forEach(function (e) {\r\n\t\t\t\te(r);\r\n\t\t\t});\r\n\t\t\tthis.notifyTermination({status:\"success\",value:r});\r\n\t\t}\r\n\t\tnotifyTermination(tst) {\r\n\t\t\tthis.onTerminateHandlers.forEach(function (e) {\r\n\t\t\t\te(tst);\r\n\t\t\t});\r\n\t\t}\r\n\t\ton(type,f) {\r\n\t\t\tif (type===\"end\"||type===\"success\") this.onEndHandlers.push(f);\r\n\t\t\tif (type===\"terminate\") {\r\n\t\t\t\tthis.onTerminateHandlers.push(f);\r\n\t\t\t\tif (this.handleEx) delete this.handleEx;\r\n\t\t\t}\r\n\t\t}\r\n\t\tpromise() {\r\n\t\t\tvar fb=this;\r\n\t\t\treturn new Promise(function (succ,err) {\r\n\t\t\t\tfb.on(\"terminate\",function (st) {\r\n\t\t\t\t\tif (st.status===\"success\") {\r\n\t\t\t\t\t\tsucc(st.value);\r\n\t\t\t\t\t} else if (st.status===\"exception\"){\r\n\t\t\t\t\t\terr(st.exception);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\terr(new Error(st.status));\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t\tthen(succ,err) {\r\n\t\t\tif (err) return this.promise().then(succ,err);\r\n\t\t\telse return this.promise().then(succ);\r\n\t\t}\r\n\t\tfail(err) {\r\n\t\t\treturn this.promise().then(e=>e, err);\r\n\t\t}\r\n\t\tgotoCatch(e) {\r\n\t\t\tvar fb=this;\r\n\t\t\tif (fb.tryStack.length==0) {\r\n\t\t\t\tfb.termStatus=\"exception\";\r\n\t\t\t\tfb.kill();\r\n\t\t\t\tif (fb.handleEx) fb.handleEx(e);\r\n\t\t\t\telse fb.notifyTermination({status:\"exception\",exception:e});\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tfb.lastEx=e;\r\n\t\t\tvar s=fb.tryStack.pop();\r\n\t\t\twhile (fb.frame) {\r\n\t\t\t\tif (s.frame===fb.frame) {\r\n\t\t\t\t\tfb.catchPC=s.catchPC;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tfb.frame=fb.frame.prev;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tstartCatch() {\r\n\t\t\tvar fb=this;\r\n\t\t\tvar e=fb.lastEx;\r\n\t\t\tfb.lastEx=null;\r\n\t\t\treturn e;\r\n\t\t}\r\n\t\texit(res) {\r\n\t\t\t//cnts.exitC++;\r\n\t\t\tthis.frame=(this.frame ? this.frame.prev:null);\r\n\t\t\tthis.retVal=res;\r\n\t\t}\r\n\t\tenterTry(catchPC) {\r\n\t\t\tvar fb=this;\r\n\t\t\tfb.tryStack.push({frame:fb.frame,catchPC:catchPC});\r\n\t\t}\r\n\t\texitTry() {\r\n\t\t\tvar fb=this;\r\n\t\t\tfb.tryStack.pop();\r\n\t\t}\r\n\t\twaitEvent(obj,eventSpec) { // eventSpec=[EventType, arg1, arg2....]\r\n\t\t\tvar fb=this;\r\n\t\t\tfb.suspend();\r\n\t\t\tif (!obj.on) return;\r\n\t\t\tvar h;\r\n\t\t\teventSpec=eventSpec.concat(function () {\r\n\t\t\t\tfb.lastEvent=arguments;\r\n\t\t\t\tfb.retVal=arguments[0];\r\n\t\t\t\th.remove();\r\n\t\t\t\tfb.steps();\r\n\t\t\t});\r\n\t\t\th=obj.on.apply(obj, eventSpec);\r\n\t\t}\r\n\t\trunAsync(f) {\r\n\t\t\tvar fb=this;\r\n\t\t\tvar succ=function () {\r\n\t\t\t\tfb.retVal=arguments;\r\n\t\t\t\tfb.steps();\r\n\t\t\t};\r\n\t\t\tvar err=function () {\r\n\t\t\t\tvar msg=\"\";\r\n\t\t\t\tfor (var i=0; i<arguments.length; i++) {\r\n\t\t\t\t\tmsg+=arguments[i]+\",\";\r\n\t\t\t\t}\r\n\t\t\t\tif (msg.length==0) msg=\"Async fail\";\r\n\t\t\t\tvar e=new Error(msg);\r\n\t\t\t\te.args=arguments;\r\n\t\t\t\tfb.gotoCatch(e);\r\n\t\t\t\tfb.steps();\r\n\t\t\t};\r\n\t\t\tfb.suspend();\r\n\t\t\tsetTimeout(function () {\r\n\t\t\t\tf(succ,err);\r\n\t\t\t},0);\r\n\t\t}\r\n\t\twaitFor(j) {\r\n\t\t\tvar fb=this;\r\n\t\t\tfb._isWaiting=true;\r\n\t\t\tfb.suspend();\r\n\t\t\tif (j instanceof TonyuThread) j=j.promise();\r\n\t\t\treturn Promise.resolve(j).then(function (r) {\r\n\t\t\t\tfb.retVal=r;\r\n\t\t\t\tfb.stepsLoop();\r\n\t\t\t}).then(e=>e,function (e) {\r\n\t\t\t\tfb.gotoCatch(fb.wrapError(e));\r\n\t\t\t\tfb.stepsLoop();\r\n\t\t\t});\r\n\t\t}\r\n\t\twrapError(e) {\r\n\t\t\tif (e instanceof Error) return e;\r\n\t\t\tvar re=new Error(e);\r\n\t\t\tre.original=e;\r\n\t\t\treturn re;\r\n\t\t}\r\n\t\tresume(retVal) {\r\n\t\t\tthis.retVal=retVal;\r\n\t\t\tthis.steps();\r\n\t\t}\r\n\t\tsteps() {\r\n\t\t\tvar fb=this;\r\n\t\t\tif (fb.isDead()) return;\r\n\t\t\tvar sv=Tonyu.currentThread;\r\n\t\t\tTonyu.currentThread=fb;\r\n\t\t\tfb.cnt=fb.preemptionTime;\r\n\t\t\tfb.preempted=false;\r\n\t\t\tfb.fSuspended=false;\r\n\t\t\twhile (fb.cnt>0 && fb.frame) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\t//while (new Date().getTime()<lim) {\r\n\t\t\t\t\twhile (fb.cnt-->0 && fb.frame) {\r\n\t\t\t\t\t\tfb.frame.func(fb);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfb.preempted= (!fb.fSuspended) && fb.isAlive();\r\n\t\t\t\t} catch(e) {\r\n\t\t\t\t\tfb.gotoCatch(e);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tTonyu.currentThread=sv;\r\n\t\t}\r\n\t\tstepsLoop() {\r\n\t\t\tvar fb=this;\r\n\t\t\tfb.steps();\r\n\t\t\tif (fb.preempted) {\r\n\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t\tfb.stepsLoop();\r\n\t\t\t\t},0);\r\n\t\t\t}\r\n\t\t}\r\n\t\tkill() {\r\n\t\t\tvar fb=this;\r\n\t\t\t//fb._isAlive=false;\r\n\t\t\tfb._isDead=true;\r\n\t\t\tfb.frame=null;\r\n\t\t\tif (!fb.termStatus) {\r\n\t\t\t\tfb.termStatus=\"killed\";\r\n\t\t\t\tfb.notifyTermination({status:\"killed\"});\r\n\t\t\t}\r\n\t\t}\r\n\t\tclearFrame() {\r\n\t\t\tthis.frame=null;\r\n\t\t\tthis.tryStack=[];\r\n\t\t}\r\n\t}\r\n\treturn TonyuThread;\r\n};\r\n\r\n},{\"../lib/R\":1}],6:[function(require,module,exports){\r\n//define([\"Klass\"], function (Klass) {\r\n\t//var Klass=require(\"../lib/Klass\");\r\n\tconst SYMIT=typeof Symbol!==\"undefined\" && Symbol.iterator;\r\n\tclass ArrayValueIterator {\r\n\t\tconstructor(set) {\r\n\t\t\tthis.set=set;\r\n\t\t\tthis.i=0;\r\n\t\t}\r\n\t\tnext () {\r\n\t\t\tif (this.i>=this.set.length) return false;\r\n\t\t\tthis[0]=this.set[this.i];\r\n\t\t\tthis.i++;\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\tclass ArrayKeyValueIterator {\r\n\t\tconstructor(set) {\r\n\t\t\tthis.set=set;\r\n\t\t\tthis.i=0;\r\n\t\t}\r\n\t\tnext() {\r\n\t\t\tif (this.i>=this.set.length) return false;\r\n\t\t\tthis[0]=this.i;\r\n\t\t\tthis[1]=this.set[this.i];\r\n\t\t\tthis.i++;\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\tclass ObjectKeyIterator {\r\n\t\tconstructor(set) {\r\n\t\t\tthis.elems=[];\r\n\t\t\tfor (var k in set) {\r\n\t\t\t\tthis.elems.push(k);\r\n\t\t\t}\r\n\t\t\tthis.i=0;\r\n\t\t}\r\n\t\tnext() {\r\n\t\t\tif (this.i>=this.elems.length) return false;\r\n\t\t\tthis[0]=this.elems[this.i];\r\n\t\t\tthis.i++;\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\tclass ObjectKeyValueIterator{\r\n\t\tconstructor(set) {\r\n\t\t\tthis.elems=[];\r\n\t\t\tfor (var k in set) {\r\n\t\t\t\tthis.elems.push([k,set[k]]);\r\n\t\t\t}\r\n\t\t\tthis.i=0;\r\n\t\t}\r\n\t\tnext() {\r\n\t\t\tif (this.i>=this.elems.length) return false;\r\n\t\t\tthis[0]=this.elems[this.i][0];\r\n\t\t\tthis[1]=this.elems[this.i][1];\r\n\t\t\tthis.i++;\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\tclass NativeIteratorWrapper {\r\n\t\tconstructor(it) {\r\n\t\t\tthis.it=it;\r\n\t\t}\r\n\t\tnext() {\r\n\t\t\tconst {value,done}=this.it.next();\r\n\t\t\tif (done) return false;\r\n\t\t\tthis[0]=value;\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\tfunction IT(set, arity) {\r\n\t\tif (set && typeof set.tonyuIterator===\"function\") {\r\n\t\t\t// TODO: the prototype of class having tonyuIterator will iterate infinitively\r\n\t\t\treturn set.tonyuIterator(arity);\r\n\t\t} else if (set instanceof Array) {\r\n\t\t\tif (arity==1) {\r\n\t\t\t\treturn new ArrayValueIterator(set);\r\n\t\t\t} else {\r\n\t\t\t\treturn new ArrayKeyValueIterator(set);\r\n\t\t\t}\r\n\t\t} else if (set && typeof set[SYMIT]===\"function\") {\r\n\t\t\treturn new NativeIteratorWrapper(set[SYMIT]());\r\n\t\t} else if (set instanceof Object){\r\n\t\t\tif (arity==1) {\r\n\t\t\t\treturn new ObjectKeyIterator(set);\r\n\t\t\t} else {\r\n\t\t\t\treturn new ObjectKeyValueIterator(set);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tconsole.log(set);\r\n\t\t\tthrow new Error(set+\" is not iterable\");\r\n\t\t}\r\n\t}\r\n\tmodule.exports=IT;\r\n//   Tonyu.iterator=IT;\r\n//\treturn IT;\r\n//});\r\n\r\n},{}]},{},[4]);\r\n\ndefine(\"Tonyu\", (function (global) {\n    return function () {\n        var ret, fn;\n        return ret || global.Tonyu;\n    };\n}(this)));\n\ndefine('PatternParser',[\"Tonyu\"], function (Tonyu) {\r\n    var PP=function (img, options) {\r\n        this.options=options || {};\r\n        this.img=img;\r\n        this.height = img.height;\r\n        this.width = img.width;\r\n        var cv=this.newImage(img.width, img.height);\r\n        var ctx=cv.getContext(\"2d\");\r\n        ctx.drawImage(img, 0,0);\r\n        this.ctx=ctx;\r\n        this.pixels=this.ctx.getImageData(0, 0, img.width, img.height).data;\r\n        this.base=this.getPixel(0,0);\r\n    };\r\n    Tonyu.extend(PP.prototype,{\r\n        newImage: function (w,h) {\r\n            var cv=document.createElement(\"canvas\");\r\n            cv.width=w;\r\n            cv.height=h;\r\n            return cv;\r\n        },\r\n        getPixel: function (x,y) {\r\n            var imagePixelData = this.pixels;\r\n            var ofs=(x+y*this.width)*4;\r\n            var R = imagePixelData[0+ofs];\r\n            var G = imagePixelData[1+ofs];\r\n            var B = imagePixelData[2+ofs];\r\n            var A = imagePixelData[3+ofs];\r\n            return ((((A*256)+B)*256)+G)*256+R;\r\n        },\r\n        setPixel: function (x,y,p) {\r\n            var ofs=(x+y*this.width)*4;\r\n            this.pixels[0+ofs]=p & 255;\r\n            p=(p-(p&255))/256;\r\n            this.pixels[1+ofs]=p & 255;\r\n            p=(p-(p&255))/256;\r\n            this.pixels[2+ofs]=p & 255;\r\n            p=(p-(p&255))/256;\r\n            this.pixels[3+ofs]=p & 255;\r\n        },\r\n        parse: function () {\r\n            try {\r\n                //console.log(\"parse()\");\r\n                var res=[];// List of charpattern\r\n                for (var y=0; y<this.height ;y++) {\r\n                    for (var x=0; x<this.width ;x++) {\r\n                        var c=this.getPixel(x, y);\r\n                        if (c!=this.base) {\r\n                            res.push(this.parse1Pattern(x,y));\r\n                        }\r\n                    }\r\n                }\r\n                //console.log(\"parsed:\"+res.lenth);\r\n                return res;\r\n            } catch (p) {\r\n                if (p.isParseError) {\r\n                    console.log(\"parse error! \"+p);\r\n                    return [{image: this.img, x:0, y:0, width:this.width, height:this.height}];\r\n                }\r\n                throw p;\r\n            }\r\n        },\r\n        parse1Pattern:function (x,y) {\r\n            function hex(s){return s;}\r\n            var trans=this.getPixel(x, y);\r\n            var dx=x,dy=y;\r\n            var base=this.base;\r\n            var width=this.width, height=this.height;\r\n            while (dx<width) {\r\n                var pixel = this.getPixel(dx,dy);\r\n                if (pixel!=trans) break;\r\n                dx++;\r\n            }\r\n            if (dx>=width || this.getPixel(dx,dy)!=base) {\r\n                throw PatterParseError(dx,dy,hex(this.getPixel(dx,dy))+\"!=\"+hex(base));\r\n            }\r\n            dx--;\r\n            while (dy<height) {\r\n                if (this.getPixel(dx,dy)!=trans) break;\r\n                dy++;\r\n            }\r\n            if (dy>=height || this.getPixel(dx,dy)!=base) {\r\n                throw PatterParseError(dx,dy,hex(this.getPixel(dx,dy))+\"!=\"+hex(base));\r\n            }\r\n            dy--;\r\n            var sx=x+1,sy=y+1,w=dx-sx,h=dy-sy;\r\n            //console.log(\"PP\",sx,sy,w,h,dx,dy);\r\n            if (w*h==0) throw PatterParseError(dx, dy,\"w*h==0\");\r\n            var newim=this.newImage(w,h);\r\n            var nc=newim.getContext(\"2d\");\r\n            var newImD=nc.getImageData(0,0,w,h);\r\n            var newD=newImD.data;\r\n            var di=0;\r\n            for (var ey=sy ; ey<dy ; ey++) {\r\n                for (var ex=sx ; ex<dx ; ex++) {\r\n                    var p=this.getPixel(ex, ey);\r\n                    if (p==trans) {\r\n                        newD[di++]=0;\r\n                        newD[di++]=(0);\r\n                        newD[di++]=(0);\r\n                        newD[di++]=(0);\r\n                    } else {\r\n                        newD[di++]=(p&255);\r\n                        p=(p-(p&255))/256;\r\n                        newD[di++]=(p&255);\r\n                        p=(p-(p&255))/256;\r\n                        newD[di++]=(p&255);\r\n                        p=(p-(p&255))/256;\r\n                        newD[di++]=(p&255);\r\n                    }\r\n                }\r\n            }\r\n            nc.putImageData(newImD,0,0);\r\n            for (var yy=sy-1; yy<=dy; yy++) {\r\n                for (var xx=sx-1; xx<=dx; xx++) {\r\n                    this.setPixel(xx,yy, base);\r\n                }\r\n            }\r\n            if (this.options.boundsInSrc) {\r\n                return {x:sx,y:sy,width:w,height:h};\r\n            }\r\n            return {image:newim, x:0, y:0, width:w, height:h};\r\n            function PatterParseError(x,y,msg) {\r\n                return {toString: function () {\r\n                    return \"at (\"+x+\",\"+y+\") :\"+msg;\r\n                }, isParseError:true};\r\n            }\r\n        }\r\n\r\n    });\r\n    return PP;\r\n});\r\n\nUtil=(function () {\r\n\r\nfunction getQueryString(key, default_)\r\n{\r\n   if (default_==null) default_=\"\";\r\n   key = key.replace(/[\\[]/,\"\\\\\\[\").replace(/[\\]]/,\"\\\\\\]\");\r\n   var regex = new RegExp(\"[\\\\?&]\"+key+\"=([^&#]*)\");\r\n   var qs = regex.exec(window.location.href);\r\n   if(qs == null)\r\n    return default_;\r\n   else\r\n    return decodeURLComponentEx(qs[1]);\r\n}\r\nfunction decodeURLComponentEx(s){\r\n    return decodeURIComponent(s.replace(/\\+/g, '%20'));\r\n}\r\nfunction endsWith(str,postfix) {\r\n    return str.substring(str.length-postfix.length)===postfix;\r\n}\r\nfunction startsWith(str,prefix) {\r\n    return str.substring(0, prefix.length)===prefix;\r\n}\r\n// From http://hakuhin.jp/js/base64.html#BASE64_DECODE_ARRAY_BUFFER\r\nfunction Base64_To_ArrayBuffer(base64){\r\n    base64=base64.replace(/[\\n=]/g,\"\");\r\n    var dic = new Object();\r\n    dic[0x41]= 0; dic[0x42]= 1; dic[0x43]= 2; dic[0x44]= 3; dic[0x45]= 4; dic[0x46]= 5; dic[0x47]= 6; dic[0x48]= 7; dic[0x49]= 8; dic[0x4a]= 9; dic[0x4b]=10; dic[0x4c]=11; dic[0x4d]=12; dic[0x4e]=13; dic[0x4f]=14; dic[0x50]=15;\r\n    dic[0x51]=16; dic[0x52]=17; dic[0x53]=18; dic[0x54]=19; dic[0x55]=20; dic[0x56]=21; dic[0x57]=22; dic[0x58]=23; dic[0x59]=24; dic[0x5a]=25; dic[0x61]=26; dic[0x62]=27; dic[0x63]=28; dic[0x64]=29; dic[0x65]=30; dic[0x66]=31;\r\n    dic[0x67]=32; dic[0x68]=33; dic[0x69]=34; dic[0x6a]=35; dic[0x6b]=36; dic[0x6c]=37; dic[0x6d]=38; dic[0x6e]=39; dic[0x6f]=40; dic[0x70]=41; dic[0x71]=42; dic[0x72]=43; dic[0x73]=44; dic[0x74]=45; dic[0x75]=46; dic[0x76]=47;\r\n    dic[0x77]=48; dic[0x78]=49; dic[0x79]=50; dic[0x7a]=51; dic[0x30]=52; dic[0x31]=53; dic[0x32]=54; dic[0x33]=55; dic[0x34]=56; dic[0x35]=57; dic[0x36]=58; dic[0x37]=59; dic[0x38]=60; dic[0x39]=61; dic[0x2b]=62; dic[0x2f]=63;\r\n    var num = base64.length;\r\n    var n = 0;\r\n    var b = 0;\r\n    var e;\r\n\r\n    if(!num) return (new ArrayBuffer(0));\r\n    //if(num < 4) return null;\r\n    //if(num % 4) return null;\r\n\r\n    // AA     12    1\r\n    // AAA    18    2\r\n    // AAAA   24    3\r\n    // AAAAA  30    3\r\n    // AAAAAA 36    4\r\n    // num*6/8\r\n    e = Math.floor(num / 4 * 3);\r\n    if(base64.charAt(num - 1) == '=') e -= 1;\r\n    if(base64.charAt(num - 2) == '=') e -= 1;\r\n\r\n    var ary_buffer = new ArrayBuffer( e );\r\n    var ary_u8 = new Uint8Array( ary_buffer );\r\n    var i = 0;\r\n    var p = 0;\r\n    while(p < e){\r\n        b = dic[base64.charCodeAt(i)];\r\n        if(b === undefined) fail(\"Invalid letter: \"+base64.charCodeAt(i));//return null;\r\n        n = (b << 2);\r\n        i ++;\r\n\r\n        b = dic[base64.charCodeAt(i)];\r\n        if(b === undefined) fail(\"Invalid letter: \"+base64.charCodeAt(i))\r\n        ary_u8[p] = n | ((b >> 4) & 0x3);\r\n        n = (b & 0x0f) << 4;\r\n        i ++;\r\n        p ++;\r\n        if(p >= e) break;\r\n\r\n        b = dic[base64.charCodeAt(i)];\r\n        if(b === undefined) fail(\"Invalid letter: \"+base64.charCodeAt(i))\r\n        ary_u8[p] = n | ((b >> 2) & 0xf);\r\n        n = (b & 0x03) << 6;\r\n        i ++;\r\n        p ++;\r\n        if(p >= e) break;\r\n\r\n        b = dic[base64.charCodeAt(i)];\r\n        if(b === undefined) fail(\"Invalid letter: \"+base64.charCodeAt(i))\r\n        ary_u8[p] = n | b;\r\n        i ++;\r\n        p ++;\r\n    }\r\n    function fail(m) {\r\n        console.log(m);\r\n        console.log(base64,i);\r\n        throw new Error(m);\r\n    }\r\n    return ary_buffer;\r\n}\r\n\r\nfunction Base64_From_ArrayBuffer(ary_buffer){\r\n    var dic = [\r\n        'A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P',\r\n        'Q','R','S','T','U','V','W','X','Y','Z','a','b','c','d','e','f',\r\n        'g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','v',\r\n        'w','x','y','z','0','1','2','3','4','5','6','7','8','9','+','/'\r\n    ];\r\n    var base64 = \"\";\r\n    var ary_u8 = new Uint8Array( ary_buffer );\r\n    var num = ary_u8.length;\r\n    var n = 0;\r\n    var b = 0;\r\n\r\n    var i = 0;\r\n    while(i < num){\r\n        b = ary_u8[i];\r\n        base64 += dic[(b >> 2)];\r\n        n = (b & 0x03) << 4;\r\n        i ++;\r\n        if(i >= num) break;\r\n\r\n        b = ary_u8[i];\r\n        base64 += dic[n | (b >> 4)];\r\n        n = (b & 0x0f) << 2;\r\n        i ++;\r\n        if(i >= num) break;\r\n\r\n        b = ary_u8[i];\r\n        base64 += dic[n | (b >> 6)];\r\n        base64 += dic[(b & 0x3f)];\r\n        i ++;\r\n    }\r\n\r\n    var m = num % 3;\r\n    if(m){\r\n        base64 += dic[n];\r\n    }\r\n    if(m == 1){\r\n        base64 += \"==\";\r\n    }else if(m == 2){\r\n        base64 += \"=\";\r\n    }\r\n    return base64;\r\n}\r\n\r\nfunction privatize(o){\r\n    if (o.__privatized) return o;\r\n    var res={__privatized:true};\r\n    for (var n in o) {\r\n        (function (n) {\r\n            var m=o[n];\r\n            if (n.match(/^_/)) return;\r\n            if (typeof m!=\"function\") return;\r\n            res[n]=function () {\r\n                var r=m.apply(o,arguments);\r\n                return r;\r\n            };\r\n        })(n);\r\n    }\r\n    return res;\r\n}\r\nfunction hasNodeBuffer() {\r\n    return typeof Buffer!=\"undefined\";\r\n}\r\nfunction isNodeBuffer(data) {\r\n    return (hasNodeBuffer() && data instanceof Buffer);\r\n}\r\nfunction isBuffer(data) {\r\n    return data instanceof ArrayBuffer || isNodeBuffer(data);\r\n}\r\nfunction utf8bytes2str(bytes) {\r\n    var e=[];\r\n    for (var i=0 ; i<bytes.length ; i++) {\r\n         e.push(\"%\"+(\"0\"+bytes[i].toString(16)).slice(-2));\r\n    }\r\n    try {\r\n        return decodeURIComponent(e.join(\"\"));\r\n    } catch (er) {\r\n        console.log(e.join(\"\"));\r\n        throw er;\r\n    }\r\n}\r\nfunction str2utf8bytes(str, binType) {\r\n    var e=encodeURIComponent(str);\r\n    var r=/^%(..)/;\r\n    var a=[];\r\n    var ad=0;\r\n    for (var i=0 ; i<e.length; i++) {\r\n        var m=r.exec( e.substring(i));\r\n        if (m) {\r\n            a.push(parseInt(\"0x\"+m[1]));\r\n            i+=m[0].length-1;\r\n        } else a.push(e.charCodeAt(i));\r\n    }\r\n    return (typeof Buffer!=\"undefined\" && binType===Buffer ? new Buffer(a) : new Uint8Array(a).buffer);\r\n}\r\n\r\nreturn {\r\n    getQueryString:getQueryString,\r\n    endsWith: endsWith, startsWith: startsWith,\r\n    Base64_To_ArrayBuffer:Base64_To_ArrayBuffer,\r\n    Base64_From_ArrayBuffer:Base64_From_ArrayBuffer,\r\n    utf8bytes2str: utf8bytes2str,\r\n    str2utf8bytes: str2utf8bytes,\r\n    privatize: privatize,\r\n    hasNodeBuffer:hasNodeBuffer,\r\n    isNodeBuffer: isNodeBuffer,\r\n    isBuffer: isBuffer\r\n};\r\n})();\r\n\ndefine(\"Util\", (function (global) {\n    return function () {\n        var ret, fn;\n        return ret || global.Util;\n    };\n}(this)));\n\ndefine('Assets',[\"WebSite\",\"Util\",\"Tonyu\",\"FS\"],function (WebSite,Util,Tonyu,FS) {\r\n    var Assets={};\r\n    Assets.resolve=function (url, prj, options) {\r\n        options=options||{};\r\n        var baseDir=FS.isFile(prj)?prj:prj.getDir();\r\n        if (url==null) url=\"\";\r\n        url=url.replace(/\\$\\{([a-zA-Z0-9_]+)\\}/g, function (t,name) {\r\n            return WebSite[name];\r\n        });\r\n        if (WebSite.urlAliases[url]) url=WebSite.urlAliases[url];\r\n        if (Util.startsWith(url,\"ls:\")) {\r\n            var rel=url.substring(\"ls:\".length);\r\n            if (!baseDir) throw new Error(\"Basedir not specified\");\r\n            var f=baseDir.rel(rel);\r\n            if (!f.exists()) throw new Error(\"Resource file not found: \"+f);\r\n            if (\r\n                (WebSite.mp3Disabled && rel.match(/\\.(mp3)$/)) ||\r\n                (WebSite.mp4Disabled && rel.match(/\\.(mp4|m4a)$/))\r\n            ) {\r\n                var oggf=baseDir.rel(rel.replace(/\\.(mp3|mp4|m4a)$/,\".ogg\"));\r\n                if (oggf.exists()) {\r\n                    f=oggf;\r\n                }\r\n            }\r\n            url=f.getURL();\r\n            if (options.asFile) return f;\r\n        }\r\n        return url;\r\n    };\r\n    Tonyu.Assets=Assets;\r\n    return Assets;\r\n});\r\n\ndefine('assert',[\"FS\"],function (FS){return FS.assert;});\r\n\ndefine('urlTrailer',['require','exports','module','WebSite','Tonyu'],function (require, exports) {\r\n    const WebSite=require(\"WebSite\");\r\n    const Tonyu=require(\"Tonyu\");\r\n    Tonyu.urlTrailer=exports;\r\n    exports.put=function(url) {\r\n        if (!WebSite.tonyu_app_version) return url;\r\n        if (url.match(/^data:/)) return url;\r\n        const sep=url.match(/[&\\?]$/) ? \"\" : (url.match(/\\?/) ? \"&\" :\"?\");\r\n        return `${url}${sep}${WebSite.tonyu_app_version||\"\"}`;\r\n    };\r\n});\r\n\ndefine('ImageList',['require','exports','module','PatternParser','Assets','assert','urlTrailer'],function (require, exports, module) {\r\n    const PP=require(\"PatternParser\");\r\n    const Assets=require(\"Assets\");\r\n    const assert=require(\"assert\");\r\n    const urlTrailer=require(\"urlTrailer\");\r\n    var cache={};\r\n    function excludeEmpty(resImgs) {\r\n        var r=[];\r\n        resImgs.forEach(function (resImg) {\r\n            if (!resImg || resImg.url==\"\") return;\r\n            r.push(resImg);\r\n        });\r\n        return r;\r\n    }\r\n    var IL;\r\n    IL=function (resImgs, onLoad,options) {\r\n        //  resImgs:[{url: , [pwidth: , pheight:]?  }]\r\n\t    if (!options) options={};\r\n        resImgs=excludeEmpty(resImgs);\r\n        var resa=[];\r\n        var cnt=resImgs.length;\r\n        if (cnt==0) setTimeout(function () {\r\n            var res=[];\r\n            res.names={};\r\n            onLoad(res);\r\n        },0);\r\n        resImgs.forEach(function (resImg,i) {\r\n            console.log(\"loading\", resImg,i);\r\n            var url=resImg.url;\r\n            var urlKey=url;\r\n            if (cache[urlKey]) {\r\n            \tproc.apply(cache[urlKey],[]);\r\n            \treturn;\r\n            }\r\n            url=Assets.resolve(url,options.prj||options.baseDir);\r\n            //if (!Util.startsWith(url,\"data:\")) url+=\"?\" + new Date().getTime();\r\n            var im=$(\"<img>\");\r\n            im.load(function () {\r\n            \tcache[urlKey]=this;\r\n            \tproc.apply(this,[]);\r\n            });\r\n            im.attr(\"src\",urlTrailer.put(url));\r\n            function proc() {\r\n                var pw,ph;\r\n                if (resImg.type==\"single\") {\r\n                    resa[i]=[{image:this, x:0,y:0, width:this.width, height:this.height}];\r\n                } else if ((pw=resImg.pwidth) && (ph=resImg.pheight)) {\r\n                    var x=0, y=0, w=this.width, h=this.height;\r\n                    var r=[];\r\n                    while (true) {\r\n                        var rw=pw,rh=ph;\r\n                        if (x+pw>w) rw=w-x;\r\n                        if (y+ph>h) rh=h-y;\r\n                        r.push({image:this, x:x,y:y, width:rw, height:rh});\r\n                        x+=pw;\r\n                        if (x+pw>w) {\r\n                            x=0;\r\n                            y+=ph;\r\n                            if (y+ph>h) break;\r\n                        }\r\n                    }\r\n                    resa[i]=r;\r\n                } else {\r\n                    var p=new PP(this);\r\n                    resa[i]=p.parse();\r\n                }\r\n                resa[i].name=resImg.name;\r\n                assert.is(resa[i],Array);\r\n                cnt--;\r\n                if (cnt==0) {\r\n                    var res=[];\r\n                    var names={};\r\n                    resa.forEach(function (a) {\r\n                        names[a.name]=res.length;\r\n                        res=res.concat(a);\r\n                    });\r\n                    res.names=names;\r\n                    onLoad(res);\r\n                }\r\n            }\r\n        });\r\n    };\r\n    IL.load=IL;\r\n    IL.parse1=function (resImg, imgDOM, options) {\r\n        var pw,ph;\r\n        var res;\r\n        if ((pw=resImg.pwidth) && (ph=resImg.pheight)) {\r\n            var x=0, y=0, w=imgDOM.width, h=imgDOM.height;\r\n            var r=[];\r\n            while (true) {\r\n                r.push({image:this, x:x,y:y, width:pw, height:ph});\r\n                x+=pw;\r\n                if (x+pw>w) {\r\n                    x=0;\r\n                    y+=ph;\r\n                    if (y+ph>h) break;\r\n                }\r\n            }\r\n            res=r;\r\n        } else {\r\n            var p=new PP(imgDOM,options);\r\n            res=p.parse();\r\n        }\r\n        res.name=resImg.name;\r\n        return assert.is(res,Array);\r\n    };\r\n\twindow.ImageList=IL;\r\n    module.exports=IL;\r\n});\r\n\ndefine('ImageRect',[],function () {\r\n    function draw(img, canvas) {\r\n        if (typeof img==\"string\") {\r\n            var i=new Image();\r\n            var res=null;\r\n            var callback=null;\r\n            var onld=function (clb) {\r\n                if (clb) callback=clb;\r\n                if (callback && res) {\r\n                    callback(res);\r\n                }\r\n            };\r\n            i.onload=function () {\r\n                res=draw(i,canvas);\r\n                onld();\r\n            };\r\n            i.src=img;\r\n            return onld;\r\n        }\r\n        var cw=canvas.width;\r\n        var ch=canvas.height;\r\n        var cctx=canvas.getContext(\"2d\");\r\n        var width=img.width;\r\n        var height=img.height;\r\n        var calcw=ch/height*width; // calch=ch\r\n        var calch=cw/width*height; // calcw=cw\r\n        if (calch>ch) calch=ch;\r\n        if (calcw>cw) calcw=cw;\r\n        cctx.clearRect(0,0,cw,ch);\r\n        var marginw=Math.floor((cw-calcw)/2);\r\n        var marginh=Math.floor((ch-calch)/2);\r\n        cctx.drawImage(img,\r\n                0,0,width, height,\r\n                marginw,marginh,calcw, calch );\r\n        return {left: marginw, top:marginh, width:calcw, height:calch,src:img};\r\n    }\r\n    return draw;\r\n});\ndefine('thumbnail',[\"ImageRect\",\"root\",\"WebSite\"],function (IR,root,WebSite) {\r\n    var TN={};\r\n    //var createThumbnail;\r\n    var NAME=\"$icon_thumbnail\";\r\n    var WIDTH=200,HEIGHT=200;\r\n    TN.set=function (prj,delay) {\r\n        if (WebSite.surpressCreateThumbnail) return;\r\n        setTimeout(function () { crt(prj);} ,delay);\r\n    };\r\n    TN.get=function (prj) {\r\n        var f=TN.file(prj);\r\n        if (!f.exists()) return null;\r\n        return f.text();\r\n    };\r\n    TN.file=function (prj) {\r\n        var prjdir=prj.getDir();\r\n        var imfile= prjdir.rel(\"images/\").rel(\"icon_thumbnail.png\");\r\n        //console.log(\"Thumb file=\",imfile.path(),imfile.exists());\r\n        return imfile;\r\n    };\r\n    function crt(prj) {\r\n        try {\r\n            var img=root.Tonyu.globals.$Screen.buf[0];\r\n            var cv=$(\"<canvas>\").attr({width:WIDTH,height:HEIGHT});\r\n            IR(img, cv[0]);\r\n            var url=cv[0].toDataURL();\r\n            var rsrc=prj.getResource();\r\n            var prjdir=prj.getDir();\r\n            var imfile=TN.file(prj);\r\n            imfile.text( url );\r\n            var item={\r\n                name:NAME,\r\n                pwidth:WIDTH,pheight:HEIGHT,\r\n                url:\"ls:\"+imfile.relPath(prjdir)\r\n            };\r\n            var imgs=rsrc.images;\r\n            var add=false;\r\n            for (var i=0 ; i<imgs.length ; i++) {\r\n                if (imgs[i].name==NAME) {\r\n                    imgs[i]=item;\r\n                    add=true;\r\n                }\r\n            }\r\n            if (!add) imgs.push(item);\r\n\r\n            prj.setResource(rsrc);\r\n            console.log(\"setRSRC\",rsrc);\r\n        } catch (e) {\r\n            console.log(\"Create thumbnail failed\",e);\r\n            console.log(e.stack);\r\n        }\r\n    }\r\n    return TN;\r\n});\r\n\ndefine('DeferredUtil',[\"FS\"],function (FS){return FS.DeferredUtil;});\r\n\ndefine('R',['require','exports','module','root'],function (require,exports,module) {\r\n/*\r\n$(\".dropdown-menu a\");\r\n$(\".dropdown-toggle\");\r\n*/\r\n    const root=require(\"root\");\r\n    const ja={\r\n        \"socialEditor\": \"アプリ情報\",\r\n        \"title\": \"タイトル\",\r\n        \"importOption\":\"インポート設定\",\r\n        \"projectName\": \"プロジェクト名\",\r\n        \"whenPrjDirExists\": \"同一名プロジェクトが存在したとき\",\r\n        \"selectPolicy\": \"ユーザに選択させる\",\r\n        \"ApiInfo\": \"API設定\",\r\n        \"wsService\": \"使用サービス\",\r\n        \"wsKey\": \"APIキー\",\r\n        \"QuickUpload\": \"クイックアップロード\",\r\n        \"ClickToCompleteQuickUpload\": \"クイックアップロードを完了させる\",\r\n        \"reloadRequested\": \"依存関係に変更がありました．再読み込みが必要です．再読み込みを行いますか？\",\r\n        \"namespaceIsNotSet\": \"追加しようとしているプロジェクト'{1}'に名前空間が設定されていません．プロジェクト'{1}'を開いて，名前空間を設定してください．\",\r\n        \"namespaceIsSame\": \"追加しようとしているプロジェクト'{1}'の名前空間がこのプロジェクトと同じ'{2}'です．プロジェクト'{1}'を開いて，名前空間を変更してください．\",\r\n        \"alreadyHaveSameNamespace\": \"追加しようとしているプロジェクト'{1}'と同じ名前空間'{2}'のプロジェクトがすでに追加されています．\",\r\n        \"projectNotFound\": \"プロジェクト’{1}’は見つかりませんでした\",\r\n        \"addDependingProject\": \"参照するプロジェクトを追加\",\r\n        \"dependencyEditor\": \"ライブラリ管理\",\r\n        \"dependingProjects\": \"参照するプロジェクト\",\r\n        \"plugins\":\"プラグイン\",\r\n        \"depProejctPlaceholder\":\"プロジェクト名で検索\",\r\n        \"namespace\":\"名前空間\",\r\n        \"file\": \"ファイル\",\r\n        \"closeFile\": \"閉じる\",\r\n        \"removeFile\": \"削除\",\r\n        \"renameProject\": \"プロジェクト名を変更\",\r\n        \"removeProject\": \"このプロジェクト自身を削除\",\r\n        \"mapEditor2\": \"マップエディタ\",\r\n        \"mapEditor\": \"マップエディタ(旧)\",\r\n        \"searchFiles\": \"検索\",\r\n        \"imageList\": \"画像リスト\",\r\n        \"soundList\": \"音声リスト\",\r\n        \"projectOptions\": \"プロジェクト オプション\",\r\n        \"editorConfig\": \"エディタの設定\",\r\n        \"openFolder\": \"フォルダを開く\",\r\n        \"resetRunDialog\": \"実行ダイアログをリセット\",\r\n        \"exportAsHTML\": \"HTML生成\",\r\n        \"openHelpInThisWindow\": \"ヘルプ(この画面)\",\r\n        \"import\": \"インポート\",\r\n        \"tools\": \"ツール\",\r\n        \"window\":\"ウィンドウ\",\r\n        \"publish\": \"公開\",\r\n        \"help\": \"ヘルプ\",\r\n        \"openHelpWithNewTab\": \"ヘルプ(別ウィンドウ)\",\r\n        \"projects\": \"プロジェクト一覧\",\r\n        \"publisedProjects\": \"公開されているプロジェクト\",\r\n        \"WebSite\": \"Webサイト\",\r\n        \"showEditButton\": \"「Edit」ボタンを設置する(ブラウザ版で編集可能になります)\",\r\n        \"editorFontSize\": \"エディタの文字の大きさ\",\r\n        \"inputFileName\": \"ファイル名を入力してください\",\r\n        \"newFile\": \"新規作成\",\r\n        \"renameFile\": \"名前変更\",\r\n        \"refactorClassName\": \"プログラム中のクラス名も変更する\",\r\n        \"someFilesHaveErrorOnRefactor\": \"プログラム内にエラーがあります．エラーを修正するか，「プログラム中のクラス名も変更する」のチェックを外してもう一度やり直してください．\",\r\n        \"namingNotice\": \"名前は，半角英数字とアンダースコア(_)のみが使えます．先頭は英大文字にしてください．\",\r\n        \"autoReload\": \"自動再実行\",\r\n        \"stop\": \"停止(F2)\",\r\n        \"selectMain\": \"実行するファイルを選択...\",\r\n        \"createAtLeastOneFile\": \"ファイルを作成してください\",\r\n        \"inputNewProjectName\": \"新しいプロジェクトの名前を入れてください\",\r\n        \"unknown\": \"不明\",\r\n        \"jumpToErrorPosition\": \"エラー箇所に移動\",\r\n        \"error\": \"エラー\",\r\n        \"showTrace\": \"トレース表示\",\r\n        \"generateSingleHTML\": \"HTML生成\",\r\n        \"thisIsExecutableInSingleHTML\": \"このHTMLをcodepenなどのJS共有サイトに張り付けて実行できます．\",\r\n        \"runnableInIE11\": \"Internet Explorer 11でも動作させる（一部機能が使えない可能性があります）\",\r\n        \"globalVariables\": \"グローバル変数\",\r\n        \"theseGlobalVariablesAreInitializedOnStart\": \"実行時に，これらのグローバル変数が指定した値に初期化されます．\",\r\n        \"variablesShouldBeStringOrJSON\": \"「値」欄には文字列またはJSON形式で記入してください．\",\r\n        \"save\": \"保存\",\r\n        \"varableName\": \"グローバル変数名\",\r\n        \"value\": \"値\",\r\n        \"varableNameShouldBeAlphabetOrNumber\": \"変数名には半角英数字を使ってください\",\r\n        \"cannotBeParsedAsValue\": \"解釈できない値です．この値をそのまま文字列として登録したい場合，前後をダブルクォーテーションで囲ってください．\\n\",\r\n        \"ifYouWantContainDoubleQuoteAsTheValue\": \"ダブルクォーテーション自身を文字列に含める場合は \\\\\\\" と書いてください．\\n\",\r\n        \"ifYouWantContainBackslash\": \"\\\\自身を文字列に含める場合は \\\\\\\\ と書いてください．\\n\",\r\n        \"imageDetails\": \"画像詳細\",\r\n        \"singlePicture\": \"１枚絵\",\r\n        \"rowsAndColumns\": \"分割数指定：\",\r\n        \"chipWidthAndHeight\": \"1パターンの大きさ指定：\",\r\n        \"compatibleWithTonyu1\": \"Tonyu1互換\",\r\n        \"parse\": \"解析\",\r\n        \"chipNo\": \"パターン番号:\",\r\n        \"dragImageFilesHere\": \"ここに画像ファイル(png/gif/jpg)をドラッグ＆ドロップして追加\",\r\n        \"name\": \"名前\",\r\n        \"sizePerChip\": \"1個の大きさ\",\r\n        \"add\": \"追加\",\r\n        \"ok\": \"完了\",\r\n        \"importFromHTML\": \"HTMLからインポート\",\r\n        \"overwriteFolder\": \"フォルダを上書きする\",\r\n        \"selectOtherFolder\": \"他のフォルダを選択する\",\r\n        \"pasteHTMLHere\": \"ここにHTMLを貼り付けます\",\r\n        \"inputFolderPathForImport\": \"インポート先のフォルダを入力してください\",\r\n        \"startImport\": \"インポート開始\",\r\n        \"overwriteTheseFiles\": \"これらのファイルを上書きする\",\r\n        \"openTheProjectWithoutOverwrite\": \"上書きせずプロジェクトを開く\",\r\n        \"followingFilesWillBeOverwritten\": \"次のファイルは上書きされます\",\r\n        \"ovr\": \"上書\",\r\n        \"new\": \"新規\",\r\n        \"importComplete\": \"インポート完了\",\r\n        \"selectMainClass\": \"実行するクラスを選択\",\r\n        \"run\": \"実行\",\r\n        \"newProject\": \"新規プロジェクト\",\r\n        \"newProjectName\": \"プロジェクト名\",\r\n        \"parentFolder\": \"親フォルダ\",\r\n        \"willCreateAt\": \"作成先フォルダ：\",\r\n        \"inputProjectName\": \"名前を入力してください\",\r\n        \"folderExists\": \"このフォルダはすでに存在します\",\r\n        \"rename\": \"名前変更\",\r\n        \"downloadAsZip\": \"ZIPダウンロード\",\r\n        \"delete\": \"削除\",\r\n        \"deleteProject\": \"プロジェクトの削除\",\r\n        \"downloadAsZipBeforeDeletion\": \"削除前にZIPでダウンロードする\",\r\n        \"yes\": \"はい\",\r\n        \"no\": \"いいえ\",\r\n        \"compiler\": \"コンパイラ\",\r\n        \"diagMode\": \"診断モード(速度が落ちますが，プログラムの不具合を見つけやすくします)\",\r\n        \"disableInfiniteLoopCheck\": \"無限ループチェックをしない（チェックすると速度が速くなることがあります）\",\r\n        \"requireFieldDeclaration\": \"フィールド宣言を明示的に行う(var n; のような宣言が必要になります)\",\r\n        \"defaultSuperClass\": \"デフォルトの親クラス\",\r\n        \"runtimes\": \"実行\",\r\n        \"mainClass\": \"Main クラス\",\r\n        \"bootClass\": \"Boot クラス\",\r\n        \"edit\": \"編集...\",\r\n        \"done\": \"完了\",\r\n        \"thisFileCannotBeAdded\": \"このファイルは追加できません：\\n\",\r\n        \"resourceFileExists\": \"同じ名前のファイルが既に登録されています：\\n\",\r\n        \"image\": \"画像\",\r\n        \"sound\": \"音声\",\r\n        \"find\": \"検索\",\r\n        \"wordToFind\": \"検索語\",\r\n        \"showAllProjects\": \"すべて見る...\",\r\n        \"thisFolderShouldBeUploadedToWebServer\": \"このフォルダは、Webサーバにアップロードしないと正常に動作しない可能性があります。\\n\",\r\n        \"seeRuntime\": \"詳しくは\\nhttps://www.tonyu.jp/tonyu2/runtime.html\\nを御覧ください。\\n\",\r\n        \"createExecutable\": \"ランタイム作成\",\r\n        \"howToOutput\": \"出力方法\",\r\n        \"saveExecutableAsZip\": \"ZIP圧縮したものを保存する\",\r\n        \"uploadToProjectBoard\": \"プロジェクトボードにアップロードする\",\r\n        \"saveExecutableAtFolder\": \"次のフォルダに出力：\",\r\n        \"executableOptions\": \"オプション\",\r\n        \"RunInIE11\": \"Internet Explorer 11でも動作させる（一部機能が使えない可能性があります）\",\r\n        \"attachSourceFiles\": \"ソースを添付する\",\r\n        \"ifSourceFilesAreAttached\": \"ソースを添付すると，アップロードしたファイルを\",\r\n        \"ItCanBeEditableInProjectBoard\": \"プロジェクトボード上で直接編集できます．\",\r\n        \"youCanPublishThisExecutableAsWebApplicationBy\": \"次のいずれかの方法でWebアプリとして公開することができます。\",\r\n        \"uploadTheFolderIntoYourWebSite\": \"フォルダをお手持ちのWebサーバにアップロードする\",\r\n        \"uploadZippedFileInto\": \"上のフォルダをZIPで圧縮したものを\",\r\n        \"projectBoard\": \"プロジェクトボード\",\r\n        \"afterProjectBoard\": \"にアップロードする\",\r\n        \"executableCreated\": \"ランタイムを作成しました。\",\r\n        \"uploadTheExtractedFolderIntoYourWebSite\": \"解凍したフォルダをお手持ちのWebサーバにアップロードする\",\r\n        \"uploadTheZipFileInto\": \"保存したZIPファイルを\",\r\n        \"uploadHasNotBeenDoneYet\": \"まだアップロードは完了していません\",\r\n        \"youHaveToDescribeAboutThisVersion\": \"新規バージョンページ\",\r\n        \"toCompleteTheUpload\": \"に必要事項を記入して，アップロードを完了させてください\",\r\n        \"infiniteLoopDetected\": \"無限ループをストップしました。\\n\",\r\n        \"youCanConfigureAboutInfinteLoopDetection\": \"   プロジェクト オプションで無限ループチェックの有無を設定できます。\\n\",\r\n        \"seeProjectOption\": \"   [参考]https://edit.tonyu.jp/doc/options.html\\n\",\r\n        \"importingFromZip\": \"Zipからインポート中です...\",\r\n        \"importFromZip\": \"Zipからインポート\",\r\n        \"confirm\": \"確認\",\r\n        \"cancel\": \"キャンセル\",\r\n        \"input\": \"入力\",\r\n        \"fileExists\": \"ファイル{1}は存在します\",\r\n        \"fileExistsInOtherFolder\": \"ファイル{1}が他のフォルダに存在します\",\r\n        \"deleteFileConfirm\": \"{1}を削除しますか？\",\r\n        \"duplicatedFiles\": \"{1} ⇒ {2}({3}) と重複\\n\",\r\n        \"cannotUseFolderManagedByProject\":\"{1}はプロジェクトで管理されているフォルダなので，クラスを作成することはできません．\",\r\n        \"cannotUseKernelFiles\": \"{1}はシステムで利用されているフォルダなので使用できません\",\r\n        \"upCased\": \"先頭を大文字({1}) にして作成します．\",\r\n        \"resouceList\": \"{1}リスト\",\r\n        \"dragFileHere\": \"ここに{1}ファイル({2})をドラッグ＆ドロップして追加\",\r\n        \"storageUsage\": \"{1}KB中{2}KB使用中．\",\r\n        \"unzipping\": \"{1}を展開中...\",\r\n        \"doesNotContainTonyu2Project\": \"{1}にはTonyu2の編集可能なプロジェクトが含まれていません.\",\r\n        \"checking\": \"{1}をチェック中...\",\r\n        \"downloadFromProjectBoard\":\"プロジェクトボードから{1}をダウンロード....\",\r\n        \"copying\": \"{1}から{2}にコピー\",\r\n        \"runtimeCreatedAt\":\"ランタイムを作成しました：\",\r\n        \"uploadFailed\":\"アップロード失敗: {1}\",\r\n        \"duplicateGlobalVariable\": \"変数名'{1}'が重複しています．\",\r\n        \"invalidGlobalVariableName\": \"変数名'{1}'はグローバル変数名として使えません．\",\r\n        \"runClass\": \"{1}を実行\",\r\n        \"ThisFolderWillBeCreated\": \"このフォルダは新規作成されます．\",\r\n        \"pluginAddedAndRestart\":\"必要なプラグイン{1}を追加しました。もう一度実行してください\",\r\n        \"otherCommandInProgress\": \"他のコマンド({1})が実行されているのでお待ちください．\\n\"+\r\n            \"しばらくたってもこのメッセージが出る場合，一旦Homeに戻ってください．\",\r\n        \"deleteProjectConfirm\": \"{1}内のファイルをすべて削除しますか？削除する場合はDELETE と入力してください．\",\r\n        \"renamedProjectExists\": \"{1}はすでに存在します．\",\r\n        \"at\":\" 場所：\",\r\n        \"deleteProjectFromItem\":\"プロジェクト{1}を削除しますか？\",\r\n        \"destinationFolder\": \"フォルダ(省略可)\",\r\n        \"Open_URL\": \"別ウィンドウで開きます\",\r\n        \"UseRightClick\":\"※リンクが開かない場合、右クリックか長押しで新しいタブを開くか、URLをコピーしてください。\",\r\n        \"filenameMatched\": \"(ファイル名の一致)\",\r\n        \"noPushedPages\": \"loadPage()でページが正しく指定されていません。\",\r\n        \"noSuchPat\": \"キャラクタパターン用変数{1}は定義されていません。\",\r\n        \"invalidPatExpr\": \"キャラクタパターン{1}は存在しません。\",\r\n        \"openProjectInNewWindow\": \"別ウィンドウで開く\",\r\n    };\r\n    /*let buf=\"\";\r\n    for (let k of Object.keys(ja)) {\r\n        buf+=`\"${k}\" : \"${englishify(k)}\", //${ja[k]}\\n`;\r\n    }\r\n    console.log(buf);*/\r\n    const en={\r\n        \"reloadRequested\": \"Dependency changed. Reload?\",\r\n        \"namespaceIsNotSet\": \"No namespace is specified in project '{1}'. Open the project '{1}' and configure namespace.\",\r\n        \"namespaceIsSame\": \"The namespace of the project '{1}' is '{2}' which is same as this project. Open the project '{1}' and change the namespace\",\r\n        \"alreadyHaveSameNamespace\": \"Cannot add the project '{1}'. There is another project whose namespace is '{2}' in dependencies.\",\r\n        \"projectNotFound\": \"Project '{1}' did not found\",\r\n        //\"addDependingProject\": \"参照するプロジェクトを追加\",\r\n        //\"dependencyEditor\": \"ライブラリ管理\",\r\n        //\"dependingProjects\": \"参照するプロジェクト\",\r\n        //\"plugins\":\"プラグイン\",\r\n        \"depProejctPlaceholder\":\"Type project name\",\r\n        \"namespace\":\"namespace\",\r\n        \"file\" : \"File\", //ファイル\r\n        \"closeFile\" : \"Close File\", //閉じる\r\n        \"removeFile\" : \"Remove File\", //削除\r\n        \"renameProject\" : \"Rename Project\", //プロジェクト名を変更\r\n        \"removeProject\" : \"Remove Project\", //このプロジェクト自身を削除\r\n        \"mapEditor2\" : \"Map Editor\", //マップエディタ\r\n        \"mapEditor\" : \"Map Editor(old)\", //マップエディタ\r\n        \"searchFiles\" : \"Search Files\", //検索\r\n        \"imageList\" : \"Image List\", //画像リスト\r\n        \"soundList\" : \"Sound List\", //音声リスト\r\n        \"projectOptions\" : \"Project Options\", //プロジェクト オプション\r\n        \"editorConfig\" : \"Editor Config\", //エディタの設定\r\n        \"openFolder\" : \"Open Folder\", //フォルダを開く\r\n        \"resetRunDialog\" : \"Reset Run Dialog\", //実行ダイアログをリセット\r\n        \"exportAsHTML\" : \"Export as HTML\", //HTML生成\r\n        \"openHelpInThisWindow\" : \"Open Help in This Window\", //ヘルプ(この画面)\r\n        \"import\" : \"Import\", //インポート\r\n        \"tools\" : \"Tools\", //ツール\r\n        \"window\" : \"Window\", //ウィンドウ\r\n        \"publish\" : \"Publish\", //公開\r\n        \"help\" : \"Help\", //ヘルプ\r\n        \"openHelpWithNewTab\" : \"Open Help with New Tab\", //ヘルプ(別ウィンドウ)\r\n        \"projects\" : \"Projects\", //プロジェクト一覧\r\n        \"publisedProjects\" : \"Publised Projects\", //公開されているプロジェクト\r\n        \"WebSite\" : \" Web Site\", //Webサイト\r\n        \"showEditButton\" : \"Show Edit Button\", //「Edit」ボタンを設置する(ブラウザ版で編集可能になります)\r\n        \"editorFontSize\" : \"Editor Font Size\", //エディタの文字の大きさ\r\n        \"inputFileName\" : \"Input File Name\", //ファイル名を入力してください\r\n        \"newFile\" : \"New File\", //新規作成\r\n        \"renameFile\" : \"Rename File\", //名前変更\r\n        \"refactorClassName\" : \"Refactor Class Name\", //プログラム中のクラス名も変更する\r\n        \"someFilesHaveErrorOnRefactor\" : \"Error occured during Refactoring. Correct Error or uncheck 'Refactor Class Name'.\", //プログラム内にエラーがあります．エラーを修正するか，「プログラム中のクラス名も変更する」のチェックを外してもう一度やり直してください．\r\n        \"namingNotice\" : \"Alphabets, Numbers or Underscores can be used as a name.\", //名前は，半角英数字とアンダースコア(_)のみが使えます．先頭は英大文字にしてください．\r\n        \"autoReload\" : \"Auto Reload\", //自動再実行\r\n        \"stop\" : \"Stop\", //停止(F2)\r\n        \"selectMain\" : \"Select Main\", //実行するファイルを選択...\r\n        \"createAtLeastOneFile\" : \"Create at Least One File\", //ファイルを作成してください\r\n        \"inputNewProjectName\" : \"Input New Project Name\", //新しいプロジェクトの名前を入れてください\r\n        \"unknown\" : \"Unknown\", //不明\r\n        \"jumpToErrorPosition\" : \"Jump To Error Position\", //エラー箇所に移動\r\n        \"error\" : \"Error\", //エラー\r\n        \"showTrace\" : \"Show Trace\", //トレース表示\r\n        \"generateSingleHTML\" : \"Generate Single HTML\", //HTML生成\r\n        \"thisIsExecutableInSingleHTML\" : \"This is Executable in Single HTML, can be pasted to codepen.io\", //このHTMLをcodepenなどのJS共有サイトに張り付けて実行できます．\r\n        \"runnableInIE11\" : \"Runnable in IE11\", //Internet Explorer 11でも動作させる（一部機能が使えない可能性があります）\r\n        \"globalVariables\" : \"Global Variables\", //グローバル変数\r\n        \"theseGlobalVariablesAreInitializedOnStart\" : \"The following Global Variables are Initialized on Startup\", //実行時に，これらのグローバル変数が指定した値に初期化されます．\r\n        \"variablesShouldBeStringOrJSON\" : \"Variables Should be String or JSON\", //「値」欄には文字列またはJSON形式で記入してください．\r\n        \"save\" : \"Save\", //保存\r\n        \"varableName\" : \"Varable Name\", //グローバル変数名\r\n        \"value\" : \"Value\", //値\r\n        \"varableNameShouldBeAlphabetOrNumber\" : \"Variable Name Should be Alphabet or Number\", //変数名には半角英数字を使ってください\r\n        \"cannotBeParsedAsValue\" : \"Cannot be Parsed as a Value. If you meant this is a plain string, surround it with double quotes.\", //解釈できない値です．この値をそのまま文字列として登録したい場合，前後をダブルクォーテーションで囲ってください．\r\n\r\n        \"ifYouWantContainDoubleQuoteAsTheValue\" : \"If You Want Contain Double Quote as The Value, write as \\\\\\\" \", //ダブルクォーテーション自身を文字列に含める場合は \\\" と書いてください．\r\n\r\n        \"ifYouWantContainBackslash\" : \"If You Want Contain Backslash, write as \\\\\\\\\", //\\自身を文字列に含める場合は \\\\ と書いてください．\r\n\r\n        \"imageDetails\" : \"Image Details\", //画像詳細\r\n        \"singlePicture\" : \"Single Picture\", //１枚絵\r\n        \"rowsAndColumns\" : \"Rows And Columns\", //分割数指定：\r\n        \"chipWidthAndHeight\" : \"Chip Width And Height\", //1パターンの大きさ指定：\r\n        \"compatibleWithTonyu1\" : \"Compatible With Tonyu1\", //Tonyu1互換\r\n        \"parse\" : \"Parse\", //解析\r\n        \"chipNo\" : \"Chip No.\", //パターン番号:\r\n        \"dragImageFilesHere\" : \"Drag Image Files Here\", //ここに画像ファイル(png/gif/jpg)をドラッグ＆ドロップして追加\r\n        \"name\" : \"Name\", //名前\r\n        \"sizePerChip\" : \"Size Per Chip\", //1個の大きさ\r\n        \"add\" : \"Add\", //追加\r\n        \"ok\" : \"Ok\", //完了\r\n        \"importFromHTML\" : \"Import From HTML\", //HTMLからインポート\r\n        \"overwriteFolder\" : \"Overwrite Folder\", //フォルダを上書きする\r\n        \"selectOtherFolder\" : \"Select Other Folder\", //他のフォルダを選択する\r\n        \"pasteHTMLHere\" : \"Paste HTML Here\", //ここにHTMLを貼り付けます\r\n        \"inputFolderPathForImport\" : \"Input Folder Path For Import\", //インポート先のフォルダを入力してください\r\n        \"startImport\" : \"Start Import\", //インポート開始\r\n        \"overwriteTheseFiles\" : \"Overwrite These Files\", //これらのファイルを上書きする\r\n        \"openTheProjectWithoutOverwrite\" : \"Open The Project Without Overwrite\", //上書きせずプロジェクトを開く\r\n        \"followingFilesWillBeOverwritten\" : \"Following Files Will be Overwritten\", //次のファイルは上書きされます\r\n        \"ovr\" : \"Ovr\", //上書\r\n        \"new\" : \"New\", //新規\r\n        \"importComplete\" : \"Import Complete\", //インポート完了\r\n        \"selectMainClass\" : \"Select Main Class\", //実行するクラスを選択\r\n        \"run\" : \"Run\", //実行\r\n        \"newProject\" : \"New Project\", //新規プロジェクト\r\n        \"newProjectName\" : \"New Project Name\", //プロジェクト名\r\n        \"parentFolder\" : \"Parent Folder\", //親フォルダ\r\n        \"willCreateAt\" : \"The project will be created At: \", //作成先フォルダ：\r\n        \"inputProjectName\" : \"Input Project Name\", //名前を入力してください\r\n        \"folderExists\" : \"Folder Exists\", //このフォルダはすでに存在します\r\n        \"rename\" : \"Rename\", //名前変更\r\n        \"downloadAsZip\" : \"Download as Zip\", //ZIPダウンロード\r\n        \"delete\" : \"Delete\", //削除\r\n        \"deleteProject\" : \"Delete Project\", //プロジェクトの削除\r\n        \"downloadAsZipBeforeDeletion\" : \"Download as Zip Before Deletion\", //削除前にZIPでダウンロードする\r\n        \"yes\" : \"Yes\", //はい\r\n        \"no\" : \"No\", //いいえ\r\n        \"compiler\" : \"Compiler\", //コンパイラ\r\n        \"diagMode\" : \"Diagnostic Mode\", //診断モード(速度が落ちますが，プログラムの不具合を見つけやすくします)\r\n        \"disableInfiniteLoopCheck\" : \"Disable Infinite Loop Check(Sometimes faster)\", //無限ループチェックをしない（チェックすると速度が速くなることがあります）\r\n        \"requireFieldDeclaration\" : \"Require Explicit Field Declaration(such as var n; )\", //フィールド宣言を明示的に行う(var n; のような宣言が必要になります)\r\n        \"defaultSuperClass\" : \"Default Super Class\", //デフォルトの親クラス\r\n        \"runtimes\" : \"Runtimes\", //実行\r\n        \"mainClass\" : \"Main Class\", //Main クラス\r\n        \"bootClass\" : \"Boot Class\", //Boot クラス\r\n        \"edit\" : \"Edit\", //編集...\r\n        \"done\" : \"Done\", //完了\r\n        \"thisFileCannotBeAdded\" : \"This File cannot be Added\", //このファイルは追加できません：\r\n        \"resourceFileExists\" : \"Resource File with the name already Exists\", //同じ名前のファイルが既に登録されています：\r\n        \"image\" : \"Image\", //画像\r\n        \"sound\" : \"Sound\", //音声\r\n        \"find\" : \"Find\", //検索\r\n        \"wordToFind\" : \"Word To Find\", //検索語\r\n        \"showAllProjects\" : \"Show All Projects\", //すべて見る...\r\n        \"thisFolderShouldBeUploadedToWebServer\" : \"This Folder Should be Uploaded To Web Server\", //このフォルダは、Webサーバにアップロードしないと正常に動作しない可能性があります。\r\n        \"seeRuntime\" : \"See https://www.tonyu.jp/tonyu2/runtime.html\", //詳しくは    https://www.tonyu.jp/tonyu2/runtime.html    を御覧ください。\r\n        \"createExecutable\" : \"Create Executable\", //ランタイム作成\r\n        \"howToOutput\" : \"How To Output\", //出力方法\r\n        \"saveExecutableAsZip\" : \"Save Executable as Zip\", //ZIP圧縮したものを保存する\r\n        \"uploadToProjectBoard\" : \"Upload To Project Board\", //プロジェクトボードにアップロードする\r\n        \"saveExecutableAtFolder\" : \"Save Executable at the following Folder:\", //次のフォルダに出力：\r\n        \"executableOptions\" : \"Executable Options\", //オプション\r\n        \"RunInIE11\" : \" Run in IE11 (Some features cannot be used)\", //Internet Explorer 11でも動作させる（一部機能が使えない可能性があります）\r\n        \"attachSourceFiles\" : \"Attach Source Files\", //ソースを添付する\r\n        \"ifSourceFilesAreAttached\" : \"If Source Files are Attached, \", //ソースを添付すると，アップロードしたファイルを\r\n        \"ItCanBeEditableInProjectBoard\" : \" It can be Editable in Project Board\", //プロジェクトボード上で直接編集できます．\r\n        \"youCanPublishThisExecutableAsWebApplicationBy\" : \"You can Publish This Executable as a Web Application by either ways:\", //次のいずれかの方法でWebアプリとして公開することができます。\r\n        \"uploadTheFolderIntoYourWebSite\" : \"Upload The Folder Into Your Web Site\", //フォルダをお手持ちのWebサーバにアップロードする\r\n        \"uploadZippedFileInto\" : \"Upload Zipped File Into \", //上のフォルダをZIPで圧縮したものを\r\n        \"projectBoard\" : \"Project Board\", //プロジェクトボード\r\n        \"afterProjectBoard\" : \".\", //にアップロードする\r\n        \"executableCreated\" : \"Executable Created\", //ランタイムを作成しました。\r\n        \"uploadTheExtractedFolderIntoYourWebSite\" : \"Upload The Extracted Folder Into Your Web Site\", //解凍したフォルダをお手持ちのWebサーバにアップロードする\r\n        \"uploadTheZipFileInto\" : \"Upload The Zip File Into\", //保存したZIPファイルを\r\n        \"uploadHasNotBeenDoneYet\" : \"Upload Has Not Been Done Yet\", //まだアップロードは完了していません\r\n        \"youHaveToDescribeAboutThisVersion\" : \"You Have To Describe About This Version\", //新規バージョンページ\r\n        \"toCompleteTheUpload\" : \"To Complete The Upload\", //に必要事項を記入して，アップロードを完了させてください\r\n        \"infiniteLoopDetected\" : \"Infinite Loop Detected. Aborted.\", //無限ループをストップしました。\r\n\r\n        \"youCanConfigureAboutInfinteLoopDetection\" : \"You can Configure About Infinte Loop Detection\", //   プロジェクト オプションで無限ループチェックの有無を設定できます。\r\n\r\n        \"seeProjectOption\" : \"See Project Option: https://edit.tonyu.jp/doc/options.html\", //   [参考]https://edit.tonyu.jp/doc/options.html\r\n\r\n        \"importingFromZip\" : \"Importing From Zip\", //Zipからインポート中です...\r\n        \"importFromZip\" : \"Import From Zip\", //Zipからインポート\r\n        \"confirm\" : \"Confirm\", //確認\r\n        \"cancel\" : \"Cancel\", //キャンセル\r\n        \"input\" : \"Input\", //入力\r\n        \"fileExists\" : \"File {1} already Exists\", //ファイル{1}は存在します\r\n        \"deleteFileConfirm\" : \"Delete File {1}?\", //{1}を削除しますか？\r\n        \"duplicatedFiles\" : \"Duplicated:{1}=>{2}({3})\", //{1} ⇒ {2}({3}) と重複\r\n        \"cannotUseFolderManagedByProject\":\"Cannot create class files in folder {1}, managed by the project.\",\r\n        \"cannotUseKernelFiles\" : \"Cannot Use name {1}, conflicting with Kernel Files\", //{1}はシステムで利用されているフォルダなので使用できません\r\n        \"upCased\" : \"The class name is automatically capitalized: {1}\", //先頭を大文字({1}) にして作成します．\r\n        \"ThisFolderWillBeCreated\": \"This folder will be created.\",\r\n        \"resouceList\" : \"{1} List\", //{1}リスト\r\n        \"dragFileHere\" : \"Drag {1} File({2}) Here\", //ここに{1}ファイル({2})をドラッグ＆ドロップして追加\r\n        \"storageUsage\" : \"Storage Usage: {2}/{1}KB\", //{1}KB中{2}KB使用中．\r\n        \"unzipping\" : \"Unzipping {1}\", //{1}を展開中...\r\n        \"doesNotContainTonyu2Project\" : \"{1} Does Not Contain Tonyu2 Project\", //{1}にはTonyu2の編集可能なプロジェクトが含まれていません.\r\n        \"checking\" : \"Checking {1}\", //{1}をチェック中...\r\n        \"downloadFromProjectBoard\" : \"Download {1} From Project Board\", //プロジェクトボードから{1}をダウンロード....\r\n        \"copying\" : \"Copying from {1} to {2}\", //{1}から{2}にコピー\r\n        \"runtimeCreatedAt\" : \"Executable Created at: \", //ランタイムを作成しました：\r\n        \"uploadFailed\" : \"Upload Failed: {1}\", //アップロード失敗: {1}\r\n        \"duplicateGlobalVariable\" : \"Duplicate Global Variable: {1}\", //変数名'{1}'が重複しています．\r\n        \"invalidGlobalVariableName\" : \"Invalid Global Variable Name: {1}\", //変数名'{1}'はグローバル変数名として使えません．\r\n        \"runClass\" : \"Run {1}\", //{1}を実行\r\n        \"pluginAddedAndRestart\" : \"Plugin {1} Added And Restart\", //必要なプラグイン{1}を追加しました。もう一度実行してください\r\n        \"otherCommandInProgress\" : \"Other {1} Command in Progress\", //他のコマンド({1})が実行されているのでお待ちください．しばらくたってもこのメッセージが出る場合，一旦Homeに戻ってください．\r\n        \"deleteProjectConfirm\" : \"Are you sure to Delete Project {1}? If so, type DELETE\", //{1}内のファイルをすべて削除しますか？削除する場合はDELETE と入力してください．\r\n        \"renamedProjectExists\" : \"Renamed Project {1} Exists\", //{1}はすでに存在します．\r\n        \"at\" : \"at:\", // 場所：\r\n        \"destinationFolder\": \"Folder(Optional)\",\r\n        \"deleteProjectFromItem\" : \"Delete Project {1}?\", //プロジェクト{1}を削除しますか？\r\n        \"Open_URL\": \"Opening New Window\",\r\n        \"UseRightClick\":\"If the link cannot works, use submenus by Right-Click or Long-Tap.\",\r\n        \"noPushedPages\": \"Invalid page class passed to loadPage()\",\r\n        \"noSuchPat\": \"No such variable: {1}\",\r\n        \"invalidPatExpr\": \"No such glyph(image) number: {1}\",\r\n    };\r\n    function loadLocale() {\r\n        try {\r\n            // localStorage may fails\r\n            return localStorage.locale || navigator.language;\r\n        } catch(e) {\r\n            return navigator.language;\r\n        }\r\n    }\r\n    let localeStr=loadLocale();\r\n    localeStr=localeStr.substring(0,2);\r\n    let dict=localeStr==\"en\"? en: ja;\r\n    //const test=x=>`【${x}】`;\r\n    function R(name,...params) {\r\n        let mesg=dict[name];\r\n        if (!mesg) {\r\n            return englishify(name)+(params.length?\": \"+params.join(\",\"):\"\");\r\n        }\r\n        return (buildMesg(mesg, ...params));\r\n    }\r\n    function englishify(name) {\r\n        name=name.replace(/([A-Z])/g,\" $1\");\r\n        name=name[0].toUpperCase()+name.substring(1);\r\n        return name;\r\n    }\r\n    function buildMesg() {\r\n        var a=Array.prototype.slice.call(arguments);\r\n        var format=a.shift();\r\n        if (a.length===1 && a[0] instanceof Array) a=a[0];\r\n        var P=\"vroijvowe0r324\";\r\n        format=format.replace(/\\{([0-9])\\}/g,P+\"$1\"+P);\r\n        format=format.replace(new RegExp(P+\"([0-9])\"+P,\"g\"),function (_,n) {\r\n            return a[parseInt(n)-1]+\"\";\r\n        });\r\n        return format;\r\n    }\r\n    R.renderMenu=()=>{\r\n        $(\"[data-r]\").each(function () {\r\n            const e=$(this);\r\n            e.text(R(e.attr(\"data-r\")));\r\n        });\r\n    };\r\n    if (typeof $===\"function\") {\r\n        $(R.renderMenu);\r\n    }\r\n    R.getLocale=()=>{\r\n        if (dict===en)return \"en\";\r\n        return \"ja\";\r\n    };\r\n    R.setLocale=locale=>{\r\n        localStorage.locale=locale;\r\n        dict=localStorage.locale==\"en\"? en: ja;\r\n        R.renderMenu();\r\n    };\r\n    root.R=R;\r\n    module.exports=R;\r\n});\r\n\ndefine('sysMod',[\"Tonyu\", \"FS\", \"ImageList\",\r\n        \"thumbnail\",\"WebSite\",\"plugins\",\r\n        \"DeferredUtil\",\"R\"],\r\n        function (Tonyu, FS, ImageList,\r\n                thumbnail,WebSite,plugins,\r\n                DU,R) {\r\n// (was TonyuProject)\r\nreturn {\r\n    /*stop:function () {\r\n        var cur=this.runningThread; // Tonyu.getGlobal(\"$currentThreadGroup\");\r\n        if (cur) cur.kill();\r\n        var main=this.runningObj;\r\n        if (main && main.stop) return main.stop();\r\n    },*/\r\n    rawRun:function (bootClassName) {\r\n        if (WebSite.removeJSOutput) {\r\n            var o=this.getOutputFile();\r\n            if (o.exists()) o.rm();\r\n        }\r\n        return this.loadClasses().then(()=>{\r\n            //TPR.compile();\r\n            this.detectPlugins();\r\n            this.fixBootRunClasses();\r\n            if (!this.runScriptMode) thumbnail.set(this, 2000);\r\n            this.rawBoot(bootClassName);\r\n        });\r\n    },\r\n    getResourceFile: function () {\r\n        return this.getDir().rel(\"res.json\");\r\n    },\r\n    getResource: function () {\r\n        var resFile=this.getResourceFile();\r\n        if (resFile.exists()) {\r\n            var res=resFile.obj();\r\n            var chg=false;\r\n            for (var imgSnd in res) {\r\n                var ary=res[imgSnd];\r\n                for (var i=ary.length-1; i>=0 ;i--) {\r\n                    if (!ary[i].url) {\r\n                        ary.splice(i,1);\r\n                        chg=true;\r\n                    }\r\n                }\r\n            }\r\n            if (chg) this.setResource(res);\r\n            return res;\r\n        }\r\n        return WebSite.defaultResource;\r\n    },\r\n    removeThumbnail: function () {\r\n        try {\r\n            const prj=this;\r\n            const dir=prj.getDir && prj.getDir();\r\n            const resc=prj.getResource();\r\n            if (resc.images) {\r\n                const cnt=resc.images.length;\r\n                resc.images=resc.images.filter(item=>{\r\n                    if (item.name!==\"$icon_thumbnail\") return true;\r\n                    if (item.url && item.url.match(/^ls:/)) {\r\n                        const tfile=dir.rel(item.url.substring(3));\r\n                        if (tfile.exists()) tfile.rm();\r\n                    }\r\n                    return false;\r\n                });\r\n                if (resc.images.length<cnt) prj.setResource(resc);\r\n            }\r\n        }catch(e) {\r\n            console.log(e);\r\n        }\r\n    },\r\n    hasSoundResource: function () {\r\n        var res=this.getResource();\r\n        return res && res.sounds && res.sounds.length>0;\r\n    },\r\n    setResource: function (rsrc) {\r\n        var resFile=this.getResourceFile();\r\n        resFile.obj(rsrc);\r\n    },\r\n    getThumbnail: function () {\r\n        return thumbnail.get(this);\r\n    },\r\n    convertBlobInfos: function (user) {\r\n        var rsrc=this.getResource();\r\n        var name=this.getName();\r\n        function loop(o) {\r\n            if (typeof o!=\"object\") return;\r\n            for (var k in o) {\r\n                if (!o.hasOwnProperty(k)) continue;\r\n                var v=o[k];\r\n                if (k==\"url\") {\r\n                    var a=Blob.isBlobURL(v);\r\n                    if (a) {\r\n                        o[k]=[Blob.BLOB_PATH_EXPR,user,name,a.fileName].join(\"/\");\r\n                    }\r\n                }\r\n                loop(v);\r\n            }\r\n        }\r\n        loop(rsrc);\r\n        this.setResource(rsrc);\r\n    },\r\n    getBlobInfos: function () {\r\n        var rsrc=this.getResource();\r\n        var res=[];\r\n        function loop(o) {\r\n            if (typeof o!=\"object\") return;\r\n            for (var k in o) {\r\n                if (!o.hasOwnProperty(k)) continue;\r\n                var v=o[k];\r\n                if (k==\"url\") {\r\n                    var a=Blob.isBlobURL(v);\r\n                    if (a) {\r\n                        res.push(a);\r\n                    }\r\n                }\r\n                loop(v);\r\n            }\r\n        }\r\n        loop(rsrc);\r\n        return res;\r\n    },\r\n    loadResource: function (next) {\r\n        var r=this.getResource();\r\n        ImageList( r.images, function (r) {\r\n            var sp=Tonyu.getGlobal(\"$Sprites\");\r\n            if (sp) {\r\n                //console.log(\"$Sprites set!\");\r\n                sp.setImageList(r);\r\n            }\r\n            //Sprites.setImageList(r);\r\n            for (var i in r.names) {\r\n                Tonyu.setGlobal(i, r.names[i]);\r\n            }\r\n            if (next) next();\r\n        });\r\n    },\r\n    detectPlugins: function () {\r\n        var opt=this.getOptions();\r\n        var plugins=opt.plugins=opt.plugins||{};\r\n        if (!plugins.Mezonet || !plugins.PicoAudio) {\r\n            var res=this.getResource();\r\n            var hasMZO=false,hasMIDI=false;\r\n            if (res.sounds) res.sounds.forEach(function (item) {\r\n                if (item.url.match(/\\.mzo/)) hasMZO=true;\r\n                if (item.url.match(/\\.midi?/)) hasMIDI=true;\r\n            });\r\n            if (hasMZO) this.addPlugin(\"Mezonet\");\r\n            else this.removePlugin(\"Mezonet\");\r\n            if (hasMIDI) this.addPlugin(\"PicoAudio\");\r\n            else this.removePlugin(\"PicoAudio\");\r\n        }\r\n    },\r\n    addPlugin: function (name) {\r\n        var opt=this.getOptions();\r\n        opt.plugins=opt.plugins||{};\r\n        if (!opt.plugins[name]) {\r\n            opt.plugins[name]=1;\r\n            this.setOptions(opt);\r\n        }\r\n    },\r\n    removePlugin: function (name) {\r\n        var opt=this.getOptions();\r\n        if (opt.plugins[name]) {\r\n            delete opt.plugins[name];\r\n            this.setOptions(opt);\r\n        }\r\n    },\r\n    requestPlugin: function (name) {\r\n        this.addPlugin(name);\r\n        if (plugins.loaded(name)) return;\r\n        var req=new Error(R(\"pluginAddedAndRestart\",name));\r\n        req.pluginName=name;\r\n        throw req;\r\n    },\r\n    loadPlugins: function (onload) {\r\n        var opt=this.getOptions();\r\n        return plugins.loadAll(opt.plugins,onload);\r\n    },\r\n    fixBootRunClasses: function () {\r\n        var opt=this.getOptions();\r\n        if (opt.run) {\r\n            var mc=this.fixClassName(opt.run.mainClass);\r\n            var bc=this.fixClassName(opt.run.bootClass);\r\n            if (mc!=opt.run.mainClass  ||  bc!=opt.run.bootClass) {\r\n                opt.run.mainClass=mc;\r\n                opt.run.bootClass=bc;\r\n                this.setOptions(opt);\r\n            }\r\n        }\r\n    },\r\n    fixClassName: function (className) {\r\n        if (Tonyu.classMetas[className]) return className;\r\n        const ns=this.getNamespace();\r\n        console.log(\"NS\", ns);\r\n        let res=Tonyu.classes[ns][className];\r\n        if (res) return `${ns}.${className}`;\r\n        for (var k in Tonyu.classes) {\r\n            res=Tonyu.classes[k][className];\r\n            if (res) return `${k}.${className}`;\r\n        }\r\n        throw new Error(`Cannot fix className ${className}`);\r\n    },\r\n    rawBoot: function (bootClassName) {\r\n        this.showProgress(\"Running \"+bootClassName);\r\n        this.initCanvas();\r\n        Tonyu.run(bootClassName);\r\n    },\r\n    initCanvas: function () {\r\n        Tonyu.globals.$mainCanvas=$(\"canvas\");\r\n    },\r\n    /*isKernelEditable: function () {\r\n    \treturn env.options.kernelEditable;\r\n    },*/\r\n    //TPR.getDir=function () {return dir;};\r\n    //TPR.getName=function () { return dir.name().replace(/\\/$/,\"\"); };\r\n\r\n    showProgress: function (m) {\r\n        console.log(\"PROGRESS\",m);\r\n        /*global SplashScreen*/\r\n        if (typeof SplashScreen!=\"undefined\") {\r\n            SplashScreen.progress(m);\r\n        }\r\n        return DU.promise(function (succ) {\r\n            setTimeout(succ,0);\r\n        });\r\n    },\r\n    nonSourceDirs() {\r\n        return {images:1, sounds:1, js:1, files:1, static:1 ,maps:1};\r\n    },\r\n    sourceFiles() {\r\n        const res={};\r\n        const ext=this.getEXT();\r\n        const ns=this.nonSourceDirs();\r\n        for (let d of this.dir.listFiles()) {\r\n            if (d.isDir()) {\r\n                if (!ns[d.name().replace(/[\\/\\\\]$/,\"\")]) {\r\n                    d.recursive(collect);\r\n                }\r\n            } else {\r\n                collect(d);\r\n            }\r\n        }\r\n    \tfunction collect(f) {\r\n    \t\tif (f.endsWith(ext)) {\r\n    \t\t\tvar nb=f.truncExt(ext);\r\n    \t\t\tres[nb]=f;\r\n    \t\t}\r\n    \t}\r\n    \treturn res;\r\n    }\r\n};\r\n});\r\n\ndefine('miniJSLoader',['require','exports','module','urlTrailer','WebSite'],function (require, exports) {\r\n    const urlTrailer=require(\"urlTrailer\");\r\n    const WebSite=require(\"WebSite\");\r\n    exports.load=url=>new Promise(succ=>{\r\n        const s=document.createElement(\"script\");\r\n        url=(WebSite.urlAliases && WebSite.urlAliases[url])||url;\r\n        s.setAttribute(\"src\",urlTrailer.put(url));\r\n        s.addEventListener(\"load\",succ);\r\n        document.body.appendChild(s);\r\n        // JQuery does not work\r\n        //$(\"<script>\").attr({src:url}).on(\"load\",succ).appendTo(\"body\");\r\n    });\r\n});//-----\r\n;\n// do not depend on ProjectFactory which is a part of BuilderClient4Sys\r\ndefine('compiledTonyuProject',[\"root\",\"plugins\",\"sysMod\",\"miniJSLoader\"],\r\nfunction (root, plugins,sysMod,JS) {\r\n    // used by runScript2\r\n    return function (dir) {\r\n        const res={\r\n            getDir:()=>dir,\r\n            resolve(rdir){return this.getDir().rel(rdir);},\r\n            getOptions(/*opt*/) {return this.getOptionsFile().obj();},\r\n            getOptionsFile() {return this.getDir().rel(\"options.json\");},\r\n            setOptions(opt) {return this.getOptionsFile().obj(opt);},\r\n            getOutputFile(/*lang*/) {\r\n                const ns=this.getNamespace();\r\n                return this.getDir().rel(`js/${ns}.js`);\r\n            },\r\n            getEXT:()=>\".tonyu\",\r\n            sourceFiles:()=>[],\r\n\t\t\tgetDependingProjects: ()=>[],\r\n\t\t\tasync loadClasses() {\r\n                const opt=this.getOptions();\r\n                // TODO Bitarrow kernel\r\n                for (let dep of [...opt.compiler.dependingProjects, {namespace:this.getNamespace()}]) {\r\n                    const ns=dep.namespace;\r\n                    await JS.load(`js/${ns}.js`);\r\n                }\r\n\t\t\t\t//await JS.load(WebSite.compiledKernel);\r\n\t\t\t},\r\n\t\t\tgetNamespace() {\r\n\t\t\t\tvar opt=this.getOptions();\r\n\t\t\t\tif (opt.compiler && opt.compiler.namespace) return opt.compiler.namespace;\r\n\t\t\t\treturn \"user\";\r\n\t\t\t},\r\n\t\t\trequestPlugin:e=>e\r\n\t\t};\r\n        Object.assign(res,sysMod);\r\n        return res;\r\n    };\r\n});\r\n\ndefine('Shell',[\"FS\",\"assert\"],\r\n        function (FS,assert) {\r\n    var Shell={};\r\n    var PathUtil=assert(FS.PathUtil);\r\n    Shell.newCommand=function (name,func) {\r\n        this[name]=func;\r\n    };\r\n    Shell.cd=function (dir) {\r\n        Shell.cwd=resolve(dir,true);\r\n        return Shell.pwd();\r\n    };\r\n    Shell.vars=Object.create(FS.getEnv());\r\n    Shell.mount=function (options, path) {\r\n        //var r=resolve(path);\r\n        if (!options || !options.t) {\r\n            var fst=[];\r\n            for (var k in FS.getRootFS().availFSTypes()) {\r\n                fst.push(k);\r\n            }\r\n            sh.err(\"-t=(\"+fst.join(\"|\")+\") should be specified.\");\r\n            return;\r\n        }\r\n        FS.mount(path,options.t, options);\r\n    };\r\n    Shell.unmount=function (path) {\r\n        FS.unmount(path);\r\n    };\r\n    Shell.fstab=function () {\r\n        var rfs=FS.getRootFS();\r\n        var t=rfs.fstab();\r\n        var sh=this;\r\n        //sh.echo(rfs.fstype()+\"\\t\"+\"<Root>\");\r\n        t.forEach(function (fs) {\r\n            sh.echo(fs.fstype()+\"\\t\"+(fs.mountPoint||\"<Default>\"));\r\n        });\r\n    }\r\n    Shell.resolve=resolve;\r\n    function resolve(v, mustExist) {\r\n        var r=resolve2(v);\r\n        if (!FS.SFile.is(r)) {console.log(r,\" is not file\");}\r\n        if (mustExist && !r.exists()) throw new Error(r+\": no such file or directory\");\r\n        return r;\r\n    }\r\n    function resolve2(v) {\r\n        if (typeof v!=\"string\") return v;\r\n        var c=Shell.cwd;\r\n        if (PathUtil.isAbsolutePath(v)) return FS.resolve(v,c);\r\n        return c.rel(v);\r\n    }\r\n    Shell.pwd=function () {\r\n        return Shell.cwd+\"\";\r\n    };\r\n    Shell.ls=function (dir){\r\n    \tif (!dir) dir=Shell.cwd;\r\n    \telse dir=resolve(dir, true);\r\n        return dir.ls();\r\n    };\r\n    Shell.cp=function (from ,to ,options) {\r\n        if (!options) options={};\r\n        if (options.v) {\r\n            Shell.echo(\"cp\", from ,to);\r\n            options.echo=Shell.echo.bind(Shell);\r\n        }\r\n        var f=resolve(from, true);\r\n        var t=resolve(to);\r\n        return f.copyTo(t,options);\r\n    };\r\n    Shell.ln=function (to , from ,options) {\r\n        var f=resolve(from);\r\n        var t=resolve(to, true);\r\n        if (f.isDir() && f.exists()) {\r\n            f=f.rel(t.name());\r\n        }\r\n        if (f.exists()) {\r\n            throw new Error(f+\" exists\");\r\n        }\r\n        return f.link(t,options);\r\n    };\r\n    Shell.rm=function (file, options) {\r\n        if (!options) options={};\r\n        if (options.notrash) {\r\n            file=resolve(file, false);\r\n            file.removeWithoutTrash();\r\n            return 1;\r\n        }\r\n        file=resolve(file, true);\r\n        if (file.isDir() && options.r) {\r\n            var dir=file;\r\n            var sum=0;\r\n            dir.each(function (f) {\r\n                if (f.exists()) {\r\n                    sum+=Shell.rm(f, options);\r\n                }\r\n            });\r\n            dir.rm();\r\n            return sum+1;\r\n        } else {\r\n            file.rm();\r\n            return 1;\r\n        }\r\n    };\r\n    Shell.mkdir=function (file,options) {\r\n        file=resolve(file, false);\r\n        if (file.exists()) throw new Error(file+\" : exists\");\r\n        return file.mkdir();\r\n\r\n    };\r\n    Shell.cat=function (file,options) {\r\n        file=resolve(file, true);\r\n        return Shell.echo(file.getContent(function (c) {\r\n            if (file.isText()) {\r\n                return c.toPlainText();\r\n            } else {\r\n                return c.toURL();\r\n            }\r\n        }));\r\n    };\r\n    Shell.resolve=function (file) {\r\n        if (!file) file=\".\";\r\n        file=resolve(file);\r\n        return file;\r\n    };\r\n    Shell.grep=function (pattern, file, options) {\r\n        file=resolve(file, true);\r\n        if (!options) options={};\r\n        if (!options.res) options.res=[];\r\n        if (file.isDir()) {\r\n            file.each(function (e) {\r\n                Shell.grep(pattern, e, options);\r\n            });\r\n        } else {\r\n            if (typeof pattern==\"string\") {\r\n                file.lines().forEach(function (line, i) {\r\n                    if (line.indexOf(pattern)>=0) {\r\n                        report(file, i+1, line);\r\n                    }\r\n                });\r\n            }\r\n        }\r\n        return options.res;\r\n        function report(file, lineNo, line) {\r\n            if (options.res) {\r\n                options.res.push({file:file, lineNo:lineNo,line:line});\r\n            }\r\n            Shell.echo(file+\"(\"+lineNo+\"): \"+line);\r\n\r\n        }\r\n    };\r\n    Shell.touch=function (f) {\r\n    \tf=resolve(f);\r\n    \tf.text(f.exists() ? f.text() : \"\");\r\n    \treturn 1;\r\n    };\r\n    Shell.setout=function (ui) {\r\n        Shell.outUI=ui;\r\n    };\r\n    Shell.echo=function () {\r\n        return $.when.apply($,arguments).then(function () {\r\n            console.log.apply(console,arguments);\r\n            if (Shell.outUI && Shell.outUI.log) Shell.outUI.log.apply(Shell.outUI,arguments);\r\n        });\r\n    };\r\n    Shell.err=function (e) {\r\n        console.log.apply(console,arguments);\r\n        if (e && e.stack) console.log(e.stack);\r\n        if (Shell.outUI && Shell.outUI.err) Shell.outUI.err.apply(Shell.outUI,arguments);\r\n    };\r\n    Shell.clone= function () {\r\n        var r=Object.create(this);\r\n        r.vars=Object.create(this.vars);\r\n        return r;\r\n    };\r\n    Shell.getvar=function (k) {\r\n        return this.vars[k] || (process && process.env[k]);\r\n    };\r\n    Shell.get=Shell.getvar;\r\n    Shell.set=function (k,v) {\r\n        return this.vars[k]=v;\r\n    };\r\n    Shell.strcat=function () {\r\n        if (arguments.length==1) return arguments[0];\r\n        var s=\"\";\r\n        for (var i=0;i<arguments.length;i++) s+=arguments[i];\r\n        return s;\r\n    };\r\n    Shell.exists=function (f) {\r\n        f=this.resolve(f);\r\n        return f.exists();\r\n    };\r\n    Shell.dl=function (f) {\r\n        f=this.resolve(f||\".\");\r\n        return f.download();\r\n    };\r\n    Shell.zip=function () {\r\n        var t=this;\r\n        var a=Array.prototype.slice.call(arguments).map(function (e) {\r\n            if (typeof e===\"string\") return t.resolve(e);\r\n            return e;\r\n        });\r\n        return FS.zip.zip.apply(FS.zip,a);\r\n    };\r\n    Shell.unzip=function () {\r\n        var t=this;\r\n        var a=Array.prototype.slice.call(arguments).map(function (e) {\r\n            if (typeof e===\"string\") return t.resolve(e);\r\n            return e;\r\n        });\r\n        return FS.zip.unzip.apply(FS.zip,a);\r\n    };\r\n\r\n    Shell.prompt=function () {};\r\n    Shell.ASYNC={r:\"SH_ASYNC\"};\r\n    Shell.help=function () {\r\n        for (var k in Shell) {\r\n            var c=Shell[k];\r\n            if (typeof c==\"function\") {\r\n                Shell.echo(k+(c.description?\" - \"+c.description:\"\"));\r\n            }\r\n        }\r\n    };\r\n    if (!window.sh) window.sh=Shell;\r\n    if (typeof process==\"object\") {\r\n        sh.devtool=function () { require('nw.gui').Window.get().showDevTools();}\r\n        sh.cd(process.cwd().replace(/\\\\/g,\"/\"));\r\n    } else {\r\n        sh.cd(\"/\");\r\n    }\r\n    return Shell;\r\n});\r\n\n/*global webkitAudioContext, AudioContext, AudioBuffer, AudioBufferSourceNode, PicoAudio, Mezonet, WebSite, Util*/\r\n// forked from makkii_bcr's \"T2MediaLib\" http://jsdo.it/makkii_bcr/3ioQ\r\n\r\nvar T2MediaLib = (function(){\r\n    function isPicoAudio(bgm) {\r\n        return typeof PicoAudio!==\"undefined\" && bgm instanceof PicoAudio;\r\n    }\r\n    function isMezonetSource(bgm) {\r\n        return typeof Mezonet!==\"undefined\" && bgm instanceof Mezonet.Source;\r\n    }\r\n    function isAudioBufferSourceNode(bgm) {\r\n        // return bgm instanceof AudioBufferSourceNode || bgm instanceof WebKitAudioBufferSourceNode; // 本来はこの処理にしたい\r\n        // Safari 14でAudioBufferSourceNodeがWebKitAudioBufferSourceNodeに変更されたように、\r\n        // WebAPIの名前変更は予測できないので、消去方で判定する\r\n        return bgm != null && !(isPicoAudio(bgm) || isMezonetSource(bgm))\r\n    }\r\n    var T2MediaLib = function(_context) {\r\n        this.context = null;\r\n        this.picoAudio = null;\r\n        this.soundDataAry = []; // T2MediaLib_SoundData\r\n        this.bgmPlayerMax = 16;\r\n        this.bgmPlayerAry = []; // T2MediaLib_BGMPlayer\r\n\r\n        this.masterVolume = 1.0;\r\n        this.seMasterVolume = 1.0;\r\n        this.bgmMasterVolume = 1.0;\r\n\r\n        this.playingAudio = null;\r\n        this.audioVolume = 1.0;\r\n        this.audioTempo = 1.0;\r\n        this.audioDataAry = {\r\n            data : []\r\n        };\r\n        this.seSources=[];\r\n        this.init(_context);\r\n    };\r\n\r\n    // 初期化 //\r\n    T2MediaLib.prototype.init = function(_context) {\r\n        if (this.inited) return;\r\n        this.inited=true;\r\n        if (this.disabled) return;\r\n        if (!_context) {\r\n            if (window.AudioContext) {\r\n                this.context = new AudioContext();\r\n            } else if (window.webkitAudioContext) {\r\n                this.context = new webkitAudioContext();\r\n            } else {\r\n                this.context = null;\r\n                console.log('Your browser does not support yet Web Audio API');\r\n            }\r\n        } else {\r\n            this.context = _context;\r\n        }\r\n\r\n        // Web Audio API 起動成功\r\n        if (this.context) {\r\n            // BGMPlayer初期化 (16個生成)\r\n            for (var i=0; i<this.bgmPlayerMax; i++) {\r\n                this.bgmPlayerAry[i] = new T2MediaLib_BGMPlayer(this, i);\r\n            }\r\n        }\r\n    };\r\n\r\n    // CLEAR系関数 //\r\n    T2MediaLib.prototype.allClearSoundData = function() {\r\n        var dataAry = this.soundDataAry;\r\n        for (var idx in dataAry) {\r\n            delete dataAry[idx];\r\n        }\r\n    };\r\n    T2MediaLib.prototype.clearSoundData = function(idx) {\r\n        var dataAry = this.soundDataAry;\r\n        delete dataAry[idx];\r\n    };\r\n    T2MediaLib.prototype.allRemoveDecodedSoundData = function() {\r\n        var dataAry = this.soundDataAry;\r\n        for (var idx in dataAry) {\r\n            var soundData = dataAry[idx];\r\n            if (soundData == null) continue;\r\n            if (!soundData.isDecodeComplete() && !soundData.isDecoding()) continue;\r\n            soundData.removeDecodedData();\r\n        }\r\n    };\r\n    T2MediaLib.prototype.removeDecodedSoundData = function(idx) {\r\n        var soundData = this.soundDataAry[idx];\r\n        if (soundData == null) return;\r\n        if (!soundData.isDecodeComplete() && !soundData.isDecoding()) return;\r\n        soundData.removeDecodedData();\r\n    };\r\n\r\n\r\n    // SE&BGMの音量 //\r\n    T2MediaLib.prototype.getMasterVolume = function() {\r\n        return this.masterVolume;\r\n    };\r\n    T2MediaLib.prototype.setMasterVolume = function(vol) {\r\n        this.masterVolume = vol;\r\n        for (var i=0; i<this.bgmPlayerMax; i++) {\r\n            var bgmPlayer = this.bgmPlayerAry[i];\r\n            if (!(bgmPlayer instanceof T2MediaLib_BGMPlayer)) continue;\r\n            bgmPlayer.onChangeBGMMasterVolume();\r\n        }\r\n    };\r\n\r\n    // 配列データからサウンドを作成・登録\r\n    T2MediaLib.prototype.createSoundFromArray = function(idx, array1, array2) {\r\n        if (!this.context || this.disabled) {\r\n            return null;\r\n        }\r\n        this.soundDataAry[idx] = new T2MediaLib_SoundData(idx);\r\n\r\n        var ctx = this.context;\r\n        var numOfChannels = array1 != null && array2 != null ? 2 : 1;\r\n        var audioBuffer = ctx.createBuffer(numOfChannels, array1.length, ctx.sampleRate);\r\n        var buffer1 = audioBuffer.getChannelData(0);\r\n        var buffer2 = array2 != null ? audioBuffer.getChannelData(1) : null;\r\n        var i;\r\n        for (i = 0; i < array1.length ; i++) {\r\n             buffer1[i] = array1[i];\r\n        }\r\n        if (buffer2) {\r\n            for (i = 0; i < array2.length ; i++) {\r\n                 buffer2[i] = array2[i];\r\n            }\r\n        }\r\n        this.soundDataAry[idx].onDecodeComplete(audioBuffer);\r\n    };\r\n    // サウンドの読み込み・登録\r\n    T2MediaLib.prototype.loadSound = function(idx, url, callbacks, isLoadAndDecode) { //@hoge1e3\r\n        if (!this.context || this.disabled) {\r\n            return null;\r\n        }\r\n\r\n        this.soundDataAry[idx] = new T2MediaLib_SoundData(idx);\r\n\r\n        // midiがあったらpicoAudioを準備しておく\r\n        if (url.match(/\\.(midi?)$/) || url.match(/^data:audio\\/mid/)) {\r\n            if (this.picoAudio == null) {\r\n                this.picoAudio = new PicoAudio({\r\n                    audioContext: this.context,\r\n                    isSkipBeginning: true,\r\n                    initReverb: 0\r\n                });\r\n            }\r\n        }\r\n        if (typeof WebSite==\"object\" && WebSite.mp3Disabled) {\r\n            url=url.replace(/\\.(mp3)$/,\".ogg\");\r\n        }\r\n        if (typeof WebSite==\"object\" && WebSite.mp4Disabled) {\r\n            url=url.replace(/\\.(mp4|m4a)$/,\".ogg\");\r\n        }\r\n        var that = this;\r\n        var xhr = new XMLHttpRequest();\r\n        xhr.onload = function() {\r\n            if (xhr.status === 200 || xhr.status === 0 /*@hoge1e3 for node-webkit base64url */) {\r\n                var arrayBuffer = xhr.response;\r\n                if (arrayBuffer instanceof ArrayBuffer) {\r\n                    that.soundDataAry[idx].onLoadComplete(arrayBuffer);\r\n                    if (isLoadAndDecode) { // ロードとデコードをする\r\n                        that.decodeSound(idx, callbacks);\r\n                    } else { // ロードのみ\r\n                        if (callbacks && callbacks.succ) callbacks.succ(idx);\r\n                    }\r\n                } else {\r\n                    that.soundDataAry[idx].onError(\"XHR_RESPONSE_ERROR\");\r\n                    if (callbacks && callbacks.err) callbacks.err(idx,that.soundDataAry[idx].errorID);\r\n                }\r\n            } else {\r\n                that.soundDataAry[idx].onError(\"XHR_STATUS_ERROR\");\r\n                if (callbacks && callbacks.err) callbacks.err(idx,that.soundDataAry[idx].errorID);\r\n            }\r\n        };\r\n        xhr.onerror=function (e) {\r\n            console.log(e+\"\");\r\n            that.soundDataAry[idx].onError(\"XHR_ERROR\");\r\n            if (callbacks && callbacks.err) callbacks.err(idx,that.soundDataAry[idx].errorID);\r\n        };\r\n\r\n        this.soundDataAry[idx].onLoad(url);\r\n        if (url.match(/^data:/) && typeof Util!==\"undefined\" && Util.Base64_To_ArrayBuffer) {//@hoge1e3\r\n            xhr={onload:xhr.onload};\r\n            xhr.response=Util.Base64_To_ArrayBuffer( url.replace(/^data:audio\\/[a-zA-Z0-9\\-]+;base64,/i,\"\"));\r\n            xhr.status=200;\r\n            xhr.onload();\r\n        } else {\r\n            try {\r\n                url=window.Tonyu.urlTrailer.put(url);\r\n            } catch (e){}\r\n            xhr.open('GET', url, true);\r\n            xhr.responseType = 'arraybuffer';\r\n            try {\r\n                xhr.send(null);\r\n            } catch(e) {\r\n                this.soundDataAry[idx].onError(\"FILE_NOT_FOUND\");\r\n                if (callbacks && callbacks.err) callbacks.err(idx,that.soundDataAry[idx].errorID);\r\n            }\r\n        }\r\n    };\r\n    // サウンドのデコード\r\n    T2MediaLib.prototype.decodeSound = function(idx, callbacks) {\r\n        var soundData = this.soundDataAry[idx];\r\n        if (soundData == null) return;\r\n        if (soundData.fileData == null) return;\r\n        if (!soundData.isLoadComplete()) return;\r\n        if (soundData.isDecodeComplete()) return;\r\n\r\n        // Adding Callback\r\n        if (soundData.decodedCallbacksAry == null) {\r\n            soundData.decodedCallbacksAry = []; // 複数コールバックを呼べるようにする\r\n        }\r\n        if (callbacks) {\r\n            if (callbacks.bgmPlayerId != null) { // 同じbgmPlayerIdのcallbacksがあれば上書きする(処理軽量化)\r\n                var exists = soundData.decodedCallbacksAry.some(function(c, i) {\r\n                    if (callbacks.bgmPlayerId == c.bgmPlayerId) {\r\n                        soundData.decodedCallbacksAry[i] = callbacks;\r\n                        return true;\r\n                    }\r\n                    return false;\r\n                });\r\n                if (!exists) {\r\n                    soundData.decodedCallbacksAry.push(callbacks);\r\n                }\r\n            } else {\r\n                soundData.decodedCallbacksAry.push(callbacks);\r\n            }\r\n        }\r\n\r\n        if (soundData.isDecoding()) return;\r\n        soundData.onDecode();\r\n        var arrayBuffer = soundData.fileData.slice(0);\r\n        var that = this;\r\n        if (soundData.url.match(/\\.(midi?)$/) || soundData.url.match(/^data:audio\\/mid/)) {\r\n            // Midi\r\n            // PicoAudio.jsにデコードしてもらう\r\n            if (this.picoAudio == null) {\r\n                this.picoAudio = new PicoAudio({\r\n                    audioContext: this.context,\r\n                    isSkipBeginning: true,\r\n                    initReverb: 0\r\n                });\r\n            }\r\n            var smf = new Uint8Array(arrayBuffer);\r\n            var data = this.picoAudio.parseSMF(smf);\r\n            if (typeof data == \"string\") { // parseSMF Error\r\n                console.log('T2MediaLib: Error parseSMF()', data);\r\n                this.soundDataAry[idx].onError(\"DECODE_ERROR\");\r\n                soundData.decodedCallbacksAry.forEach(function(callbacks) {\r\n                    if (typeof callbacks.err == \"function\") {\r\n                        callbacks.err(idx, this.soundDataAry[idx].errorID);\r\n                    }\r\n                });\r\n                soundData.decodedCallbacksAry = null;\r\n            } else {\r\n                this.soundDataAry[idx].onDecodeComplete(data);\r\n                soundData.decodedCallbacksAry.forEach(function(callbacks) {\r\n                    if (typeof callbacks.succ == \"function\") {\r\n                        callbacks.succ(idx);\r\n                    }\r\n                });\r\n                soundData.decodedCallbacksAry = null;\r\n            }\r\n        } else if (soundData.url.match(/\\.mzo$/) || soundData.url.match(/^data:audio\\/mzo/)) {\r\n            //console.log(\"Loading mzo\");\r\n            // MZO\r\n            Mezonet.init().then(function () {\r\n                var a=Array.prototype.slice.call( new Uint8Array(arrayBuffer) );\r\n                that.soundDataAry[idx].onDecodeComplete(new Mezonet.Source(a));\r\n                soundData.decodedCallbacksAry.forEach(function(callbacks) {\r\n                    if (typeof callbacks.succ == \"function\") {\r\n                        callbacks.succ(idx);\r\n                    }\r\n                });\r\n                soundData.decodedCallbacksAry = null;\r\n            },function (error) {\r\n                if (error instanceof Error) {\r\n                    console.log('T2MediaLib: '+error.message, soundData.url);//@hoge1e3\r\n                } else {\r\n                    console.log('T2MediaLib: Error decodeMZO()', soundData.url);//@hoge1e3\r\n                }\r\n                that.soundDataAry[idx].onError(\"DECODE_ERROR\");\r\n                soundData.decodedCallbacksAry.forEach(function(callbacks) {\r\n                    if (typeof callbacks.err == \"function\") {\r\n                        callbacks.err(idx, that.soundDataAry[idx].errorID);\r\n                    }\r\n                });\r\n                soundData.decodedCallbacksAry = null;\r\n            });\r\n            /*var m=new Mezonet(this.context,a);//,{wavOutSpeed:50});\r\n            //m.load(a);\r\n            m.init().then(function (res) {\r\n                // デコード中にremoveDecodeSoundData()したらデータを捨てる\r\n                switch(res.playbackMode.type) {\r\n                case \"Mezonet\":\r\n                that.soundDataAry[idx].onDecodeComplete(m);\r\n                break;\r\n                case \"AudioBuffer\":\r\n                //console.log(idx, res.decodedData);\r\n                that.soundDataAry[idx].onDecodeComplete(res.decodedData);\r\n                break;\r\n                }\r\n                soundData.decodedCallbacksAry.forEach(function(callbacks) {\r\n                    if (typeof callbacks.succ == \"function\") {\r\n                        callbacks.succ(idx);\r\n                    }\r\n                });\r\n                soundData.decodedCallbacksAry = null;\r\n            },function (error) {\r\n                if (error instanceof Error) {\r\n                    console.log('T2MediaLib: '+error.message, soundData.url);//@hoge1e3\r\n                } else {\r\n                    console.log('T2MediaLib: Error decodeMZO()', soundData.url);//@hoge1e3\r\n                }\r\n                that.soundDataAry[idx].onError(\"DECODE_ERROR\");\r\n                soundData.decodedCallbacksAry.forEach(function(callbacks) {\r\n                    if (typeof callbacks.err == \"function\") {\r\n                        callbacks.err(idx, that.soundDataAry[idx].errorID);\r\n                    }\r\n                });\r\n                soundData.decodedCallbacksAry = null;\r\n            }).finally(function () {\r\n                m.terminate();\r\n            });*/\r\n        } else {\r\n            // MP3, Ogg, AAC, WAV\r\n\r\n            // Oggループタグ(LOOPSTART, LOOPLENGTH)をファイルから探す\r\n            if (soundData.url.match(/\\.(ogg?)$/) || soundData.url.match(/^data:audio\\/ogg/)) {\r\n                var retAry = this.searchOggLoop(arrayBuffer);\r\n                soundData.tagLoopStart = retAry[0];\r\n                soundData.tagLoopEnd = retAry[1];\r\n            }\r\n\r\n            var successCallback = function(audioBuffer) {\r\n                // デコード中にremoveDecodeSoundData()したらデータを捨てる\r\n                if (that.soundDataAry[idx].isDecoding()) {\r\n                    that.soundDataAry[idx].onDecodeComplete(audioBuffer);\r\n                    soundData.decodedCallbacksAry.forEach(function(callbacks) {\r\n                        if (typeof callbacks.succ == \"function\") {\r\n                            callbacks.succ(idx);\r\n                        }\r\n                    });\r\n                    soundData.decodedCallbacksAry = null;\r\n                }\r\n            };\r\n            var errorCallback = function(error) {\r\n                if (error instanceof Error) {\r\n                    console.log('T2MediaLib: '+error.message, soundData.url);//@hoge1e3\r\n                } else {\r\n                    console.log('T2MediaLib: Error decodeAudioData()', soundData.url);//@hoge1e3\r\n                }\r\n                that.soundDataAry[idx].onError(\"DECODE_ERROR\");\r\n                soundData.decodedCallbacksAry.forEach(function(callbacks) {\r\n                    if (typeof callbacks.err == \"function\") {\r\n                        callbacks.err(idx, that.soundDataAry[idx].errorID);\r\n                    }\r\n                });\r\n                soundData.decodedCallbacksAry = null;\r\n            };\r\n            this.context.decodeAudioData(arrayBuffer, successCallback, errorCallback);\r\n        }\r\n    };\r\n    // 無音サウンドを鳴らしWeb Audio APIを使えるようにする(iOS対策)\r\n    // Chrome Autoplay Policy 対策\r\n    T2MediaLib.prototype.activate = function () {\r\n        this.init();\r\n        if (!this.context) return;\r\n        if (!this.isContextResumed && this.context.resume) { // fix Autoplay Policy in Chrome\r\n            var that = this;\r\n            this.context.resume().then(function () {\r\n                that.isContextResumed = true;\r\n            });\r\n        }\r\n        if (this.isActivated) return;\r\n        this.isActivated=true;\r\n        var buffer = this.context.createBuffer(1, Math.floor(this.context.sampleRate/32), this.context.sampleRate);\r\n        var ary = buffer.getChannelData(0);\r\n        for (var i = 0; i < ary.length; i++) {\r\n             ary[i] = 0; // 無音化\r\n        }\r\n        var source = this.context.createBufferSource();\r\n        source.buffer = buffer;\r\n        source.connect(this.context.destination);\r\n        source.start = source.start || source.noteOn;\r\n        source.start(0);\r\n    };\r\n    // 指定したサウンドのファイルデータを返す\r\n    T2MediaLib.prototype.getSoundFileData = function(idx) {\r\n        var soundDataObj = this.soundDataAry[idx];\r\n        if (soundDataObj) {\r\n            return soundDataObj.fileData;\r\n        } else {\r\n            return null;\r\n        }\r\n    };\r\n    // 指定したサウンドのデコード済みデータを返す\r\n    T2MediaLib.prototype.getSoundDecodedData = function(idx) {\r\n        var soundDataObj = this.soundDataAry[idx];\r\n        if (soundDataObj) {\r\n            return soundDataObj.decodedData;\r\n        } else {\r\n            return null;\r\n        }\r\n    };\r\n    // AudioContextのcurrentTimeを返す\r\n    T2MediaLib.prototype.getCurrentTime = function () {//@hoge1e3\r\n        if (!this.context) return null;\r\n        return this.context.currentTime;\r\n    };\r\n\r\n    // SEメソッド郡 //\r\n\r\n    T2MediaLib.prototype.playSE = function(idx, vol, pan, rate, offset, loop, loopStart, loopEnd,start,duration) {//add start,duration by @hoge1e3\r\n        if (!this.context) return null;\r\n        var soundData = this.soundDataAry[idx];\r\n        if (soundData == null) return null;\r\n        if (!soundData.isDecodeComplete()) {\r\n            var that = this;\r\n            var callbacks = {};\r\n            callbacks.succ = function(idx) {\r\n                that.playSE(idx, vol, pan, rate, offset, loop, loopStart, loopEnd,start,duration);//@hoge1e3\r\n            };\r\n            callbacks.err = function() {\r\n            };\r\n            this.decodeSound(idx, callbacks);\r\n            return null;\r\n        }\r\n        if (isMezonetSource(soundData.decodedData)) {\r\n            var playback=soundData.decodedData.playback(this.context);\r\n            playback.Start({volume:typeof vol===\"number\"?vol:1});\r\n            return playback;\r\n        }\r\n\r\n        var audioBuffer = soundData.decodedData;\r\n        if (!(audioBuffer instanceof AudioBuffer)) return null;\r\n\r\n        // 引数チェック\r\n        if (vol == null) {\r\n            vol = 1.0;\r\n        }\r\n        if (pan == null) {\r\n            pan = 0.0;\r\n        }\r\n        if (!rate) rate = 1.0;\r\n        if (!offset) {\r\n            offset = 0;\r\n        } else {\r\n            if      (offset > audioBuffer.duration) offset = audioBuffer.duration;\r\n            else if (offset < 0.0) offset = 0.0;\r\n        }\r\n        var durationStart = duration;\r\n        if (!duration) {\r\n            //duration=undefined; // iOS9でduration==undefinedだとsource.start(start, offset, duration);でエラー発生する\r\n            durationStart = 86400; // Number.MAX_SAFE_INTEGERを入れてもiOS9ではエラー起きないけど、昔なんかの環境で数値大き過ぎるとエラーになって86400(24時間)に設定した気がする\r\n        }\r\n        if (!loop) loop = false;\r\n        if (!loopStart) {\r\n            loopStart = soundData.loopStart||0.0;\r\n        } else {\r\n            if      (loopStart < 0.0) loopStart = 0.0;\r\n            else if (loopStart > audioBuffer.duration) loopStart = audioBuffer.duration;\r\n        }\r\n        if (!loopEnd) {\r\n            loopEnd = audioBuffer.duration;\r\n        } else {\r\n            if      (loopEnd < 0.0) loopEnd = 0.0;\r\n            else if (loopEnd > audioBuffer.duration) loopEnd = audioBuffer.duration;\r\n        }\r\n        start=start||0;//@hoge1e3\r\n\r\n        var source = this.context.createBufferSource();\r\n        this.context.createGain = this.context.createGain || this.context.createGainNode;\r\n        var gainNode = this.context.createGain();\r\n        var panNode = this.context.createPanner();\r\n\r\n        source.buffer = audioBuffer;\r\n        source.loop = loop;\r\n        source.loopStart = loopStart;\r\n        source.loopEnd = loopEnd;//audioBuffer.duration;\r\n        source.playbackRate.value = rate;\r\n\r\n        // 音量＆パン設定\r\n        source.connect(gainNode);\r\n        gainNode.connect(panNode);\r\n        panNode.connect(this.context.destination);\r\n        panNode.panningModel = \"equalpower\";\r\n        if      (pan < -1.0) pan = -1.0;\r\n        else if (pan >  1.0) pan =  1.0;\r\n        var panAngle = pan * 90;\r\n        var panX = Math.sin(panAngle * (Math.PI / 180));\r\n        var panZ = -Math.cos(panAngle * (Math.PI / 180));\r\n        if (pan === -1.0 || pan === 1.0) panZ = 0; // 6.123233995736766e-17となるので0にしておく\r\n        if (panNode.positionX) {\r\n            panNode.positionX.value = panX;\r\n            panNode.positionY.value = 0;\r\n            panNode.positionZ.value = panZ;\r\n        } else {\r\n            panNode.setPosition(panX, 0, panZ);\r\n        }\r\n        // 左右どちらかにパンがよると、音量が大きくなるので半減する\r\n        //gainNode.gain.value = vol / (1 + Math.abs(pan));\r\n        // ↑パンはそいうものらしいので、音量はそのままにする\r\n        gainNode.gain.value = vol * this.seMasterVolume * this.masterVolume;\r\n\r\n        // ループ開始位置修正\r\n        var offset_adj;\r\n        if (loop && loopEnd - loopStart > 0 && offset > loopEnd) {\r\n            offset_adj = loopEnd;\r\n        } else {\r\n            offset_adj = offset;\r\n        }\r\n\r\n        // 変数追加\r\n        source.gainNode = gainNode;\r\n        source.volumeValue = vol;\r\n        source.panNode = panNode;\r\n        source.panValue = pan;\r\n        source.playStartTime = this.context.currentTime+start;//@hoge1e3\r\n        source.playOffset = offset_adj;\r\n        source.plusTime = offset_adj;\r\n\r\n        // 再生\r\n        source.start = source.start || source.noteOn;\r\n        source.stop  = source.stop  || source.noteOff;\r\n        source.start(start, offset, durationStart);\r\n        // iOS, Firefoxではloopがtrueのときdurationを指定しても止まらない\r\n        // iOSではstopを２回以上呼ぶと、InvalidStateErrorが発生するので注意\r\n        if (loop && duration != null) source.stop(start + duration);\r\n        var t=this;\r\n        t.seSources.push(source);\r\n        source.onended = function(event) {\r\n            source.onended = null;\r\n            var idx=t.seSources.indexOf(source);\r\n            if (idx>=0) t.seSources.splice(idx,1);\r\n        };\r\n        return source;\r\n    };\r\n    T2MediaLib.prototype.stopSE = function(sourceObj) {\r\n        if (!isAudioBufferSourceNode(sourceObj)) return null;\r\n        try {\r\n            sourceObj.stop(0);\r\n        } catch(e) { // iOS対策\r\n            // iOSではstopを２回以上呼ぶと、InvalidStateErrorが発生する\r\n            if (sourceObj.gainNode) {\r\n                sourceObj.gainNode.gain.cancelScheduledValues(this.context.currentTime);\r\n                sourceObj.gainNode.gain.linearRampToValueAtTime(0, this.context.currentTime);\r\n            }\r\n        }\r\n        return sourceObj;\r\n    };\r\n    T2MediaLib.prototype.stopAllSE = function(sourceObj) {\r\n        var t=this;\r\n        this.seSources.forEach(function (s) {\r\n            t.stopSE(s);\r\n        });\r\n    };\r\n    T2MediaLib.prototype.getSEMasterVolume = function() {\r\n        return this.seMasterVolume;\r\n    };\r\n    T2MediaLib.prototype.setSEMasterVolume = function(vol) {\r\n        this.seMasterVolume = vol;\r\n    };\r\n    T2MediaLib.prototype.getSEVolume = function(sourceObj) {\r\n        if (!isAudioBufferSourceNode(sourceObj)) return null;\r\n        return sourceObj.volumeValue;\r\n    };\r\n    T2MediaLib.prototype.setSEVolume = function(sourceObj, vol) {\r\n        if (!isAudioBufferSourceNode(sourceObj)) return null;\r\n        sourceObj.gainNode.gain.value = vol * this.seMasterVolume * this.masterVolume;\r\n        sourceObj.volumeValue = vol;\r\n        return sourceObj;\r\n    };\r\n    T2MediaLib.prototype.getSERate = function(sourceObj) {\r\n        if (!isAudioBufferSourceNode(sourceObj)) return null;\r\n        return sourceObj.playbackRate.value;\r\n    };\r\n    T2MediaLib.prototype.setSERate = function(sourceObj, rate) {\r\n        if (!isAudioBufferSourceNode(sourceObj)) return null;\r\n        sourceObj.playbackRate.value = rate;\r\n    };\r\n    T2MediaLib.prototype.getSEPan = function(sourceObj) {\r\n        if (!isAudioBufferSourceNode(sourceObj)) return null;\r\n        return sourceObj.panValue;\r\n    };\r\n    T2MediaLib.prototype.setSEPan = function(sourceObj, pan) {\r\n        if (!isAudioBufferSourceNode(sourceObj)) return null;\r\n        var panNode = sourceObj.panNode;\r\n        if      (pan < -1.0) pan = -1.0;\r\n        else if (pan >  1.0) pan =  1.0;\r\n        var panAngle = pan * 90;\r\n        var panX = Math.sin(panAngle * (Math.PI / 180));\r\n        var panZ = Math.cos(panAngle * (Math.PI / 180));\r\n        if (pan === -1.0 || pan === 1.0) panZ = 0; // 6.123233995736766e-17となるので0にしておく\r\n        if (panNode.positionX) {\r\n            panNode.positionX.value = panX;\r\n            panNode.positionY.value = 0;\r\n            panNode.positionZ.value = panZ;\r\n        } else {\r\n            panNode.setPosition(panX, 0, panZ);\r\n        }\r\n        sourceObj.panValue = pan;\r\n    };\r\n    T2MediaLib.prototype.isSELoop = function(sourceObj) {\r\n        if (!isAudioBufferSourceNode(sourceObj)) return null;\r\n        return sourceObj.loop;\r\n    };\r\n    T2MediaLib.prototype.setSELoop = function(sourceObj, loop) {\r\n        if (!isAudioBufferSourceNode(sourceObj)) return null;\r\n        sourceObj.loop = loop;\r\n    };\r\n    T2MediaLib.prototype.getSELoopStartTime = function(sourceObj) {\r\n        if (!isAudioBufferSourceNode(sourceObj)) return null;\r\n        return sourceObj.loopStart;\r\n    };\r\n    T2MediaLib.prototype.setSELoopStartTime = function(sourceObj, loopStart) {\r\n        if (!isAudioBufferSourceNode(sourceObj)) return null;\r\n        sourceObj.loopStart = loopStart;\r\n    };\r\n    T2MediaLib.prototype.getSELoopEndTime = function(sourceObj) {\r\n        if (!isAudioBufferSourceNode(sourceObj)) return null;\r\n        return sourceObj.loopEnd;\r\n    };\r\n    T2MediaLib.prototype.setSELoopEndTime = function(sourceObj, loopEnd) {\r\n        if (!isAudioBufferSourceNode(sourceObj)) return null;\r\n        sourceObj.loopEnd = loopEnd;\r\n    };\r\n\r\n    // BGMメソッド郡 //\r\n\r\n    T2MediaLib.prototype.playBGM = function(id, idx, loop, offset, loopStart, loopEnd) {\r\n        if (!this.context) return null;\r\n        var bgmPlayer = this._getBgmPlayer(id);\r\n        if (!bgmPlayer) return null;\r\n        return bgmPlayer.playBGM(idx, loop, offset, loopStart, loopEnd);\r\n    };\r\n    T2MediaLib.prototype.stopBGM = function(id) {\r\n        var bgmPlayer = this._getBgmPlayer(id);\r\n        if (!bgmPlayer) return null;\r\n        return bgmPlayer.stopBGM();\r\n    };\r\n    T2MediaLib.prototype.pauseBGM = function(id) {\r\n        var bgmPlayer = this._getBgmPlayer(id);\r\n        if (!bgmPlayer) return null;\r\n        return bgmPlayer.pauseBGM();\r\n    };\r\n    T2MediaLib.prototype.resumeBGM = function(id) {\r\n        var bgmPlayer = this._getBgmPlayer(id);\r\n        if (!bgmPlayer) return null;\r\n        return bgmPlayer.resumeBGM();\r\n    };\r\n    T2MediaLib.prototype.getBGMMasterVolume = function() {\r\n        return this.bgmMasterVolume;\r\n    };\r\n    T2MediaLib.prototype.setBGMMasterVolume = function(vol) {\r\n        this.bgmMasterVolume = vol;\r\n        for (var i=0; i<this.bgmPlayerMax; i++) {\r\n            var bgmPlayer = this.bgmPlayerAry[i];\r\n            if (!(bgmPlayer instanceof T2MediaLib_BGMPlayer)) continue;\r\n            bgmPlayer.onChangeBGMMasterVolume();\r\n        }\r\n    };\r\n    T2MediaLib.prototype.getBGMVolume = function(id) {\r\n        var bgmPlayer = this._getBgmPlayer(id);\r\n        if (!bgmPlayer) return null;\r\n        return bgmPlayer.getBGMVolume();\r\n    };\r\n    T2MediaLib.prototype.setBGMVolume = function(id, vol) {\r\n        var bgmPlayer = this._getBgmPlayer(id);\r\n        if (!bgmPlayer) return null;\r\n        return bgmPlayer.setBGMVolume(vol);\r\n    };\r\n    T2MediaLib.prototype.getBGMTempo = function(id) {\r\n        var bgmPlayer = this._getBgmPlayer(id);\r\n        if (!bgmPlayer) return null;\r\n        return bgmPlayer.getBGMTempo();\r\n    };\r\n    T2MediaLib.prototype.setBGMTempo = function(id, tempo) {\r\n        var bgmPlayer = this._getBgmPlayer(id);\r\n        if (!bgmPlayer) return null;\r\n        return bgmPlayer.setBGMTempo(tempo);\r\n    };\r\n    T2MediaLib.prototype.getBGMPan = function(id) {\r\n        var bgmPlayer = this._getBgmPlayer(id);\r\n        if (!bgmPlayer) return null;\r\n        return bgmPlayer.getBGMPan();\r\n    };\r\n    T2MediaLib.prototype.setBGMPan = function(id, pan) {\r\n        var bgmPlayer = this._getBgmPlayer(id);\r\n        if (!bgmPlayer) return null;\r\n        return bgmPlayer.setBGMPan(pan);\r\n    };\r\n    T2MediaLib.prototype.isBGMLoop = function(id) {\r\n        var bgmPlayer = this._getBgmPlayer(id);\r\n        if (!bgmPlayer) return null;\r\n        return bgmPlayer.isBGMLoop();\r\n    };\r\n    T2MediaLib.prototype.setBGMLoop = function(id, loop) {\r\n        var bgmPlayer = this._getBgmPlayer(id);\r\n        if (!bgmPlayer) return null;\r\n        return bgmPlayer.setBGMLoop(loop);\r\n    };\r\n    T2MediaLib.prototype.getBGMLoopStartTime = function(id) {\r\n        var bgmPlayer = this._getBgmPlayer(id);\r\n        if (!bgmPlayer) return null;\r\n        return bgmPlayer.getBGMLoopStartTime();\r\n    };\r\n    T2MediaLib.prototype.setBGMLoopStartTime = function(id, loopStart) {\r\n        var bgmPlayer = this._getBgmPlayer(id);\r\n        if (!bgmPlayer) return null;\r\n        return bgmPlayer.setBGMLoopStartTime(loopStart);\r\n    };\r\n    T2MediaLib.prototype.getBGMLoopEndTime = function(id) {\r\n        var bgmPlayer = this._getBgmPlayer(id);\r\n        if (!bgmPlayer) return null;\r\n        return bgmPlayer.getBGMLoopEndTime();\r\n    };\r\n    T2MediaLib.prototype.setBGMLoopEndTime = function(id, loopEnd) {\r\n        var bgmPlayer = this._getBgmPlayer(id);\r\n        if (!bgmPlayer) return null;\r\n        return bgmPlayer.setBGMLoopEndTime(loopEnd);\r\n    };\r\n    T2MediaLib.prototype.getBGMCurrentTime = function(id) {\r\n        var bgmPlayer = this._getBgmPlayer(id);\r\n        if (!bgmPlayer) return null;\r\n        return bgmPlayer.getBGMCurrentTime();\r\n    };\r\n    T2MediaLib.prototype.getBGMLength = function(id) {\r\n        var bgmPlayer = this._getBgmPlayer(id);\r\n        if (!bgmPlayer) return null;\r\n        return bgmPlayer.getBGMLength();\r\n    };\r\n    T2MediaLib.prototype.getPlayingBGMName = function(id) {\r\n        var bgmPlayer = this._getBgmPlayer(id);\r\n        if (!bgmPlayer) return null;\r\n        return bgmPlayer.getPlayingBGMName();\r\n    };\r\n    T2MediaLib.prototype.setOnBGMEndListener = function(id, listener) {\r\n        var bgmPlayer = this._getBgmPlayer(id);\r\n        if (!bgmPlayer) return null;\r\n        return bgmPlayer.setOnBGMEndListener(listener);\r\n    };\r\n    T2MediaLib.prototype.getPlayingBGMState = function(id) {\r\n        var bgmPlayer = this._getBgmPlayer(id);\r\n        if (!bgmPlayer) return null;\r\n        return bgmPlayer.getPlayingBGMState();\r\n    };\r\n    T2MediaLib.prototype.getBGMPicoAudio = function(id) {\r\n        var bgmPlayer = this._getBgmPlayer(id);\r\n        if (!bgmPlayer) return null;\r\n        return bgmPlayer.getBGMPicoAudio();\r\n    };\r\n    T2MediaLib.prototype.isTagLoop = function(id) {\r\n        var bgmPlayer = this._getBgmPlayer(id);\r\n        if (!bgmPlayer) return null;\r\n        return bgmPlayer.isTagLoop();\r\n    };\r\n    T2MediaLib.prototype.setTagLoop = function(id, isTagLoop) {\r\n        var bgmPlayer = this._getBgmPlayer(id);\r\n        if (!bgmPlayer) return null;\r\n        return bgmPlayer.setTagLoop(isTagLoop);\r\n    };\r\n    T2MediaLib.prototype.getBGMPlayerMax = function() {\r\n        return this.bgmPlayerMax;\r\n    };\r\n    T2MediaLib.prototype.allStopBGM = function() {\r\n        for (var i=0; i<this.bgmPlayerMax; i++) {\r\n            this.stopBGM(i);\r\n        }\r\n    };\r\n    T2MediaLib.prototype.allResetBGM = function() {\r\n        for (var i=0; i<this.bgmPlayerMax; i++) {\r\n            this.stopBGM(i);\r\n            this.setBGMVolume(i, 1.0);\r\n            this.setBGMTempo(i, 1.0);\r\n            this.setBGMPan(i, 0.0);\r\n        }\r\n        this.setMasterVolume(1.0);\r\n        this.setSEMasterVolume(1.0);\r\n        this.setBGMMasterVolume(1.0);\r\n    };\r\n    T2MediaLib.prototype._getBgmPlayer = function(id) {\r\n        if (id < 0 || this.bgmPlayerMax <= id) return null;\r\n        var bgmPlayer = this.bgmPlayerAry[id];\r\n        if (!(bgmPlayer instanceof T2MediaLib_BGMPlayer)) return null;\r\n        return bgmPlayer;\r\n    };\r\n\r\n    // Audioメソッド郡 //\r\n\r\n    T2MediaLib.prototype.loadAudio = function(idx, url) {\r\n        var audio = new Audio(url);\r\n        audio.play();\r\n\r\n        this.audioDataAry.data[idx] = null;\r\n\r\n        var that = this;\r\n        audio.addEventListener('loadstart', function() {\r\n            if (!that.context) return null;\r\n            var source = that.context.createMediaElementSource(audio);\r\n            source.connect(that.context.destination);\r\n        }, false);\r\n\r\n        audio.addEventListener('canplay', function() {\r\n            this.audioDataAry.data[idx] = audio;\r\n        }, false);\r\n\r\n        audio.load();\r\n\r\n    };\r\n    T2MediaLib.prototype.playAudio = function(idx, loop, startTime) {\r\n        var audio = this.audioDataAry.data[idx];\r\n        if (!audio) return null;\r\n        if (!startTime) startTime = 0;\r\n\r\n        if (this.playingAudio instanceof Audio) {\r\n            this.playingAudio.pause();\r\n            this.playingAudio.currentTime = 0;\r\n        }\r\n        this.playingAudio = audio;\r\n        audio.loop = loop;\r\n        audio.volume = this.audioVolume;\r\n        audio.currentTime = startTime;\r\n        audio.play();\r\n        return audio;\r\n    };\r\n    T2MediaLib.prototype.stopAudio = function() {\r\n        var audio = this.playingAudio;\r\n        if (!(audio instanceof Audio)) return null;\r\n        audio.pause();\r\n        audio.currentTime = 0;\r\n        this.playingAudio = null;\r\n        return audio;\r\n    };\r\n    T2MediaLib.prototype.pauseAudio = function() {\r\n        var audio = this.playingAudio;\r\n        if (!audio) return null;\r\n        audio.pause();\r\n        return audio;\r\n    };\r\n    T2MediaLib.prototype.resumeAudio = function() {\r\n        var audio = this.playingAudio;\r\n        if (!audio) return null;\r\n        audio.play();\r\n        return audio;\r\n    };\r\n    T2MediaLib.prototype.setAudioVolume = function(vol) {\r\n        this.audioVolume = vol;\r\n        if (this.playingAudio instanceof Audio) {\r\n            this.playingAudio.volume = vol;\r\n        }\r\n    };\r\n    T2MediaLib.prototype.setAudioTempo = function(tempo) {\r\n        this.audioTempo = tempo;\r\n        if (this.playingAudio instanceof Audio) {\r\n            this.playingAudio.playbackRate = tempo;\r\n        }\r\n    };\r\n    T2MediaLib.prototype.setAudioPosition = function(time) {\r\n        if (this.playingAudio instanceof Audio) {\r\n            this.playingAudio.currentTime = time;\r\n        }\r\n    };\r\n    T2MediaLib.prototype.getAudioData = function(idx) {\r\n        return this.audioDataAry.data[idx];\r\n    };\r\n    T2MediaLib.prototype.getAudioCurrentTime = function() {\r\n        if (!(this.playingAudio instanceof Audio)) return null;\r\n        return this.playingAudio.currentTime;\r\n    };\r\n    T2MediaLib.prototype.getAudioLength = function() {\r\n        if (!(this.playingAudio instanceof Audio)) return null;\r\n        return this.playingAudio.duration;\r\n    };\r\n\r\n    // Oggループタグ探す //\r\n    T2MediaLib.prototype.searchOggLoop = function(arrayBuffer) {\r\n        var buf = new Uint8Array(arrayBuffer.slice(0, 3000));\r\n        var str = String.fromCharCode.apply(null, buf);\r\n        var isVorbis = str.lastIndexOf(\"vorbis\", 0x22);\r\n        if (isVorbis == -1) return [0, 0]; // Vorbisではない場合、解析しない\r\n        var startIdx = str.indexOf(\"LOOPSTART=\");\r\n        var lengthIdx = str.indexOf(\"LOOPLENGTH=\");\r\n        var loopStart = 0;\r\n        var loopLength = 0;\r\n        var sampleRate = buf[40] + (buf[41]<<8) + (buf[42]<<16) + (buf[43]<<24);\r\n        var tagSize,i,c;\r\n        if (startIdx != -1) {\r\n            tagSize = buf[startIdx] + (buf[startIdx+1]<<8) + (buf[startIdx+2]<<16) + (buf[startIdx+3]<<24);\r\n            for (i=startIdx+10; i<startIdx+tagSize; i++) {\r\n                c = str[i];\r\n                if (c < '0' || c > '9') break;\r\n                loopStart = loopStart*10 + (c - '0');\r\n            }\r\n        }\r\n        if (lengthIdx != -1) {\r\n            tagSize = buf[lengthIdx] + (buf[lengthIdx+1]<<8) + (buf[lengthIdx+2]<<16) + (buf[lengthIdx+3]<<24);\r\n            for (i=lengthIdx+11; i<lengthIdx+tagSize; i++) {\r\n                c = str[i];\r\n                if (c < '0' || c > '9') break;\r\n                loopLength = loopLength*10 + (c - '0');\r\n            }\r\n        }\r\n        // 秒に変換\r\n        var loopEnd = (loopStart + loopLength) / sampleRate;\r\n        loopStart /= sampleRate;\r\n        return [loopStart, loopEnd];\r\n    };\r\n\r\n    return T2MediaLib;\r\n})();\r\n\r\n\r\n\r\nvar T2MediaLib_BGMPlayer = (function(){\r\n    function isPicoAudio(bgm) {\r\n        return typeof PicoAudio!==\"undefined\" && bgm instanceof PicoAudio;\r\n    }\r\n    function isMezonetSource(bgm) {\r\n        return typeof Mezonet!==\"undefined\" && bgm instanceof Mezonet.Source;\r\n    }\r\n    function isMezonetPlayback(bgm) {\r\n        return typeof Mezonet!==\"undefined\" && bgm instanceof Mezonet.Playback;\r\n    }\r\n    function isAudioBufferSourceNode(bgm) {\r\n        // return bgm instanceof AudioBufferSourceNode || bgm instanceof WebKitAudioBufferSourceNode; // 本来はこの処理にしたい\r\n        // Safari 14でAudioBufferSourceNodeがWebKitAudioBufferSourceNodeに変更されたように、\r\n        // WebAPIの名前変更は予測できないので、消去方で判定する\r\n        return bgm != null && !(isPicoAudio(bgm) || isMezonetSource(bgm) || isMezonetPlayback(bgm))\r\n    }\r\n    var T2MediaLib_BGMPlayer = function(t2MediaLib, arg_id) {\r\n        this.t2MediaLib = t2MediaLib;\r\n        this.id = arg_id;\r\n        this.playingBGMState = \"stop\";\r\n        this.playingBGMStatePending = null;\r\n        this.playingBGM = null;\r\n        this.playingBGMName = null;\r\n        this.bgmPause = 0;\r\n        this.bgmPauseTime = 0;\r\n        this.bgmPauseCurrentTime = 0;\r\n        this.bgmPauseTempo = 0;\r\n        this.bgmPauseLoop = false;\r\n        this.bgmPauseLoopStart = 0;\r\n        this.bgmPauseLoopEnd = 0;\r\n        this.bgmVolume = 1.0;\r\n        this.bgmTempo = 1.0;\r\n        this.bgmPan = 0.0;\r\n        this.picoAudio = null;//new PicoAudio(this.context);\r\n        this.picoAudioSetDataBGMName = null; // 前回のsetDataした曲を再び使う場合は、setDataを省略して軽量化する\r\n        this.PICO_AUDIO_VOLUME_COEF = 1;//0.2;\r\n        this.isTagLoop = true; // Ogg VorbisファイルにLOOPSTART,LOOPLENGTHのタグが入っている場合、再生時にそれを適用するか\r\n    };\r\n\r\n    // BGM関数郡 //\r\n\r\n    T2MediaLib_BGMPlayer.prototype.playBGM = function(idx, loop, offset, loopStart, loopEnd) {\r\n        this.stopBGM();\r\n\r\n        var soundData = this.t2MediaLib.soundDataAry[idx];\r\n        if (soundData == null) return null;\r\n        if (!soundData.isDecodeComplete()) {\r\n            var that = this;\r\n            var callbacks = {};\r\n            callbacks.bgmPlayerId = this.id;\r\n            callbacks.succ = function() {\r\n                var succFunc = function() {\r\n                    var pending = that.playingBGMStatePending; // 途中で値が変わるため保存\r\n                    that._setPlayingBGMState(\"stop\", true);\r\n                    if (pending != \"stop\" && that.playingBGMName == idx) {\r\n                        that.playBGM(idx, loop, offset, loopStart, loopEnd);\r\n                    }\r\n                    if (pending == \"pause\") {\r\n                        that.pauseBGM();\r\n                    }\r\n                };\r\n                var decodedData = soundData.decodedData;\r\n                if (decodedData instanceof Object) { // MIDI\r\n                    // MIDIの場合、デコード後はAudioContext.currenTimeの時間がとんで\r\n                    // 再生直後、瞬間的に早送り再生みたいになるので、playBGMを一旦処理を後回しにする\r\n                    setTimeout(function(){succFunc();}, 0);\r\n                } else { // MP3, Ogg, AAC, WAV\r\n                    succFunc();\r\n                }\r\n            };\r\n            callbacks.err = function() {\r\n                that._setPlayingBGMState(\"stop\", true);\r\n            };\r\n            this.playingBGMName = idx;\r\n            this._setPlayingBGMState(\"decoding\", true);\r\n            this._setPlayingBGMState(\"play\");\r\n            this.t2MediaLib.decodeSound(idx, callbacks);\r\n            return this;\r\n        }\r\n\r\n        var decodedData = soundData.decodedData;\r\n        if (isMezonetSource(decodedData)) {\r\n            var m=decodedData.playback(this.t2MediaLib.context);\r\n            this.playingBGM = m;\r\n            m.Start();\r\n        } else if (decodedData instanceof AudioBuffer) {\r\n            // MP3, Ogg, AAC, WAV\r\n            if (this.isTagLoop) {\r\n                loopStart = loopStart||soundData.tagLoopStart;\r\n                loopEnd = loopEnd||soundData.tagLoopEnd;\r\n            }\r\n            this.playingBGM = this.t2MediaLib.playSE(idx, this.bgmVolume, this.bgmPan, this.bgmTempo, offset, loop, loopStart, loopEnd);\r\n        } else if (decodedData instanceof Object) {\r\n            // Midi\r\n            this._initPicoAudio();\r\n            if (idx != this.picoAudioSetDataBGMName) {\r\n                this.picoAudio.setData(decodedData);\r\n                this.picoAudioSetDataBGMName = idx;\r\n            } else {\r\n                this.picoAudio.initStatus();\r\n            }\r\n            this.picoAudio.setLoop(loop);\r\n            this.picoAudio.setMasterVolume(this.PICO_AUDIO_VOLUME_COEF * this.bgmVolume *\r\n                 this.t2MediaLib.bgmMasterVolume * this.t2MediaLib.masterVolume);\r\n            if (!offset) {\r\n                offset = 0;\r\n            } else {\r\n                var bgmLengthTime = this.picoAudio.getTime(Number.MAX_SAFE_INTEGER);\r\n                if      (offset > bgmLengthTime) offset = bgmLengthTime;\r\n                else if (offset < 0.0) offset = 0.0;\r\n            }\r\n            this.picoAudio.setStartTime(offset);\r\n            this.picoAudio.play();\r\n            this.playingBGM = this.picoAudio;\r\n        }\r\n        this.playingBGMName = idx;\r\n        this.bgmPause = 0;\r\n        this._setPlayingBGMState(\"play\");\r\n        return this;\r\n    };\r\n\r\n    T2MediaLib_BGMPlayer.prototype.stopBGM = function() {\r\n        var bgm = this.playingBGM;\r\n        if (isMezonetPlayback(bgm)){\r\n            bgm.Stop();\r\n        } else if (isPicoAudio(bgm)) {\r\n            // Midi\r\n            this.picoAudio.stop();\r\n        } else if (isAudioBufferSourceNode(bgm)) {\r\n            // MP3, Ogg, AAC, WAV\r\n            try {\r\n                bgm.stop(0);\r\n            } catch(e) { // iOS対策\r\n                // iOSではstopを２回以上呼ぶと、InvalidStateErrorが発生する\r\n                if (bgm.gainNode) {\r\n                    bgm.gainNode.gain.cancelScheduledValues(this.t2MediaLib.context.currentTime);\r\n                    bgm.gainNode.gain.linearRampToValueAtTime(0, this.t2MediaLib.context.currentTime);\r\n                }\r\n            }\r\n        }\r\n        this.playingBGM = null;\r\n        this.playingBGMName = null;\r\n        this._setPlayingBGMState(\"stop\");\r\n        return this;\r\n    };\r\n\r\n    T2MediaLib_BGMPlayer.prototype.pauseBGM = function() {\r\n        var bgm = this.playingBGM;\r\n        if (isMezonetPlayback(bgm)){\r\n            bgm.pause();\r\n        } else if (isPicoAudio(bgm)) {\r\n            // Midi\r\n            if (this.bgmPause === 0) {\r\n                this.bgmPauseTime = this.getBGMCurrentTime();\r\n                this.bgmPauseCurrentTime = bgm.context.currentTime;\r\n                bgm.stop();\r\n                this.bgmPause = 1;\r\n            }\r\n        } else if (isAudioBufferSourceNode(bgm)) {\r\n            // MP3, Ogg, AAC, WAV\r\n            if (this.bgmPause === 0) {\r\n                this.bgmPauseTime = this.getBGMCurrentTime();\r\n                this.bgmPauseLoopStart = this.t2MediaLib.getSELoopStartTime(bgm);\r\n                this.bgmPauseLoopEnd = this.t2MediaLib.getSELoopEndTime(bgm);\r\n                this.bgmPauseLoop = this.t2MediaLib.isSELoop(bgm);\r\n                this.bgmPauseCurrentTime = bgm.context.currentTime;\r\n                this.bgmPauseTempo = this.bgmTempo;\r\n                try {\r\n                    bgm.stop(0);\r\n                } catch(e) { // iOS対策\r\n                    // iOSではstopを２回以上呼ぶと、InvalidStateErrorが発生する\r\n                    if (bgm.gainNode) {\r\n                        bgm.gainNode.gain.cancelScheduledValues(this.t2MediaLib.context.currentTime);\r\n                        bgm.gainNode.gain.linearRampToValueAtTime(0, this.t2MediaLib.context.currentTime);\r\n                    }\r\n                }\r\n                this.bgmPause = 1;\r\n            }\r\n        }\r\n        if (this.playingBGMState != \"stop\") {\r\n            this._setPlayingBGMState(\"pause\");\r\n        }\r\n        return this;\r\n    };\r\n\r\n    T2MediaLib_BGMPlayer.prototype.resumeBGM = function() {\r\n        var bgm = this.playingBGM;\r\n        if (isMezonetPlayback(bgm)){\r\n            bgm.resume();\r\n        } else if (isPicoAudio(bgm)) {\r\n            // Midi\r\n            if (this.bgmPause === 1) {\r\n                bgm.play();\r\n                this.bgmPause = 0;\r\n            }\r\n        } else if (isAudioBufferSourceNode(bgm)) {\r\n            // MP3, Ogg, AAC, WAV\r\n            if (this.bgmPause === 1) {\r\n                bgm = this.playBGM(this.playingBGMName, this.bgmPauseLoop, this.bgmPauseTime, this.bgmPauseLoopStart, this.bgmPauseLoopEnd);\r\n            }\r\n        }\r\n        return this;\r\n    };\r\n\r\n    T2MediaLib_BGMPlayer.prototype.onChangeBGMMasterVolume = function() {\r\n        this.setBGMVolume(this.getBGMVolume());\r\n    };\r\n\r\n    T2MediaLib_BGMPlayer.prototype.getBGMVolume = function() {\r\n        return this.bgmVolume;\r\n    };\r\n\r\n    T2MediaLib_BGMPlayer.prototype.setBGMVolume = function(vol) {\r\n        var bgm = this.playingBGM;\r\n        this.bgmVolume = vol;\r\n        if (isMezonetPlayback(bgm)){\r\n            bgm.setVolume(vol);\r\n        } else if (isPicoAudio(bgm)) {\r\n            // Midi\r\n            this.picoAudio.setMasterVolume(this.PICO_AUDIO_VOLUME_COEF * vol * this.t2MediaLib.bgmMasterVolume * this.t2MediaLib.masterVolume);\r\n        } else if (isAudioBufferSourceNode(bgm)) {\r\n            // MP3, Ogg, AAC, WAV\r\n            bgm.gainNode.gain.value = vol * this.t2MediaLib.bgmMasterVolume * this.t2MediaLib.masterVolume;\r\n            //↓seMasterVolumeが音量に乗算されてしまう\r\n            //this.t2MediaLib.setSEVolume(bgm, vol);\r\n        }\r\n        return this;\r\n    };\r\n\r\n    T2MediaLib_BGMPlayer.prototype.getBGMTempo = function() {\r\n        return this.bgmTempo;\r\n    };\r\n\r\n    T2MediaLib_BGMPlayer.prototype.setBGMTempo = function(tempo) {\r\n        // MP3, Ogg, AAC, WAV\r\n        var bgm = this.playingBGM;\r\n\r\n        if (tempo <= 0 || isNaN(tempo)) tempo = 1;\r\n        if (isMezonetPlayback(bgm)){\r\n            bgm.setRate(tempo);\r\n            return this;\r\n        } else if (isAudioBufferSourceNode(bgm) && this.bgmPause === 0) {\r\n            bgm.plusTime -= (this.t2MediaLib.context.currentTime - bgm.playStartTime) * (tempo - this.bgmTempo);\r\n        }\r\n        this.bgmTempo = tempo;\r\n        this.t2MediaLib.setSERate(bgm, tempo);\r\n        return this;\r\n    };\r\n\r\n    T2MediaLib_BGMPlayer.prototype.getBGMPan = function() {\r\n        return this.bgmPan;\r\n    };\r\n\r\n    T2MediaLib_BGMPlayer.prototype.setBGMPan = function(pan) {\r\n        var bgm = this.playingBGM;\r\n        this.bgmPan = pan;\r\n        if (isAudioBufferSourceNode(bgm)) {\r\n            // MP3, Ogg, AAC, WAV\r\n            this.t2MediaLib.setSEPan(bgm, pan);\r\n        }\r\n        return this;\r\n    };\r\n\r\n    T2MediaLib_BGMPlayer.prototype.isBGMLoop = function() {\r\n        var bgm = this.playingBGM;\r\n        if (isPicoAudio(bgm)) {\r\n            // Midi\r\n            return this.picoAudio.isLoop();\r\n        } else if (isAudioBufferSourceNode(bgm)) {\r\n            // MP3, Ogg, AAC, WAV\r\n            if (this.bgmPause === 1) {\r\n                return this.bgmPauseLoop;\r\n            } else {\r\n                return this.t2MediaLib.isSELoop(bgm);\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n\r\n    T2MediaLib_BGMPlayer.prototype.setBGMLoop = function(loop) {\r\n        var bgm = this.playingBGM;\r\n        if (isPicoAudio(bgm)) {\r\n            // Midi\r\n            this.picoAudio.setLoop(loop);\r\n        } else if (isAudioBufferSourceNode(bgm)) {\r\n            // MP3, Ogg, AAC, WAV\r\n            if (this.bgmPause === 1) {\r\n                this.bgmPauseLoop = loop;\r\n            } else {\r\n                this.t2MediaLib.setSELoop(bgm, loop);\r\n            }\r\n        }\r\n        return this;\r\n    };\r\n\r\n    T2MediaLib_BGMPlayer.prototype.getBGMLoopStartTime = function() {\r\n        var bgm = this.playingBGM;\r\n        if (isPicoAudio(bgm)) {\r\n            // Midi\r\n            return 0;\r\n        } else if (isAudioBufferSourceNode(bgm)) {\r\n            // MP3, Ogg, AAC, WAV\r\n            if (this.bgmPause === 1) {\r\n                return this.bgmPauseLoopStart;\r\n            } else {\r\n                return this.t2MediaLib.getSELoopStartTime(bgm);\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n\r\n    T2MediaLib_BGMPlayer.prototype.setBGMLoopStartTime = function(loopStart) {\r\n        var bgm = this.playingBGM;\r\n        if (isAudioBufferSourceNode(bgm)) {\r\n            // MP3, Ogg, AAC, WAV\r\n            if (this.bgmPause === 1) {\r\n                this.bgmPauseLoopStart = loopStart;\r\n            } else {\r\n                return this.t2MediaLib.setSELoopStartTime(bgm, loopStart);\r\n            }\r\n        }\r\n        return this;\r\n    };\r\n\r\n    T2MediaLib_BGMPlayer.prototype.getBGMLoopEndTime = function() {\r\n        var bgm = this.playingBGM;\r\n        if (isPicoAudio(bgm)) {\r\n            // Midi\r\n            return this.getBGMLength();\r\n        } else if (isAudioBufferSourceNode(bgm)) {\r\n            // MP3, Ogg, AAC, WAV\r\n            if (this.bgmPause === 1) {\r\n                return this.bgmPauseLoopEnd;\r\n            } else {\r\n                return this.t2MediaLib.getSELoopEndTime(bgm);\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n\r\n    T2MediaLib_BGMPlayer.prototype.setBGMLoopEndTime = function(loopEnd) {\r\n        var bgm = this.playingBGM;\r\n        if (isAudioBufferSourceNode(bgm)) {\r\n            // MP3, Ogg, AAC, WAV\r\n            if (this.bgmPause === 1) {\r\n                this.bgmPauseLoopEnd = loopEnd;\r\n            } else {\r\n                return this.t2MediaLib.setSELoopEndTime(bgm, loopEnd);\r\n            }\r\n        }\r\n        return this;\r\n    };\r\n\r\n    T2MediaLib_BGMPlayer.prototype.getBGMCurrentTime = function() {\r\n        var bgm = this.playingBGM;\r\n        var time;\r\n        if (isMezonetPlayback(bgm)){\r\n            return bgm.getTrackTime();\r\n        } else if (isPicoAudio(bgm)) {\r\n            // Midi\r\n            if (this.bgmPause === 0) {\r\n                time = this.picoAudio.context.currentTime - this.picoAudio.states.startTime;\r\n            } else {\r\n                time = this.bgmPauseTime;\r\n            }\r\n            return time;\r\n        } else if (isAudioBufferSourceNode(bgm)) {\r\n            // MP3, Ogg, AAC, WAV\r\n            var time2, currenTime, tempo, plusTime, minusTime, mod;\r\n\r\n            if (this.bgmPause === 0) {\r\n                currenTime = this.t2MediaLib.context.currentTime;\r\n                tempo = this.bgmTempo;\r\n            } else {\r\n                currenTime = this.bgmPauseCurrentTime;\r\n                tempo = this.bgmPauseTempo;\r\n            }\r\n\r\n            time2 = (currenTime - bgm.playStartTime) * tempo + bgm.plusTime;\r\n            if (bgm.loop) {\r\n                if (bgm.loopEnd - bgm.loopStart > 0) { // ループ範囲正常\r\n\r\n                    if (time2 < bgm.loopStart) { // ループ範囲前\r\n                        plusTime  = 0;\r\n                        minusTime = 0;\r\n                        mod = bgm.buffer.duration;\r\n                    } else { // ループ範囲内\r\n                        plusTime  = bgm.loopStart;\r\n                        minusTime = bgm.loopStart;\r\n                        mod = bgm.loopEnd - bgm.loopStart;\r\n                    }\r\n                } else { // ループ範囲マイナス（ループ無効）\r\n                    mod = bgm.buffer.duration;\r\n                    plusTime = 0;\r\n                    minusTime = 0;\r\n                }\r\n            }\r\n\r\n            if (bgm.loop) {\r\n                time = ((time2 - minusTime) % mod) + plusTime;\r\n            } else {\r\n                time = time2;\r\n                if (time > bgm.buffer.duration) time = bgm.buffer.duration;\r\n            }\r\n            return time;\r\n        }\r\n        return null;\r\n    };\r\n\r\n    T2MediaLib_BGMPlayer.prototype.getBGMLength = function() {\r\n        var bgm = this.playingBGM;\r\n        if (isPicoAudio(bgm)) {\r\n            // Midi\r\n            return this.picoAudio.getTime(Number.MAX_SAFE_INTEGER);\r\n        } else if (isAudioBufferSourceNode(bgm)) {\r\n            // MP3, Ogg, AAC, WAV\r\n            return bgm.buffer.duration;\r\n        }\r\n        return null;\r\n    };\r\n\r\n    T2MediaLib_BGMPlayer.prototype.getPlayingBGMName = function() {\r\n        return this.playingBGMName;\r\n    };\r\n\r\n    T2MediaLib_BGMPlayer.prototype.setOnBGMEndListener = function(listener) {\r\n        if (this.picoAudio != null) {\r\n            this.picoAudio.setOnSongEndListener(listener);\r\n        }\r\n    };\r\n\r\n    T2MediaLib_BGMPlayer.prototype.getPlayingBGMState = function() {\r\n        return this.playingBGMState;\r\n    };\r\n\r\n    T2MediaLib_BGMPlayer.prototype.getBGMPicoAudio = function() {\r\n        this._initPicoAudio();\r\n        return this.picoAudio;\r\n    };\r\n\r\n    T2MediaLib_BGMPlayer.prototype.isTagLoop = function() {\r\n        return this.isTagLoop;\r\n    };\r\n\r\n    T2MediaLib_BGMPlayer.prototype.setTagLoop = function(isTagLoop) {\r\n        this.isTagLoop = isTagLoop;\r\n    };\r\n\r\n    T2MediaLib_BGMPlayer.prototype._setPlayingBGMState = function(state, force) {\r\n        if (force || this.playingBGMState != \"decoding\") {\r\n            this.playingBGMState = state;\r\n            this.playingBGMStatePending = null;\r\n        } else {\r\n            this.playingBGMStatePending = state;\r\n        }\r\n    };\r\n\r\n    T2MediaLib_BGMPlayer.prototype._initPicoAudio = function() {\r\n        if (this.picoAudio == null) {\r\n            if (this.id == 0) {\r\n                this.picoAudio = this.t2MediaLib.picoAudio; // 0番目はT2MediaLib.picoAudioを使いまわす（初期化に時間がかかるため）\r\n            }\r\n            if (this.picoAudio == null) {\r\n                // AudioContextオブジェクトがmax6つまで？なので使いまわす\r\n                this.picoAudio = new PicoAudio({\r\n                    audioContext: this.context,\r\n                    picoAudio: this.t2MediaLib.picoAudio,\r\n                    isSkipBeginning: true,\r\n                    initReverb: 0\r\n                });\r\n            }\r\n        }\r\n    };\r\n\r\n    return T2MediaLib_BGMPlayer;\r\n})();\r\n\r\n\r\n\r\nvar T2MediaLib_SoundData = (function(){\r\n    var T2MediaLib_SoundData = function(idx, url) {\r\n        // \"none\"    :データなし\r\n        // \"loading\" :読み込み中\r\n        // \"loaded\"  :読み込み完了\r\n        // \"decoding\":デコード中\r\n        // \"decoded\" :デコード完了\r\n        // \"error\"   :エラー\r\n        this.idx = idx;\r\n        this.state = \"none\";\r\n        this.errorID = null;\r\n        this.url = null;\r\n        this.fileData = null;\r\n        this.decodedData = null;\r\n        this.decodedCallbacksAry = null;\r\n        this.tagLoopStart = 0;\r\n        this.tagLoopEnd = 0;\r\n    };\r\n\r\n    T2MediaLib_SoundData.prototype.onLoad = function(url) {\r\n        this.state = \"loading\";\r\n        this.url = url;\r\n    };\r\n\r\n    T2MediaLib_SoundData.prototype.onLoadComplete = function(data) {\r\n        this.state = \"loaded\";\r\n        this.fileData = data;\r\n    };\r\n\r\n    T2MediaLib_SoundData.prototype.onDecode = function() {\r\n        this.state = \"decoding\";\r\n    };\r\n\r\n    T2MediaLib_SoundData.prototype.onDecodeComplete = function(data) {\r\n        this.state = \"decoded\";\r\n        this.decodedData = data;\r\n    };\r\n\r\n    T2MediaLib_SoundData.prototype.onError = function(errorID) {\r\n        this.state = \"error\";\r\n        this.errorID = errorID;\r\n    };\r\n\r\n    T2MediaLib_SoundData.prototype.isNone = function() {\r\n        return this.state == \"none\";\r\n    };\r\n\r\n    T2MediaLib_SoundData.prototype.isLoadComplete = function() {\r\n        switch(this.state) {\r\n            case \"loaded\":\r\n            case \"decoding\":\r\n            case \"decoded\":\r\n                return true;\r\n        }\r\n        return false;\r\n    };\r\n\r\n    T2MediaLib_SoundData.prototype.isDecoding = function() {\r\n        return this.state == \"decoding\";\r\n    };\r\n\r\n    T2MediaLib_SoundData.prototype.isDecodeComplete = function() {\r\n        return this.state == \"decoded\";\r\n    };\r\n\r\n    T2MediaLib_SoundData.prototype.removeDecodedData = function() {\r\n        this.state = \"loaded\";\r\n        this.decodedData = null;\r\n    };\r\n\r\n    return T2MediaLib_SoundData;\r\n})();\r\n// r.jsで連結されたファイル全体がfunction(){...var T2Media...}() で閉じられている場合，グローバルに展開．\r\nwindow.T2MediaLib=T2MediaLib;\r\nwindow.T2MediaLib_BGMPlayer=T2MediaLib_BGMPlayer;\r\nwindow.T2MediaLib_SoundData=T2MediaLib_SoundData;\r\n\ndefine(\"T2MediaLib\", (function (global) {\n    return function () {\n        var ret, fn;\n        return ret || global.T2MediaLib;\n    };\n}(this)));\n\ndefine('exceptionCatcher',[], function () {\r\n    var res={};\r\n    res.f=function (f) {\r\n        if (typeof f==\"function\") {\r\n            if (f.isTrcf) return f;\r\n            var r=function () {\r\n                if (res.handleException && !res.enter) {\r\n                    try {\r\n                        res.enter=true;\r\n                        return f.apply(this,arguments);\r\n                    } catch (e) {\r\n                        res.handleException(e);\r\n                    } finally {\r\n                        res.enter=false;\r\n                    }\r\n                } else {\r\n                    return f.apply(this,arguments);\r\n                }\r\n            };\r\n            r.isTrcf=true;\r\n            return r;\r\n        } else if(typeof f==\"object\") {\r\n            for (var k in f) {\r\n                f[k]=res.f(f[k]);\r\n            }\r\n            return f;\r\n        }\r\n    };\r\n    //res.handleException=function (){};\r\n    return res;\r\n});\ndefine('UI',[\"Util\",\"exceptionCatcher\"],function (Util, EC) {\r\n    var UI={};\r\n    var F=EC.f;\r\n    UI=function () {\r\n        var expr=[];\r\n        for (var i=0 ; i<arguments.length ; i++) {\r\n            expr[i]=arguments[i];\r\n        }\r\n        var listeners=[];\r\n        var $vars={};\r\n        var $edits=[];\r\n        var res=parse(expr);\r\n        res.$edits=$edits;\r\n        res.$vars=$vars;\r\n        $.data(res,\"edits\",$edits);\r\n        $.data(res,\"vars\",$vars);\r\n        $edits.load=function (model) {\r\n            $edits.model=model;\r\n            $edits.forEach(function (edit) {\r\n                $edits.writeToJq(edit.params.$edit, edit.jq);\r\n            });\r\n            $edits.validator.on.validate.call($edits.validator, $edits.model);\r\n        };\r\n        $edits.writeToJq=function ($edit, jq) {\r\n        \tvar m=$edits.model;\r\n            if (!m) return;\r\n            var name = $edit.name;\r\n            var a=name.split(\".\");\r\n            for (var i=0 ; i<a.length ;i++) {\r\n                m=m[a[i]];\r\n            }\r\n            m=$edit.type.toVal(m);\r\n            if (jq.attr(\"type\")==\"checkbox\") {\r\n                jq.prop(\"checked\",!!m);\r\n            } else {\r\n                jq.val(m);\r\n            }\r\n        };\r\n        $edits.validator={\r\n       \t\terrors:{},\r\n       \t\tshow: function () {\r\n       \t\t\tif ($vars.validationMessage) {\r\n       \t\t\t\t$vars.validationMessage.empty();\r\n       \t\t\t\tfor (var name in this.errors) {\r\n       \t\t\t\t\t$vars.validationMessage.append(UI(\"div\", this.errors[name].mesg));\r\n       \t\t\t\t}\r\n       \t\t\t}\r\n       \t\t\tif ($vars.OKButton) {\r\n       \t\t\t\tvar ok=true;\r\n       \t\t\t\tfor (var name in this.errors) {\r\n       \t\t\t\t\tok=false;\r\n       \t\t\t\t}\r\n       \t\t\t\t$vars.OKButton.attr(\"disabled\", !ok);\r\n       \t\t\t}\r\n       \t\t},\r\n       \t\ton: {\r\n       \t\t\tvalidate: function () {}\r\n       \t\t},\r\n       \t\taddError: function (name, mesg, jq) {\r\n       \t\t\tthis.errors[name]={mesg:mesg, jq:jq};\r\n       \t\t\tthis.show();\r\n       \t\t},\r\n       \t\tremoveError: function (name) {\r\n       \t\t\tdelete this.errors[name];\r\n       \t\t\tthis.show();\r\n       \t\t},\r\n       \t\tallOK: function () {\r\n       \t\t\tfor (var i in this.errors) {\r\n       \t\t\t\tdelete this.errors[i];\r\n       \t\t\t}\r\n       \t\t\tthis.show();\r\n       \t\t},\r\n       \t\tisValid: function () {\r\n       \t\t    var res=true;\r\n       \t\t    for (var i in this.errors) res=false;\r\n       \t\t    return res;\r\n       \t\t}\r\n        };\r\n        $edits.writeToModel=function ($edit, val ,jq) {\r\n            var m=$edits.model;\r\n        \t//console.log($edit, m);\r\n            if (!m) return;\r\n            var name = $edit.name;\r\n            try {\r\n                val=$edit.type.fromVal(val);\r\n            } catch (e) {\r\n            \t$edits.validator.addError(name, e, jq);\r\n            \t//$edits.validator.errors[name]={mesg:e, jq:jq};\r\n                //$edits.validator.change(name, e, jq);\r\n                return;\r\n            }\r\n            $edits.validator.removeError(name);\r\n            /*\r\n            if ($edits.validator.errors[name]) {\r\n                delete $edits.validator.errors[name];\r\n                $edits.validator.change(name, null, jq);\r\n            }*/\r\n            var a=name.split(\".\");\r\n            for (var i=0 ; i<a.length ;i++) {\r\n                if (i==a.length-1) {\r\n                    if ($edits.on.writeToModel(name,val)) {\r\n\r\n                    } else {\r\n                        m[a[i]]=val;\r\n                    }\r\n                } else {\r\n                    m=m[a[i]];\r\n                }\r\n            }\r\n            $edits.validator.on.validate.call($edits.validator, $edits.model);\r\n        };\r\n        $edits.on={};\r\n        $edits.on.writeToModel= function (name, val) {};\r\n\r\n        if (listeners.length>0) {\r\n            setTimeout(F(l),50);\r\n        }\r\n        function l() {\r\n            listeners.forEach(function (li) {\r\n                li();\r\n            });\r\n            setTimeout(F(l),50);\r\n        }\r\n        return res;\r\n        function parse(expr) {\r\n            if (expr instanceof Array) return parseArray(expr);\r\n            else if (typeof expr==\"string\") return parseString(expr);\r\n            else return expr;\r\n        }\r\n        function parseArray(a) {\r\n            var tag=a[0];\r\n            var i=1;\r\n            var res=$(\"<\"+tag+\">\");\r\n            if (typeof a[i]==\"object\" && !(a[i] instanceof Array) && !(a[i] instanceof $) ) {\r\n                parseAttr(res, a[i],tag);\r\n                i++;\r\n            }\r\n            while (i<a.length) {\r\n                res.append(parse(a[i]));\r\n                i++;\r\n            }\r\n            return res;\r\n        }\r\n        function parseAttr(jq, o, tag) {\r\n            if (o.$var) {\r\n                $vars[o.$var]=jq;\r\n            }\r\n            if (o.$edit) {\r\n                if (typeof o.$edit==\"string\") {\r\n                    o.$edit={name: o.$edit, type: UI.types.String};\r\n                }\r\n                if (!o.on) o.on={};\r\n                o.on.realtimechange=F(function (val) {\r\n                    $edits.writeToModel(o.$edit, val, jq);\r\n                });\r\n                if (!$vars[o.$edit.name]) $vars[o.$edit.name]=jq;\r\n                $edits.push({jq:jq,params:o});\r\n            }\r\n            for (var k in o) {\r\n                if (k==\"on\") {\r\n                    for (var e in o.on) on(e, o.on[e]);\r\n                } else if (k==\"css\" && o[k]!=null) {//ADDJSL\r\n                    jq.css(o[k]);\r\n                } else if (!Util.startsWith(k,\"$\") && o[k]!=null) {//ADDJSL\r\n                    jq.attr(k,o[k]);\r\n                }\r\n            }\r\n            function on(eType, li) {\r\n                if (!li) return; //ADDJSL\r\n                if (eType==\"enterkey\") {\r\n                    jq.on(\"keypress\",F(function (ev) {\r\n                        if (ev.which==13) li.apply(jq,arguments);\r\n                    }));\r\n                } else if (eType==\"realtimechange\") {\r\n                    var first=true, prev;\r\n                    listeners.push(function () {\r\n                        var cur;\r\n                        if (o.type==\"checkbox\") {\r\n                            cur=!!jq.prop(\"checked\");\r\n                        } else {\r\n                            cur=jq.val();\r\n                        }\r\n                        if (first || prev!=cur) {\r\n                            li.apply(jq,[cur,prev]);\r\n                            prev=cur;\r\n                        }\r\n                        first=false;\r\n                    });\r\n                } else {\r\n                    jq.on(eType, F(li));\r\n                }\r\n            }\r\n        }\r\n        function parseString(str) {\r\n            return $(document.createTextNode(str));\r\n            //return $(\"<span>\").text(str);\r\n        }\r\n    };\r\n    UI.types={\r\n       String: {\r\n           toVal: function (val) {\r\n               return val;\r\n           },\r\n           fromVal: function (val) {\r\n               return val;\r\n           }\r\n       },\r\n       Number: {\r\n           toVal: function (val) {\r\n               return val+\"\";\r\n           },\r\n           fromVal: function (val) {\r\n               return parseFloat(val);\r\n           }\r\n       }\r\n   };\r\n    return UI;\r\n});\r\n\ndefine('UIDiag',[\"UI\",\"R\",\"root\"],function (UI,R,root) {\r\n    var UIDiag={};\r\n    function requestJQueryUI() {\r\n        let curPrj;\r\n        try {\r\n            curPrj=root.Tonyu.globals.$currentProject;\r\n        }catch(e) {\r\n        }\r\n        if (curPrj && typeof curPrj.requestPlugin===\"function\") {\r\n            curPrj.requestPlugin(\"jquery_ui\");\r\n        }\r\n    }\r\n    function isPrimitive(mesg) {\r\n        return (typeof mesg===\"string\" ||\r\n        typeof mesg===\"number\" ||\r\n        typeof mesg===\"boolean\");\r\n    }\r\n    function parseMesg(mesg,defTitle) {\r\n        if (mesg==null) mesg=\"\";\r\n        if (isPrimitive(mesg)) {\r\n            return {title:defTitle,body:multiLine(mesg)};\r\n        } else if ( (typeof $!==\"undefined\") && mesg instanceof $) {\r\n            return {\r\n                title:mesg.title||defTitle,\r\n                body:mesg\r\n            };\r\n        } else {\r\n            if (isPrimitive(mesg.body)) mesg.body=multiLine(mesg.body);\r\n            return mesg;\r\n        }\r\n    }\r\n    function multiLine(mesg) {\r\n        var lines=(mesg+\"\").split(\"\\n\");\r\n        if (lines.length==1) return lines[0];\r\n        return UI.apply(this,[\"div\"].concat(lines.map(function (e) {\r\n            return [\"div\",e];\r\n        })));\r\n    }\r\n    UIDiag.confirm=function (mesg) {\r\n        if (UIDiag.useNative) {\r\n            const res=window.confirm(...arguments);\r\n            UIDiag.afterModal();\r\n            return res;\r\n        }\r\n        requestJQueryUI();\r\n        mesg=parseMesg(mesg,R(\"confirm\"));\r\n        var di=UI(\"div\",{title:mesg.title},[\"div\",mesg.body],\r\n                [\"button\",{on:{click:sendF(true)}},\"OK\"],\r\n                [\"button\",{on:{click:sendF(false)}},R(\"cancel\")]).dialog({width:\"auto\",close:sendF(false)});\r\n        var d=$.Deferred();\r\n        function sendF(r) {\r\n            return function () { d.resolve(r); di.dialog(\"close\"); di.remove(); };\r\n        }\r\n        return d.promise();\r\n    };\r\n    UIDiag.alert=function (mesg) {\r\n        if (UIDiag.useNative) {\r\n            const res=window.alert(...arguments);\r\n            if (root.Tonyu) root.Tonyu.resetLoopCheck();\r\n            return res;\r\n        }\r\n        requestJQueryUI();\r\n        mesg=parseMesg(mesg,R(\"confirm\"));\r\n        var di=UI(\"div\",{title:mesg.title},[\"div\",mesg.body],\r\n                [\"button\",{on:{click:sendF(true)}},\"OK\"]).dialog({width:\"auto\",close:sendF(false)});\r\n        var d=$.Deferred();\r\n        function sendF(r) {\r\n            return function () { d.resolve(r); di.dialog(\"close\"); di.remove(); };\r\n        }\r\n        return d.promise();\r\n    };\r\n    // Compat with $InputBox\r\n    UIDiag.open=function(title,prompt,_default, left, top, width, height) {\r\n        return UIDiag.prompt({title:title,body:prompt},_default,{\r\n            left:left, top:top, width:width, height:height\r\n        });\r\n    };\r\n    UIDiag.getStatus=function () {return UIDiag.status;};\r\n    UIDiag.getText=function () {return UIDiag.val? UIDiag.val.val():\"\";};\r\n    UIDiag.afterModal=function() {\r\n        try {\r\n            root.Tonyu.resetLoopCheck();\r\n        }catch(e){}\r\n        try {\r\n            root.Tonyu.globals.$Scheduler.resetLastSteps();\r\n        }catch(e){}\r\n        try {\r\n            root.Tonyu.globals.$InputDevice.reset();\r\n        }catch(e){}\r\n    };\r\n    //---\r\n    UIDiag.prompt=function (mesg,value,geom) {\r\n        if (UIDiag.useNative) {\r\n            const res=window.prompt(...arguments);\r\n            UIDiag.afterModal();\r\n            return res;\r\n        }\r\n        requestJQueryUI();\r\n        mesg=parseMesg(mesg,R(\"input\"));\r\n        geom=geom||{};\r\n        let position;\r\n        if (typeof geom.left===\"number\" && typeof geom.top===\"number\") {\r\n            position={my:\"left top\",at:\"left+\"+geom.left+\" top+\"+geom.top, of:\"body\"};\r\n        } else {\r\n            position={of:\"body\",at:\"center\",my:\"center\"};\r\n        }\r\n        var di=UI(\"div\",{title:mesg.title},[\"div\",mesg.body],\r\n                [\"input\",{on:{enterkey:ok},$var:\"val\", value:value}],[\"br\"],\r\n                [\"button\",{on:{click:ok}},\"OK\"],\r\n                [\"button\",{on:{click:cancel}},R(\"cancel\")]).dialog({\r\n                    width:geom.width||\"auto\",\r\n                    height:geom.height||\"auto\",\r\n                    position:position,\r\n                    close:function (){\r\n                        di.dialog(\"close\");\r\n                        d.resolve();\r\n                    }\r\n                });\r\n        setTimeout(function () {\r\n            di.$vars.val.focus();\r\n            //console.log(\"FOcus\");\r\n        },10);\r\n        UIDiag.status=0;\r\n        UIDiag.val=di.$vars.val;\r\n        var d=$.Deferred();\r\n        function ok() {\r\n            UIDiag.status=1;\r\n            var r=di.$vars.val.val();\r\n            UIDiag.resultValue=r;\r\n            d.resolve(r);\r\n            di.dialog(\"close\");\r\n            di.remove();\r\n        }\r\n        function cancel() {\r\n            UIDiag.status=2;\r\n            di.dialog(\"close\");\r\n            di.remove();\r\n            d.resolve();\r\n        }\r\n        return d.promise();\r\n\r\n    };\r\n    if (typeof window!=\"undefined\") window.UIDiag=UIDiag;\r\n    return UIDiag;\r\n});\r\n\n/*global requirejs*/\r\ndefine('runtime',[\"ImageList\",\"T2MediaLib\",\"UIDiag\"],\r\nfunction (ImageList,T2MediaLib,UIDiag) {\r\n    console.log(\"runtimes loaded\",arguments);\r\n    if (!window.T2MediaLib) window.T2MediaLib=T2MediaLib;\r\n    return {ImageList,T2MediaLib,UIDiag};\r\n});\r\n\ndefine('LSFS',[\"FS\"],function (FS){return FS.LSFS;});\r\n\ndefine('runScript_common',[\"root\",\"WebSite\"], function (root,WebSite) {\r\n    root.SplashScreen={\r\n        hide: function () {$(\"#splash\").hide();},\r\n        show:function(){},\r\n        progress:function(t) {$(\"#splash .progress\").text(t);}\r\n    };\r\n    return {\r\n        initCanvas: function (doResize) {\r\n            function getMargin() {\r\n                return 0;\r\n            }\r\n\r\n            var margin = getMargin();\r\n            var w=$(window).width();\r\n            var h=$(window).height();\r\n            $(\"body\").css({overflow:\"hidden\", margin:\"0px\"});\r\n            var cv=$(\"<canvas>\").attr({width: w-margin, height:h-margin, class:\"tonyu-canvas\"}).appendTo(\"body\");\r\n\r\n            var u = navigator.userAgent.toLowerCase();\r\n            if (doResize==null) {\r\n                doResize=(u.indexOf(\"iphone\") == -1 &&\r\n                    u.indexOf(\"ipad\") == -1 &&\r\n                    u.indexOf(\"ipod\") == -1\r\n                ) && (!window.parent || window === window.parent);\r\n                if (WebSite.doResize!=null) doResize=WebSite.doResize;\r\n            }\r\n            if (doResize) {\r\n                $(window).resize(onResize);\r\n            }\r\n            function onResize() {\r\n                var margin = getMargin();\r\n                w=$(window).width();\r\n                h=$(window).height();\r\n                cv.attr({width: w-margin, height: h-margin});\r\n            }\r\n            return cv;\r\n        }\r\n    };\r\n});\r\n\n/*global requirejs, process*/\r\nrequirejs([\"FS\",\"compiledTonyuProject\", \"Shell\",\"runtime\",\"WebSite\",\"LSFS\",\"Tonyu\",\"root\",\"runScript_common\"],\r\n\t\tfunction (FS, CPTR,  sh,  rt,WebSite,LSFS,Tonyu,root,com) {\r\n\t$(function () {\r\n\t\tconst cv=com.initCanvas();\r\n\t\tif (typeof window.tonyu_app_version===\"string\") {\r\n\t\t\tWebSite.tonyu_app_version=WebSite.tonyu_app_version||window.tonyu_app_version;\r\n\t\t}\r\n\t\tlet curProjectDir, home, prj;\r\n\t\tif (WebSite.isNW) {\r\n\t\t\tvar cur=process.cwd().replace(/\\\\/g,\"/\");\r\n\t\t\tprj=location.href.replace(/^chrome-extension:\\/\\/\\w*/,\"\");\r\n\t\t\thome=FS.get(cur+prj);\r\n\t\t\tif (!home.isDir()) home=home.up();\r\n\t\t\tcurProjectDir=home;\r\n\t\t} else {\r\n\t\t\tvar locs=location.href.replace(/[\\?#].*/,\"\").split(/\\//);\r\n\t\t\tprj=locs.pop() || \"runscript\";\r\n\t\t\tvar user=locs.pop() || \"nobody\";\r\n\t\t\thome=FS.get(WebSite.tonyuHome);\r\n\t\t\tvar ramHome=FS.get(\"/ram/\");\r\n\t\t\tFS.mount(ramHome.path(), LSFS.ramDisk() );\r\n\t\t\tcurProjectDir=ramHome;\r\n\t\t\tvar actualFilesDir=home.rel(user+\"/\"+prj+\"/\");\r\n\t\t\tramHome.rel(\"files/\").link(actualFilesDir);\r\n\t\t}\r\n\t\tWebSite.compiledKernel=\"js/kernel.js\";\r\n\t\tif (WebSite.serverType===\"BA\" && window.runtimePath) {//ADDBA\r\n\t\t\tWebSite.compiledKernel=window.runtimePath+\"lib/tonyu/kernel.js\";\r\n\t\t}\r\n\t\troot.loadFiles(curProjectDir);\r\n\t\tconst curPrj=CPTR(curProjectDir);\r\n\r\n\t\tsh.cd(curProjectDir);\r\n\t\t/*var curPrj=CPTR(\"user\", \"js/concat.js\",curProjectDir);*/\r\n\t\tTonyu.globals.$mainCanvas=cv;\r\n\t\tTonyu.runMode=true;// abolish\r\n\t\tTonyu.animationFrame=()=>new Promise(requestAnimationFrame);// abolish\r\n\t\tstart();\r\n\t\tfunction start() {\r\n\t\t\tTonyu.currentProject=Tonyu.globals.$currentProject=curPrj;\r\n\t\t\tvar o=curPrj.getOptions();\r\n\t\t\tcurPrj.runScriptMode=true;\r\n\t\t\tcurPrj.rawRun(o.run.bootClass);\r\n\t\t}\r\n\t});\r\n\t//console.log(\"runScript2 loaded\");\r\n});\r\n\ndefine(\"runScript2\", function(){});\n\n})();\r\n"]}